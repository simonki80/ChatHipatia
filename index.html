<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
    /* Preloader Styles - Deben ir primero */
    .preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #F5F7F9; /* CAMBIADO: de #ffffff a #F5F7F9 */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    
    .preloader-content {
      text-align: center;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .preloader p {
      color: #333;
      font-family: 'Poppins', sans-serif;
      font-size: 1.2em;
    }
    
    .preloader.hidden {
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease, visibility 0.5s;
    }
    
    /* Esto evita el scroll mientras carga */
    body.preloader-active {
      overflow: hidden;
      height: 100vh;
      background: #F5F7F9; /* A√ëADIDO: Fondo del body durante carga */
    }
  </style>
  <!-- Pol√≠tica CSP corregida (agregamos 'unsafe-inline' y 'unsafe-eval' necesarios) -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self' https:;
    script-src 'self' 'unsafe-inline' 'unsafe-eval' https:;
    style-src 'self' 'unsafe-inline' https:;
    img-src 'self' https: data:;
    font-src 'self' https: data:;
    connect-src 'self' https:;
  ">
  <title>Math Chat Pro</title>
  
  <!-- Fuentes de Google (mantenemos todas las originales) -->
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Font Awesome (original) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  
  <!-- Highlight.js (mantenemos todos los lenguajes originales) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <!-- Todos los lenguajes originales -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/java.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/csharp.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/ruby.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/swift.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/php.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/sql.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/bash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/r.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/matlab.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/kotlin.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/scala.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/perl.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/lua.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/mathematica.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/html.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/css.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/json.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/markdown.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/shell.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/dockerfile.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <!-- Plotly (versi√≥n actualizada como ten√≠as) -->
  <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>

    <!-- MathJax Configuration (original) -->
  <script>
  window.MathJax = {
    tex: {    
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['\\[', '\\]']],
      processEscapes: true,
      packages: {'[+]': ['ams', 'boldsymbol', 'physics']}
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      ignoreHtmlClass: 'tex2jax_ignore',
      processHtmlClass: 'tex2jax_process',
      enableAssistiveMml: true   // ‚úÖ Habilita capa de texto seleccionable
    },
    loader: {
      load: [
        '[tex]/ams',
        '[tex]/boldsymbol',
        '[tex]/physics',
        'ui/menu',              // Men√∫ contextual de MathJax (opcional)
        'a11y/assistive-mml'    // ‚úÖ Crea un <annotation> invisible con el LaTeX
      ]
    },
    startup: {
      ready: () => {
        console.log('‚úÖ MathJax est√° listo con copiado de LaTeX');
        MathJax.startup.defaultReady();
        MathJax.startup.promise.then(() => {
          console.log('üéâ Render finalizado');
        });
      }
    }
  };
  </script>

  
  <!-- MathJax Script (original) -->
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>

  <!-- MathLive (original) -->
  <script type="module" src="https://unpkg.com/mathlive?module"></script>
  <link rel="stylesheet" href="https://unpkg.com/mathlive/dist/mathlive.core.css" />

  <!-- Estilos personalizados (agregamos CSS para corregir hidden) -->
  <link rel="stylesheet" href="styles.css"> 
  
  <style>
    /* Correcci√≥n para elementos hidden */
    [hidden], .hidden {
      display: none !important;
      visibility: hidden !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }
    
    /* Asegurar que Plotly se muestre correctamente */
    .plotly-graph-container {
      width: 100%;
      height: 500px;
      margin: 20px 0;
    }
  </style>

  <!-- Favicon (original) -->
  <link rel="icon" href="favicon.ico" type="image/x-icon">
<style>:root {
    /* üé® Paleta principal minimalista con acento */
    --primary-accent: #1C1C1C; /* Cian moderno para acentos principales */
    --primary-accent-dark: #212121; /* Tono m√°s oscuro para hover/pressed */
    --background-body: #F5F7F9; /* Fondo global: un blanco hueso muy suave */
    --background-container: #ffffff; /* Contenedores principales (chat, etc.) en blanco puro */
    --background-light: #FDFDFD; /* Fondo para elementos ligeros (header, barras) */

    /* üñãÔ∏è Colores de texto */
    --text-dark: #212529; /* Negro carb√≥n para texto principal */
    --text-medium: #6c757d; /* Gris medio para texto secundario */
    --text-light: #F5F7F9; /* Texto claro sobre fondos oscuros */

    /* üî≤ Bordes y sombras */
    --border-color: #e9ecef; /* Gris muy claro, casi imperceptible */
    --shadow-subtle: 0 1px 3px rgba(0, 0, 0, 0.04);
    --shadow-medium: 0 8px 20px rgba(0, 0, 0, 0.06);
    --shadow-header: 0 3px 10px rgba(0, 0, 0, 0.03);

    /* üí¨ Burbujas de chat */
    --bubble-user: #0081a7; /* Cian para burbuja del usuario */
    --bubble-bot: #F0F3F5; /* Gris muy claro para burbuja del bot */

    /* --- Fuentes --- */
    --font-body: 'Poppins', sans-serif;
    --font-title: 'Inter', sans-serif;
    --font-math: 'Latin Modern Math', 'Times New Roman', serif;

    /* --- Tama√±os de Fuente Base --- */
    --font-size-base: 16px; 
    --font-size-small: 14px; 
    --font-size-large: 20px; 

    /* üìò Colores espec√≠ficos para contenido */
    --bold-color: #212529; /* Negro carb√≥n para √©nfasis */
    --step-highlight: #FBFBFC; /* Blanco sutil para resaltar pasos */
    --definition-bg: #E7F6FA; /* Cian muy suave para definiciones */
    --solution-bg: #F5F7F9; /* Mismo blanco hueso para soluciones */
    --solution-border: #adb5bd; /* Gris claro para el borde de la soluci√≥n */
    --code-bg: #f8f9fa; /* Fondo gris claro para bloques de c√≥digo */

    /* üåô Colores para modo oscuro / sintaxis */
    --background-dark-mode: #161a1e; /* Negro carb√≥n para el fondo oscuro */
    --text-dark-mode: #dee2e6; /* Gris muy claro para el texto en modo oscuro */
    --code-syntax-keyword: #0081a7; /* Cian para palabras clave */
    --code-syntax-string: #c1c5cc; /* Gris claro para strings */
    --code-syntax-comment: #7d858c; /* Gris apagado para comentarios */
    --code-syntax-number: #b4b9bf; /* Gris suave para n√∫meros */
    --code-border-medium: #495057; /* Gris oscuro para bordes */
    --copy-btn-bg: #495057;
    --copy-btn-hover: #6c757d;
    --tag-bg: #212529;
    --tag-text: #ffffff;
}

/* Base global */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: var(--font-body);
    font-size: var(--font-size-base);
    font-weight: 500; /* <-- Haz el texto normal un poco m√°s "gordito" */
    line-height: 1.6;
    color: var(--text-dark);
    background: #F5F7F9 !important; /* Fondo principal */
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
}

/* Contenedor principal del chat */
.chat-container {
    width: 100%;
    /* No es necesario max-width si quieres que ocupe todo el ancho */
    /* Si quieres un ancho m√°ximo, considera usarlo junto con `margin: 0 auto;` para centrarlo */
    max-width: 850px; /* <-- Com√©ntalo o qu√≠talo si quieres 100% de ancho */
    
    margin: 0 auto; /* Mantenlo si usas max-width para centrar el contenedor */
    
    background: #F5F7F9;
    display: flex;
    flex-direction: column;
    
    /* --- CAMBIOS CLAVE PARA ALTURA COMPLETA --- */
    height: 100vh; /* Ocupa el 100% del alto del viewport (ventana del navegador) */
    max-height: 100vh; /* Asegura que no exceda el alto del viewport */
    /* --- FIN CAMBIOS CLAVE --- */
    
    border-radius: 12px;
    box-shadow: var(--shadow-medium);
    overflow: hidden;
    position: relative;
}

html, body {
    margin: 0;
    padding: 0;
    overflow: hidden; /* Evita el scroll del body si el chat ocupa todo */
    height: 100%; /* Asegura que html y body ocupen el 100% del viewport */
    width: 100%; /* Asegura que html y body ocupen el 100% del viewport */
}


/* El encabezado es transparente y se superpone al fondo del contenedor */
.chat-header {
    background: var(--background-container); /* <-- ¬°HAZLO TRANSPARENTE! */
    color: var(--primary-accent);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    font-size: 0.8em;
    font-weight: bold;
    z-index: 10;
    position: relative;
    
    /* --- ELIMINACI√ìN TOTAL DE SEPARADORES --- */
    box-shadow: none !important; 
    border-bottom: none !important;
    filter: none !important;
}

/* --- Estilos para el bot√≥n de encabezado (header-mode-toggle) --- */
.header-mode-toggle {
    font-family: 'Poppins', sans-serif;
    
    /* Estilo del bot√≥n */
    background-color: var(--background-light); /* Blanco elegante */
    border: 1px solid var(--border-color); /* Gris claro */
    color: var(--primary-accent); /* Azul elegante */
    font-size: 1.1em;
    font-weight: 600;
    cursor: pointer;
    padding: 8px 15px;
    border-radius: 8px;
    box-shadow: var(--shadow-subtle); /* Sombra ligera elegante */
    
    /* Transiciones para una animaci√≥n suave */
    transition: all 0.3s ease-in-out;
    
    outline: none;
    
    /* No ocupar todo el espacio */
    display: inline-block;
    
    /* Texto centrado */
    text-align: center;
    
    white-space: nowrap;
}

/* Estilos al pasar el rat√≥n por encima del bot√≥n */
.header-mode-toggle:hover {
    background-color: #e9ecef;
    color: #343a40;
    border-color: #ced4da;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.12);
}

/* Estilos al hacer clic en el bot√≥n */
.header-mode-toggle:active {
    transform: translateY(0);
    box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    background-color: #e2e6ea;
}

/* --- Nuevo Estilo para el "Segundo Header" --- */
/* --- Estilos para el Secondary Header (Revisado para elegancia) --- */
.secondary-header {
    background-color: var(--background-light);
    border-bottom: 1px solid var(--border-color);
    padding: 10px 20px; /* Reducimos el padding general del header */
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    z-index: 9;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px; /* Reducimos el espacio entre los grupos */
    flex-wrap: wrap;
}

/* --- Grupo de Botones de Tutor√≠a (Izquierda) --- */
.tutor-controls-left {
    display: flex;
    gap: 8px; /* Reducimos el espacio entre los botones individuales */
    flex-wrap: wrap;
}

.tutor-button {
    padding: 6px 12px;
    background-color: transparent; /* ¬°Fondo transparente! */
    border: 1px solid transparent; /* El borde tambi√©n transparente */
    border-radius: 6px;
    color: var(--text-medium); /* Texto gris (usando text-medium como especificaste) */
    font-size: 0.8em;
    font-weight: 500;
    cursor: pointer;
    transition: box-shadow 0.25s ease-out, transform 0.15s ease-out, color 0.25s ease-out; /* Transiciones para sombra, transform y color */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06); /* Sombra inicial sutil para el efecto de levantamiento */
}

.tutor-button:hover {
    color: var(--primary-accent); /* El texto se vuelve azul al pasar el rat√≥n */
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15); /* Sombra m√°s pronunciada al levantar */
    transform: translateY(-2px); /* Efecto de levantamiento */
}

.tutor-button:active {
    color: var(--text-medium); /* El texto vuelve a gris al presionar */
    transform: translateY(0); /* Vuelve a la posici√≥n original (presionado) */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); /* Sombra m√°s peque√±a para el efecto de presionado */
}

/* --- Grupo de Selector de Examen y Bot√≥n 'Start' (Derecha) --- */
.tutor-exam-group {
    display: flex;
    align-items: center;
    gap: 8px; /* Reducimos el espacio entre el selector y el bot√≥n Start */
    flex-wrap: wrap;
}

.mode-prompt {
    color: var(--text-dark); /* Texto oscuro para buena legibilidad */
    font-size: 0.95em;
    font-weight: 500;
    white-space: nowrap; /* Evita que el texto se rompa */
}

/* --- Selector de Examen (Desplegable) --- */
.exam-type-select {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;

    padding: 7px 15px; /* Selector m√°s compacto */
    border-radius: 6px;
    border: 1px solid var(--border-color);
    background-color: var(--background-light);
    color: var(--text-dark);
    font-size: 0.85em;
    font-family: var(--font-body);
    cursor: pointer;
    outline: none;
    transition: all 0.2s ease-in-out;
    box-shadow: none;

    background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%236c757d%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13%205.7L146.2%20224.2%2018.8%2075.1a17.6%2017.6%200%200%200-25.7%2023.1l132.4%20146.8c4.3%204.4%2010.4%206.9%2016.9%206.9s12.6-2.5%2016.9-6.9l132.4-146.8c14.2-15.5%203.2-39.7-22.6-39.7z%22%2F%3E%3C%2Fsvg%3E');
    background-repeat: no-repeat;
    background-position: right 10px center;
    background-size: 10px;
}

.exam-type-select:hover {
    border-color: var(--primary-accent);
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.1);
    background-color: var(--background-container-hover);
}

.exam-type-select:focus {
    border-color: var(--primary-accent);
    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2);
}


/* Estilo para las opciones del select (dentro del desplegable) */
.exam-type-select option {
    background-color: var(--background-container);
    color: var(--text-dark);
}

/* --- Bot√≥n de Inicio de Examen ('Start') --- */
.exam-button {
    padding: 7px 18px; /* Bot√≥n Start compacto, ¬°sin cambios en colores! */
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9em;
    font-weight: 600;
    transition: background-color 0.2s ease-in-out, transform 0.1s ease-out, box-shadow 0.2s ease-in-out;
    color: #fff; /* Texto blanco */
    background-color: var(--primary-accent); /* Fondo azul principal */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
}

.exam-button:hover {
    background-color: var(--primary-accent-dark);
    transform: translateY(-1px);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
}

.exam-button:active {
    transform: translateY(0);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.exam-button:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
    opacity: 0.7;
}

/* --- Reasoner Toggle --- */
.reasoner-toggle {
    /* Layout and basic shape */
    display: flex;
    align-items: center; 
    justify-content: flex-end; 
    margin-left: auto; 
    padding: 6px 14px; 

    /* Fondo con degradado elegante */
    background: var(--background-light);
    
    border-radius: 25px; /* Estilo pill */
    gap: 10px; 
    box-shadow: var(--shadow-subtle); 
    transition: all 0.3s ease-in-out; 
    cursor: pointer; 
    border: 1px solid var(--border-color); 
}

/* --- Reasoner Label --- */
.reasoner-label {
    font-size: 0.9em; 
    font-weight: 600; 
    color: var(--text-dark); 
    white-space: nowrap; 
    user-select: none; 
}

/* --- Reasoner Tooltip --- */
.reasoner-tooltip {
    position: relative; /* Necesario para posicionar el tooltip-text */
    cursor: pointer;    /* Indica que es interactivo */
}

.reasoner-tooltip .tooltip-text {
    visibility: hidden; /* Oculto por defecto */
    width: 140px;       /* Un poco m√°s ancho para elegancia */
    background-color: var(--background-body); /* Gris carb√≥n elegante */
    color: var(--text-light); /* Texto claro para contraste */
    text-align: center; 
    border-radius: 8px; 
    padding: 10px 12px; 
    position: absolute; 
    z-index: 1; 
    top: 125%; 
    left: 50%;  /* Mejor centrado */
    transform: translateX(-50%); 
    opacity: 0; 
    transition: opacity 0.3s ease, transform 0.3s ease; 
    font-size: 0.8em; 
    font-weight: normal; 
    box-shadow: var(--shadow-medium); /* Consistencia con la paleta */
}

/* Tooltip visible */
.reasoner-tooltip:hover .tooltip-text {
    visibility: visible;
    opacity: 1;
    transform: translateX(-50%) translateY(5px); /* Sutil movimiento elegante */
}

/* --- Switch Styling --- */
.switch {
    position: relative;
    display: inline-block;
    width: 44px; /* Slightly wider switch */
    height: 24px; /* Slightly taller switch */
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

/* --- Slider (Toggle Switch) --- */
.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--border-color); /* Neutro apagado */
    transition: 0.4s;
    border-radius: 24px;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.15);
}

.slider:before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 2px;
    bottom: 2px;
    background-color: var(--background-container); /* Elegante y limpio */
    transition: 0.4s;
    border-radius: 50%;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
}

input:checked + .slider {
    background-color: var(--primary-accent); /* Azul elegante para ON */
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 
                0 0 0 2px rgba(0, 123, 255, 0.25); /* Anillo suave */
}

input:checked + .slider:before {
    transform: translateX(20px);
    background-color: var(--background-container);
}

/* --- Warning Message --- */
.reasoner-warning {
    display: none;
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: var(--background-body); /* Gris carb√≥n elegante */
    color: var(--bold-color); /* Texto claro */
    padding: 12px 25px;
    border-radius: 8px;
    box-shadow: var(--shadow-medium);
    z-index: 1000;
    max-width: 90%;
    width: fit-content;
    text-align: center;
    border-left: 6px solid var(--primary-accent); /* Azul elegante */
    opacity: 0;
    transition: opacity 0.4s ease-out, transform 0.4s ease-out;
}

.reasoner-warning.show {
    display: block;
    opacity: 1;
    transform: translateX(-50%) translateY(0); /* Final state for animation */
}

.reasoner-warning.hide {
    opacity: 0;
    transform: translateX(-50%) translateY(20px); /* Hides by moving down and fading */
}

/* Estilos generales para todos los elementos <li> dentro de las burbujas de chat */
.chat-bubble ul li,
.chat-bubble ol li { /* Aplicamos a ul y ol para unificar vi√±etas a un punto */
    margin-bottom: 0.2em;   /* Espacio reducido entre elementos de lista */
    line-height: 1.5;       /* Altura de l√≠nea para legibilidad */
    color: var(--text-dark); /* Color de texto consistente */
    position: relative;     /* Necesario para posicionar la vi√±eta personalizada */
    padding-left: 1.2em;    /* Espacio para la vi√±eta personalizada */
    list-style: none;       /* ¬°Muy Importante! Elimina vi√±etas/n√∫meros nativos */
}

/* Oculta los estilos predeterminados de las listas */
.chat-bubble ul,
.chat-bubble ol {
    list-style: none;
    padding-left: 0; /* Elimina el padding predeterminado de la lista */
    margin-top: 8px; /* Espacio superior reducido */
    margin-bottom: 8px; /* Espacio inferior reducido */
}

/* --------------- Vi√±eta de punto personalizada para TODOS los li --------------- */
.chat-bubble ul li::before,
.chat-bubble ol li::before {
    content: "‚Ä¢"; /* Un simple punto Unicode como vi√±eta */
    position: absolute;
    left: 0; /* Posiciona la vi√±eta al inicio del padding-left de li */
    top: 0; /* Alinea con la parte superior del texto */
    color: var(--neutral-highlight-dark); /* ¬°El color gris "gordito"! */
    font-weight: 600; /* Lo hace m√°s "gordito" */
    font-size: 1.1em; /* Un poco m√°s grande que el texto para que destaque */
    line-height: inherit; /* Hereda la altura de l√≠nea del li */
}

/* Elimina el margen inferior del √∫ltimo elemento de lista para evitar espacio extra */
.chat-bubble ul li:last-child,
.chat-bubble ol li:last-child {
    margin-bottom: 0;
}
/* Caja de chat y burbujas */
.chat-box {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    padding-top: 60px; /* Espacio reducido para la cabecera */
    display: flex;
    flex-direction: column;
    gap: 15px;
    background-color: #F5F7F9; /* Fondo limpio y elegante */
    scroll-behavior: smooth;
    color: var(--text-dark); /* Texto principal oscuro */
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.05); /* Un toque de profundidad sutil */
    border-radius: 8px; /* Opcional: suavizar esquinas si lo deseas */
}


/* ======================= ESTILOS PARA LA ESTETICA DENTRO DEL CHAT =============================  */
.chat-msg {
    display: flex;
    max-width: 100%;
    font-size: 15px; /* Tama√±o de fuente reducido */
}

.chat-msg.user {
    justify-content: flex-end;
}

.chat-msg.bot {
    justify-content: flex-start;
}

.chat-bubble {
    max-width: 100%;
    padding: 20px 20px; /* Padding reducido */
    border-radius: 10px;
    box-shadow: var(--shadow-subtle);
    white-space: pre-wrap;
    word-wrap: break-word;
    transition: all 0.2s ease-in-out;
    position: relative;
    font-family: var(--font-body);
    line-height: 1.6;
}

.chat-msg.user .chat-bubble {
    max-width: 80%;
    background-color: var(--primary-accent-dark); /* Azul oscuro elegante */
    color: var(--text-light); /* Texto claro para contraste */
    border-bottom-right-radius: 6px;
    border-radius: 12px; /* M√°s suave y moderno */
    padding: 10px 14px; /* Espaciado interno */
    box-shadow: var(--shadow-subtle); /* Toque de profundidad */
}


.chat-msg.bot .chat-bubble {
    background-color: transparent;
    color: var(--text-dark);
    border: none;
    border-bottom-left-radius: 0;
    padding: 30px 15px 30px 15px; /* Padding reducido */
    box-shadow: none;
    max-width: 100%;
}

.chat-msg.bot .chat-bubble .copy-message-btn {
    top: 0px;
    right: 0px;
    background: rgba(255, 255, 255, 0.6);
    border: 1px solid var(--border-color);
}
/* Estilos para contenido del bot */
.bot-content {
    width: 100%;
}

/* Botones de copiar (LaTeX, mensaje completo) */
.latex-copy {
    position: relative;
    display: inline-block;
}

.copy-latex-btn, .copy-message-btn {
    background: rgba(255,255,255,0.8);
    border: 1px solid rgba(0,0,0,0.1);
    border-radius: 5px;
    width: 28px; /* Tama√±o reducido */
    height: 28px; /* Tama√±o reducido */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 0;
    transition: all 0.2s;
    box-shadow: var(--shadow-subtle);
}

.copy-latex-btn {
    position: absolute;
    right: -30px; /* Posici√≥n ajustada */
    top: 50%;
    transform: translateY(-50%);
    font-size: 10px; /* Tama√±o reducido */
}

.latex-copy:hover .copy-latex-btn {
    opacity: 1;
    background: #f0f4f7;
}

.mathlive-input {
  background-color: var(--background-light); /* Fondo limpio y elegante */
  border: 1px solid var(--border-color); /* Borde sutil y consistente */
  border-radius: 8px;
  padding: 8px 12px;
  font-family: 'Roboto Mono', monospace; /* Perfecto para matem√°ticas */
  resize: none;
  min-height: 2em;
  color: var(--text-dark); /* Texto principal */
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); /* Profundidad ligera */
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.mathlive-input:focus {
  border-color: var(--primary-accent); /* Azul elegante al enfocar */
  box-shadow: 0 0 0 2px rgba(0,123,255,0.2); /* Anillo suave */
  outline: none;
}


.copy-message-btn {
    position: absolute;
    top: 8px; /* Posici√≥n ajustada */
    right: 8px; /* Posici√≥n ajustada */
}

.chat-bubble:hover .copy-message-btn {
    opacity: 1;
}

.copy-message-btn:hover {
    background: var(--step-highlight); /* Gris muy claro elegante */
    transform: translateY(-1px);
    box-shadow: var(--shadow-subtle); /* Consistente con la paleta */
}

/* Mensaje de √©xito */
.copy-success {
    position: absolute;
    top: 8px;
    right: 40px;
    background: var(--primary-accent); /* Azul elegante */
    color: var(--text-light); /* Texto claro */
    border-radius: 6px;
    padding: 6px 10px;
    font-size: 12px;
    display: none;
    white-space: nowrap;
    animation: fadeIn 0.3s ease-out;
    box-shadow: var(--shadow-medium); /* Un poco de profundidad */
    z-index: 20;
}


/* ======================= ESTILOS PARA LA ESTETICA DENTRO DEL CHAT =============================  */

/* Estilos para los pasos */
.step {
    margin: 20px 0;
    padding: 20px 24px;
    background-color: #F8F8F8;
    border-radius: 12px;
    border: 1px solid #e9ecef; /* borde fijo, no transparente */
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05); /* sombra ligera */
}

/* Encabezado del paso */
.step h2 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 1.25rem;
    color: #495057;
}

/* L√≠nea decorativa del t√≠tulo */
.step h2::after {
    content: '';
    display: block;
    margin-top: 6px;
    width: 40px;
    height: 3px;
    background-color: #ced4da;
    border-radius: 2px;
}

/* Estilos para el enlace de explicaci√≥n */
.explain-link {
    font-size: 12px;
    color: var(--primary-accent);
    cursor: pointer;
    margin-left: 8px;
    text-decoration: none;
    font-weight: 600;
}

.similar-exercises {
    margin-bottom: 15px;
    padding: 15px 18px;
    background-color: #fcfcfc;
    border-radius: 10px;
    position: relative;
    transition: all 0.2s ease-in-out;
    border: 1px solid #e9ecef;
    box-shadow: 0 1px 4px rgba(0,0,0,0.04);
    color: var(--text-dark);
}

.similar-exercises:hover {
    background-color: #ffffff;
    border-color: #dee2e6;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    transform: translateY(-2px);
}

.similar-exercises:before {
    content: "Ejercicios Similares";
    position: absolute;
    top: -12px;
    left: 15px;
    background: #28a745; /* Verde en lugar de azul */
    color: #F8F8F8;
    padding: 3px 8px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Secci√≥n de soluci√≥n final */
.full-solution {
    margin-top: 0px;
    margin-bottom: 0px;
    padding: 10px; /* Significantly reduced internal padding */
    background-color: #ffffff;
    border: 1px solid var(--border-medium, #d0d0d0); /* Using a fallback color for --border-medium */
    border-radius: 6px; /* Tighter corners */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.12); /* More prominent, yet still elegant shadow for "pop" */
    color: var(--text-dark, #333); /* Using a fallback color for --text-dark */
    position: relative;
    overflow: hidden;
    /* Added subtle gradient for depth - makes it less flat */
    background: linear-gradient(to bottom right, #f8f8f8, #ffffff);
}

/* The "subtitle" now acts as the visible label/title within the block */
.full-solution .subtitle {
    margin-top: 0;
    margin-bottom: 0px; /* Very tight space below the title */
    color: var(--neutral-highlight-dark, #555); /* Using a fallback color for --neutral-highlight-dark */
    font-weight: 700;
    font-size: 1.1em; /* Slightly smaller for compactness */
    text-transform: uppercase;
    letter-spacing: 0.7px; /* Tighter letter spacing */
    border-bottom: 1px solid var(--neutral-highlight-light, #eee); /* Thinner, lighter underline */
    padding-bottom: 0px; /* Reduced padding below the title for the underline */
}

/* Styles for the actual solution content */
.full-solution .solution-content {
    line-height: 1.5; /* Tightest line height for dense paragraphs */
    font-size: 0.95em; /* Slightly smaller font for maximum compactness */
    color: var(--text-darker, #444); /* Using a fallback color for --text-darker */
    margin-bottom: 0px; /* Reduced space below the content */
}

/* Style for the "Probar este c√≥digo en LaTeX" button */
.copy-full-latex {
    display: block; /* Make it a block element to span full width */
    margin-top: 0px; /* Tight space above the button */
    font-size: 13px; /* Slightly smaller font for button */
    color: var(--neutral-highlight-dark, #555);
    cursor: pointer;
    font-weight: 600;
    text-decoration: none;
    transition: color 0.3s ease, text-decoration 0.3s ease;
    clear: both; /* Ensure it clears any floats */
    text-align: left; /* Align button text to the left (beginning of card) */
    padding-left: 0; /* Remove any default padding that might push it */
}

.copy-full-latex:hover {
    color: var(--primary-color, #007bff); /* Fallback primary color */
    text-decoration: underline;
}

/* Accent line - made thinner and slightly less prominent for compactness */
.full-solution::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 3px; /* Even thinner accent line */
    height: 100%;
    background-color: var(--neutral-highlight-dark, #555);
    border-top-left-radius: 6px;
    border-bottom-left-radius: 6px;
}

.definition {
    background: #FFFFFF;
    border: 1px solid #dee2e6;
    padding: 45px 45px; /* Padding reducido */
    margin: 15px 3px; /* Margen reducido */
    border-radius: 10px; /* Radio reducido */
    position: relative;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05); /* Sombra reducida */
    color: #343a40;
    overflow: visible;
}

.definition:before {
    content: "Definici√≥n";
    position: absolute;
    top: -12px;
    left: 15px;
    background: #007bff;
    color: #F8F8F8;
    padding: 3px 8px; /* Padding reducido */
    border-radius: 6px;
    font-size: 11px; /* Tama√±o reducido */
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}


h1 {
    font-size: 33px; /* Establece el tama√±o para todos los h1 */
    color: #333;
}

hr {
  border: none;
  height: 1px;
  margin: 20px 0;
  background-color: var(--border-color, #444);
  border-radius: 3px;

  /* Toque de profundidad con sombras */
  box-shadow:
    0 1px 2px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.05),
    inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

.title {
    font-family: var(--font-title);
    font-weight: 700; /* Mantenemos un buen peso para la jerarqu√≠a */
    font-size: 20px; /* Tu tama√±o de fuente actual */
    margin-bottom: 0px; /* Tu margen inferior actual */
    
    /* Colores neutros y elegantes */
    color: var(--text-dark); /* Usa tu color de texto oscuro principal para elegancia */
    /* Puedes probar tambi√©n con: color: #343a40; o un gris oscuro similar */

    /* Sombra de texto sutil para un efecto de profundidad/relieve */
    text-shadow: 
        1px 1px 1px rgba(0, 0, 0, 0.05), /* Sombra ligera hacia abajo-derecha */
        -1px -1px 1px rgba(255, 255, 255, 0.05); /* Luz ligera hacia arriba-izquierda */
        /* O, para un efecto m√°s suave a√∫n (como el que uso aqu√≠): */
        /* 0px 1px 1px rgba(0, 0, 0, 0.08); */
}

.subtitle {
    font-family: var(--font-title);
    font-weight: 600;
    font-size: 18px; /* Tama√±o reducido */
    margin: 15px 0 0px; /* Margen reducido */
    color: var(--text-dark);
}

.highlight {
    background-color: #fffacd;
    padding: 2px 4px; /* Padding reducido */
    border-radius: 3px; /* Radio reducido */
    color: var(--text-dark);
}

.important {
    font-weight: 700;
    color: var(--bold-color);
}

.note {
    font-style: italic;
    color: var(--text-medium);
    border-left: 3px solid var(--border-color); /* Grosor reducido */
    padding-left: 10px; /* Padding reducido */
    margin: 12px 0; /* Margen reducido */
    background-color: #fcfcfc;
    border-radius: 3px; /* Radio reducido */
    padding-top: 6px; /* Padding reducido */
    padding-bottom: 6px; /* Padding reducido */
    color: var(--text-dark);
}

/* ESTILOS PARA MATEM√ÅTICAS */
/* ESTILOS PARA MATEM√ÅTICAS */
.math-text {
    font-family: var(--font-math);
    color: var(--primary-accent-dark);
    font-weight: 500;
    background-color: rgba(0, 123, 255, 0.08);
    padding: 2px 4px; /* Padding reducido */
    border-radius: 3px; /* Radio reducido */
    display: inline-block;
    line-height: 1.4; /* Line-height reducido */
    /* Para inline-block, si el texto es demasiado largo, simplemente se romper√° a la siguiente l√≠nea */
    white-space: normal; /* Asegura que el texto se ajuste y no intente permanecer en una sola l√≠nea */
    word-break: break-word; /* Rompe palabras largas si es necesario para evitar desborde */
}

.math-block {
    font-family: var(--font-math);
    background: var(--code-bg);
    padding: 12px; /* Padding reducido */
    border-radius: 6px; /* Radio reducido */
    margin: 10px 0; /* Margen reducido */
    border-left: 3px solid var(--primary-accent); /* Grosor reducido */
    /* --- MODIFICACIONES CLAVE AQU√ç --- */
    overflow-x: auto; /* Permite desplazamiento horizontal si el contenido es demasiado ancho */
    overflow-y: hidden; /* Oculta el desplazamiento vertical si no es necesario */
    max-width: 100%; /* Asegura que no sea m√°s ancho que su contenedor padre */
    box-sizing: border-box; /* Incluye padding y borde en el ancho total */
    /* --- FIN MODIFICACIONES CLAVE --- */
    position: relative;
    line-height: 1.5; /* Line-height reducido */
    color: var(--text-dark);
}

/* Estilos para MathJax */
.MJXc-display {
    margin: 12px 0 !important; /* Margen reducido */
    /* --- MODIFICACIONES CLAVE AQU√ç --- */
    overflow-x: auto; /* Permite desplazamiento horizontal dentro del bloque de visualizaci√≥n de MathJax */
    overflow-y: hidden; /* Oculta el desplazamiento vertical */
    max-width: 100%; /* Asegura que no sea m√°s ancho que su contenedor padre */
    display: block !important; /* A veces MathJax puede cambiar esto, aseg√∫rate de que sea un bloque */
    /* --- FIN MODIFICACIONES CLAVE --- */
}

.math-block, .MJXc-display {
    overflow-x: auto;       /* Permite scroll horizontal si es necesario */
    overflow-y: hidden;     /* Evita scroll vertical no deseado */
    max-width: 100%;        /* Nunca m√°s ancho que su contenedor */
    box-sizing: border-box; /* Incluye padding en el c√°lculo del ancho */
    display: block;         /* Asegura comportamiento de bloque */
    padding: 12px 8px;      /* Padding reducido para m√≥viles */
    margin: 10px 0;
    -webkit-overflow-scrolling: touch; /* Scroll suave en m√≥viles */
}

/* Asegura que MathJax respete los contenedores */
.MathJax, .MJXc-display {
    max-width: 100% !important;
    overflow-x: auto !important;
}

/* Contenedor de ecuaciones numeradas */
.MathJax_Display {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

.data-table table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    font-family: var(--font-body);
    font-size: 14px;
}

.data-table th,
.data-table td {
    border: 1px solid #dee2e6;
    padding: 10px;
    text-align: left;
}

.data-table th {
    background-color: var(--primary-accent); /* O un color m√°s oscuro de tu paleta */
    color: #F0FCFA;
    font-weight: 600;
}

.data-table tr:nth-child(even) {
    background-color: #f8f9fa; /* Ligeramente m√°s oscuro para filas pares */
}

.data-table tr:hover {
    background-color: #e9ecef; /* Resaltar al pasar el rat√≥n */
}

/* ======================= ESTILOS PARA LAS ALERTAS MEJORADAS ============================= */

.alert-info, .alert-warning, .alert-success, .alert-tip {
    padding: 12px 15px;
    margin: 15px 0;
    border-radius: 8px;
    font-size: 14px;
    display: flex; /* Mantenemos flexbox para el icono y el texto */
    align-items: flex-start; /* Alinea los elementos al inicio del contenedor */
    gap: 10px;
    line-height: 1.5;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    flex-wrap: wrap; /* Permite que los elementos se envuelvan a la siguiente l√≠nea */
}

/* Estilos espec√≠ficos para cada tipo de alerta (colores, bordes) */
.alert-info {
    background-color: #e7f3ff;
    border: 1px solid #cce5ff;
    color: #004085;
}

.alert-warning {
    background-color: #fff3cd;
    border: 1px solid #ffeeba;
    color: #856404;
}

.alert-success {
    background-color: #d4edda;
    border: 1px solid #c3e6cb;
    color: #155724;
}

.alert-tip { /* Nuevo para consejos espec√≠ficos */
    background-color: #e6f7ff;
    border: 1px solid #91d5ff;
    color: #08979c;
}

/* Contenedor para el t√≠tulo y el icono */
.alert-info .alert-header,
.alert-warning .alert-header,
.alert-success .alert-header,
.alert-tip .alert-header {
    display: flex;
    align-items: center;
    gap: 8px; /* Espacio entre el icono y el texto del t√≠tulo */
    /* Para que el header ocupe todo el ancho disponible y empuje el contenido a la siguiente l√≠nea */
    flex-basis: 100%; 
    margin-bottom: 5px; /* Peque√±o margen debajo del encabezado */
}


.alert-info .alert-header i, .alert-warning .alert-header i, .alert-success .alert-header i, .alert-tip .alert-header i {
    font-size: 18px;
    margin-top: 0; /* No necesitamos margen superior aqu√≠ ya que flexbox lo maneja */
    flex-shrink: 0; /* Asegura que el icono no se encoja */
}

.alert-info .alert-header strong, .alert-warning .alert-header strong, .alert-success .alert-header strong, .alert-tip .alert-header strong {
    font-weight: 700;
    margin-right: 0; /* Ya no necesitamos margen a la derecha aqu√≠ */
    line-height: 1; /* Asegura que el texto del t√≠tulo no tenga espacio extra */
}

/* Estilos para el contenido real de la alerta */
.alert-info .alert-content,
.alert-warning .alert-content,
.alert-success .alert-content,
.alert-tip .alert-content {
    flex-basis: 100%; /* El contenido ocupa toda la l√≠nea siguiente */
    margin-top: 0; /* Elimina cualquier margen superior extra */
}

.example-section {
    border: 1px solid #ced4da;
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
    background-color: #ffffff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    position: relative; /* Esencial para posicionar la etiqueta flotante */
    overflow: visible; /* Asegura que la etiqueta no se recorte si sobresale */
}

/* Etiqueta flotante "Ejemplo" en naranja */
.example-section::before {
    content: "Ejemplo"; /* El texto de la etiqueta */
    position: absolute;
    top: -12px; /* Mueve la etiqueta 12px por encima del borde superior */
    left: 15px; /* Posiciona la etiqueta a 15px del borde izquierdo */
    background: #fd7e14; /* Color naranja distintivo */
    color: #F8F8F8; /* Color del texto de la etiqueta */
    padding: 3px 8px; /* Espaciado interno de la etiqueta */
    border-radius: 6px; /* Bordes redondeados para la etiqueta */
    font-size: 11px; /* Tama√±o de fuente de la etiqueta */
    font-weight: 600; /* Peso de fuente de la etiqueta */
    letter-spacing: 0.5px; /* Espaciado entre letras */
    text-transform: uppercase; /* Texto en may√∫sculas */
    box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Sombra sutil para la etiqueta */
}

.example-section .problem-statement {
    background-color: #f2f4f6;
    border-left: 5px solid var(--primary-accent); /* Mantenemos este azul para el statement del problema */
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.example-section .problem-statement h4 {
    margin-top: 0;
    color: var(--primary-accent-dark); /* Color oscuro del acento para el t√≠tulo del problema */
}

/* Estilo para el enlace "Resolver Ejemplo" */
.solve-example-link {
    display: block; /* Para que ocupe su propia l√≠nea */
    text-align: right; /* Alineado a la derecha */
    margin-top: 15px; /* Espacio superior para separarlo del contenido */
    font-size: 14px;
    color: #fd7e14; /* Mismo color naranja que la etiqueta */
    text-decoration: none; /* Sin subrayado por defecto */
    font-weight: 600;
    transition: color 0.2s ease;
}

.solve-example-link:hover {
    color: #e06c0c; /* Naranja m√°s oscuro al pasar el rat√≥n */
    text-decoration: underline; /* Subrayado al pasar el rat√≥n */
}

.code-block {
    position: relative;
    background-color: #0d1117; /* Fondo gris oscuro */
    border: 1px solid #30363d;
    border-radius: 8px;
    margin: 0px 0px;
    font-family: 'Fira Code', 'Consolas', monospace;
    font-size: 0.95em;
    line-height: 1.5;
    color: #c9d1d9; /* Color de texto por defecto */
    overflow: hidden; /* Importante para que los bordes redondeados se vean bien */
    padding-top: 0px; /* Espacio para el header + la l√≠nea divisoria */
    padding-bottom: 0px; /* Espacio inferior */
    padding-left: 15px; /* Espacio a la izquierda */
    padding-right: 15px; /* Espacio a la derecha */
}

/* Barra divisoria entre el header y el c√≥digo */
.code-block::before {
    content: '';
    position: absolute;
    top: 50px; /* Ajusta esto para la posici√≥n de la l√≠nea */
    left: 0;
    right: 0;
    height: 1px; /* Grosor de la l√≠nea */
    background-color: #30363d; /* Color de la l√≠nea, similar al borde */
    z-index: 0; /* Asegura que la l√≠nea est√© debajo del texto */
}


.code-block .code-lang {
    position: absolute;
    top: 13px; /* Separaci√≥n desde la parte superior del .code-block */
    left: 15px; /* Separaci√≥n desde la izquierda del .code-block */
    background: transparent; /* Sigue siendo transparente */
    -webkit-background-clip: text; /* Aplica el degradado al texto */
    background-clip: text; /* Est√°ndar */
    color: transparent; /* Hace el color del texto transparente */
    
    /* Degradado de blanco brillante a azul muy claro, limpio y n√≠tido */
    background-image: linear-gradient(135deg, #F0F8FF 0%, #FFFFFF 50%, #E0FFFF 100%);
    /*
        #F0F8FF: Un blanco muy suave, casi azulado, como punto de partida
        #FFFFFF: Blanco puro para el centro m√°s brillante
        #E0FFFF: Un azul claro muy sutil para el final, que mantiene la luminosidad
    */

    padding: 0; /* Sin padding */
    border-radius: 0; /* Sin bordes redondeados */
    font-size: 13px; /* Tama√±o un poco m√°s grande */
    font-weight: 700; /* Peso en negrita para que el texto resalte */
    text-transform: none; /* Sin may√∫sculas forzadas */
    letter-spacing: 0.5px; /* Espaciado sutil */
    box-shadow: none; /* ¬°Eliminado! Sin sombra en la caja */
    text-shadow: none; /* ¬°Eliminado! Sin sombra en el texto ni efecto de glow */
    z-index: 2; /* Asegura que la etiqueta est√© sobre la l√≠nea divisoria */
}

.code-block .copy-btn {
    position: absolute;
    top: 10px; /* Alineado con la etiqueta de lenguaje */
    right: 15px; /* Separaci√≥n desde la derecha del .code-block */
    background: #161b22;
    border: 1px solid #30363d;
    color: #8b949e;
    padding:4px 8px; /* Un poco m√°s de padding para que el bot√≥n sea m√°s c√≥modo */
    border-radius: 4px;
    cursor: pointer;
    font-size: 11px;
    z-index: 2; /* Asegura que el bot√≥n est√© sobre la l√≠nea divisoria */
    transition: background 0.2s, color 0.2s, border-color 0.2s;
}

.code-block .copy-btn:hover {
    background-color: #21262d;
    border-color: #8b949e;
    color: #c9d1d9;
}

.code-block .copy-btn i {
    font-size: 11px; /* Ajustado para que el √≠cono no sea demasiado grande */
    margin-right: 4px; /* Peque√±o espacio entre el √≠cono y el texto "Copiar" */
}

/* Contenedor del c√≥digo - ahora con padding interno para el contenido */
.code-block pre {
    margin: 0;
    padding-top: 0px; /* Padding para separar el c√≥digo de la l√≠nea divisoria */
    padding-bottom: 0px; /* Elimina padding adicional si ya est√° en .code-block */
    overflow-x: auto;
    white-space: pre-wrap; /* Mantiene el formato y envuelve l√≠neas largas */
    word-wrap: break-word; /* Rompe palabras para evitar desbordamiento */
    background: transparent !important; /* Asegura que el fondo del pre no opaque el del code-block */
}

.code-block code {
    display: block;
    padding: 0 !important; /* Asegura que el padding del code sea 0 */
    background: transparent !important; /* Asegura que el fondo del code no opaque el del code-block */
    /* Aqu√≠ se aplicar√°n los estilos de .token */
}

/* --- Sintaxis tipo ChatGPT (Colores de tokens) --- */
.token.comment       { color: #8b949e; font-style: italic; }
.token.keyword       { color: #ff7b72; }
.token.string        { color: #a5d6ff; }
.token.number        { color: #f2cc60; }
.token.boolean       { color: #f2cc60; }
.token.function      { color: #d2a8ff; }
.token.property      { color: #79c0ff; }
.token.punctuation   { color: #c9d1d9; }


/* Asegurar que los comentarios en c√≥digo no hereden estilos de headers */
.code-block .token.comment,
.code-block .hljs-comment {
    color: #8b949e !important;
    font-size: 0.95em !important;
    font-style: italic !important;
    font-weight: normal !important;
}

/* Prevenir que los # en c√≥digo se conviertan en headers */
.code-block code .hljs-doctag,
.code-block code .hljs-meta {
    color: inherit !important;
    font-size: inherit !important;
}

/* Reset para elementos dentro de bloques de c√≥digo */
.code-block * {
    font-size: 0.95em !important;
    font-weight: normal !important;
    line-height: 1.5 !important;
}
/* Asegura compatibilidad con Highlight.js */
.hljs {
    background: transparent !important;
    padding: 0 !important;
}

/* Estilos adicionales para Font Awesome si no los tienes globales */
.fas {
    font-family: "Font Awesome 5 Free";
    font-weight: 900; /* Necesario para los iconos s√≥lidos */
}
/* ======================= ESTILOS PARA LA ESTETICA DENTRO DEL CHAT =============================  */

/* √Årea de entrada */
.chat-input-card {
    background: var(--background-light); /* M√°s consistente con la paleta */
    padding: 8px; 
    border-top: none;
    display: flex;
    flex-direction: column;
    gap: 6px;
    box-shadow: 0 -6px 18px rgba(0, 0, 0, 0.04);
    z-index: 10;
    border-radius: 12px 12px 0 0; /* redondeo arriba para elegancia */
}

.chat-input-card textarea {
    width: 100%;
    padding: 12px 16px;
    font-size: 15px;
    border: 1px solid var(--border-light);
    border-radius: 18px;
    resize: none;
    overflow: hidden;
    line-height: 1.5;
    max-height: 130px;
    background: #fff;
    color: var(--text-dark);
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    font-family: var(--font-body);
    box-shadow: var(--shadow-subtle);
}

.chat-input-card textarea:focus {
    outline: none;
    border-color: var(--primary-accent);
    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.15);
}

.chat-tools {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 8px;
}

.keyboard-buttons {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
}

.keyboard-category {
    background: transparent;
    color: var(--code-syntax-comment);
    border: none;
    padding: 6px 14px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.25s ease;
}

.keyboard-category:hover {
    background: rgba(0, 123, 255, 0.08); /* sutil highlight */
    color: var(--primary-accent);
    transform: translateY(-1px);
    box-shadow: var(--shadow-subtle);
}

.keyboard-category:active {
    background: rgba(0, 123, 255, 0.15); /* un poco m√°s marcado */
    transform: translateY(0);
    box-shadow: inset var(--shadow-subtle);
}


.send-btn {
    background: transparent;
    color: var(--primary-accent);
    border: none;
    font-size: 20px;
    padding: 8px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.2s ease-in-out;
}

.send-btn:hover {
    background: rgba(0, 123, 255, 0.12); /* Un poco m√°s visible pero suave */
    color: var(--primary-accent);        /* Mantiene la identidad */
    transform: translateY(-1px);
    box-shadow: 0 3px 6px rgba(0,0,0,0.12); /* Sombra m√°s natural, sin bordes duros */
}

.send-btn:active {
    background: rgba(0, 123, 255, 0.2);  /* M√°s intenso al presionar */
    color: var(--primary-accent);        /* CONSISTENCIA: no cambia a negro */
    transform: scale(0.96);              /* Peque√±o ‚Äúclick feedback‚Äù */
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.12); /* Elegante, sin dureza */
}


.send-btn i {
    margin: 0;
}

/* Panel de teclado virtual */
.keyboard-panel {
    display: none;
    flex-direction: column;
    padding: 12px;
    background: var(--background-light);
    border-top: 1px solid var(--border-light);
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.03);
    z-index: 5;
    max-height: 180px;
    overflow-y: auto;
    border-radius: 0 0 12px 12px;
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out;
}

.keyboard-panel.active {
    display: flex;
    animation: fadeIn 0.25s ease-out;
}

.keyboard-panel button {
    background: #fff;
    border: 1px solid var(--border-light);
    padding: 6px 10px;
    font-size: 13px;
    font-family: var(--font-body);
    color: var(--text-dark);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: var(--shadow-subtle);
    min-width: 36px;
    text-align: center;
}

.keyboard-panel button:hover {
    background-color: var(--step-highlight);
    border-color: #cdd2d7;
    box-shadow: var(--shadow-medium);
    transform: translateY(-1px);
}

.keyboard-panel .close-btn {
    background-color: var(--border-light);
    color: #6c757d;
    font-weight: 500;
    font-size: 12px;
    border: none;
    border-radius: 6px;
    padding: 5px 10px;
    margin-bottom: 6px;
    align-self: flex-end;
    cursor: pointer;
    transition: all 0.2s ease;
}

.keyboard-panel .close-btn:hover {
    background-color: #cdd2d7;
    color: var(--text-dark);
    box-shadow: var(--shadow-subtle);
    transform: translateY(-1px);
}

.keyboard-panel-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
    gap: 6px;
}

/* Indicador de carga optimizado */
.loading-indicator {
    display: flex;
    gap: 6px; /* Espacio reducido */
    padding: 8px 0; /* Padding reducido */
    will-change: transform, opacity;
}

.loading-dot {
    width: 4px; /* Tama√±o reducido */
    height: 4px; /* Tama√±o reducido */
    border-radius: 50%;
    background-color: var(--primary-accent);
    opacity: 0.8;
    animation: bounce 1.4s infinite ease-in-out;
    will-change: transform, opacity;
}

/* Animation delays for dots */
.loading-dot:nth-child(2) { animation-delay: 0.15s; }
.loading-dot:nth-child(3) { animation-delay: 0.3s; }

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); opacity: 1; } /* Movimiento reducido */
}

/* Optimizaci√≥n de rendimiento para MathJax */
.MJXc-display, .MJXc-math {
    will-change: transform, opacity;
}

/* Nuevos estilos para texto en negrita */
strong, b {
    font-weight: 700;
    color: var(--bold-color);
}

/* Media queries para responsividad */
@media (max-width: 768px) {
.chat-container {
    height: 100vh;
    border-radius: 0;
    max-height: unset;
}

body {
    align-items: stretch;
}
.secondary-header {
    padding: 8px 10px;
    gap: 10px;
}

.tutor-button, .exam-type-select, .exam-button {
    font-size: 0.75em;
    padding: 5px 10px;
    border-radius: 5px;
}

.exam-type-select {
    background-position: right 8px center;
    background-size: 8px;
}
.chat-header {
    font-size: 14px; /* Tama√±o consistente con el estilo general */
    padding: 10px 12px; /* Padding reducido */
    padding-top: 10px; /* Eliminado el padding-top adicional */
}

.secondary-header {
    padding: 8px 15px;
    gap: 10px;
}

.header-mode-toggle {
    font-size: 0.8em; /* Reducir el tama√±o de fuente en m√≥viles */
}

.chat-box {
    padding: 12px; /* Padding reducido */
    padding-top: 50px; /* Espacio reducido para la cabecera */
    gap: 12px; /* Espacio reducido */
}

.chat-input-card {
    padding: 4px 4px; /* Padding reducido */
    gap: 4px; /* Espacio reducido */
}

.chat-input-card textarea {
    padding: 4px 6px; /* Padding reducido */
    font-size: 14px; /* Tama√±o reducido */
    max-height: 60px; /* Altura reducida */
}

.keyboard-category {
    padding: 4px 8px; /* Padding reducido */
    font-size: 11px; /* Tama√±o reducido */
}

.send-btn {
    padding: 6px 12px; /* Padding reducido */
    font-size: 16px; /* Tama√±o reducido */
}

.keyboard-panel {
    padding: 8px; /* Padding reducido */
    max-height: 160px; /* Altura reducida */
}

.keyboard-panel button {
    padding: 5px 8px; /* Padding reducido */
    font-size: 12px; /* Tama√±o reducido */
    min-width: 30px; /* Ancho reducido */
}

.keyboard-panel-grid {
    grid-template-columns: repeat(auto-fill, minmax(45px, 1fr)); /* Ancho reducido */
    gap: 5px; /* Espacio reducido */
}

.keyboard-panel {
    max-height: 350px; /* Altura reducida */
}

/* Burbujas de chat en m√≥vil */
.chat-msg.user .chat-bubble {
    max-width: 90%;
}

.chat-msg.bot .chat-bubble {
    max-width: 100%;
}

.copy-latex-btn {
    right: 0px;
    top: -22px; /* Posici√≥n ajustada */
    transform: none;
}

.full-solution, .definition {
    padding: 12px 15px; /* Padding reducido */
}

h3 {
    font-family: var(--font-title);
    font-weight: 600;
    font-size: 1.1em; /* Tama√±o reducido */
    margin: 0.8em 0 0.4em; /* Margen reducido */
    color: var(--primary-accent-dark);
}

strong, b {
    font-weight: 700;
    color: var(--bold-color);
}

.reasoner-toggle {
    padding: 4px 10px; /* Reducir el padding */
    border-radius: 20px; /* Un poco menos redondeado, si lo prefieres */
    gap: 6px; /* Reducir el espacio entre elementos */
    flex-shrink: 0;
}

.reasoner-label {
    font-size: 0.7em; /* Hacer la fuente m√°s peque√±a */
}

.switch {
    width: 36px; /* Ancho del switch m√°s peque√±o */
    height: 20px; /* Alto del switch m√°s peque√±o */
}

.slider:before {
    height: 16px; /* Tama√±o del thumb m√°s peque√±o */
    width: 16px; /* Tama√±o del thumb m√°s peque√±o */
    left: 2px;
    bottom: 2px;
}

input:checked + .slider:before {
    transform: translateX(16px); /* Ajustar el movimiento del thumb (36px - 2px left - 2px right - 16px thumb width = 16px travel) */
}

.reasoner-warning {
    bottom: 15px; /* Mover la advertencia un poco m√°s arriba en m√≥viles */
    padding: 10px 20px;
    font-size: 0.9em; /* Fuente un poco m√°s peque√±a para la advertencia */
}
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
}



.custom-keyboard {
  margin-top: 0em;
  padding: 0px; /* ¬°CLAVE! Reducimos el padding general para reducir altura */
  background: #f8f8f8;
  border-radius: 2px;
  display: flex;
  flex-direction: column;
  gap: 3px; /* ¬°CLAVE! Reducimos el espacio entre filas para reducir altura */
  box-shadow: 0 -3px 12px rgba(0, 0, 0, 0.06);
  box-sizing: border-box;

  /* Mantener propiedades de posici√≥n y visibilidad seg√∫n tu JS */
  /* position: fixed; bottom: 0; left: 0; right: 0; width: 100%; z-index: 100; */
}

/* --- Filas de Botones dentro del Teclado --- */
.keyboard-row {
  display: flex;
  justify-content: stretch;
  gap: 3px; /* ¬°CLAVE! Reducimos a√∫n m√°s el espacio entre los botones */
  width: 100%;
}

/* --- Estilo de los Botones Individuales del Teclado: Altura Reducida --- */
.custom-keyboard button {
  font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
  font-size: 0.7em; /* ¬°CLAVE! Fuente m√°s peque√±a para los botones */
  padding: 2px 0; /* ¬°CLAVE! Padding vertical muy reducido */
  flex-grow: 1;
  flex-basis: 0;
  text-align: center;
  background: #FFFFFF;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03);
  color: #333;
  min-width: 25px; /* Ancho m√≠nimo ajustado */
  height: 40px; /* ¬°CLAVE! Altura muy reducida para los botones */
  box-sizing: border-box;
  font-weight: 600;
}

.custom-keyboard button:hover {
  background: #f0f0f0;
  border-color: #d0d0d0;
}

.custom-keyboard button:active {
  background: #e5e5e5;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
  transform: translateY(1px);
}

/* --- Estilo para botones con iconos (flechas, retroceso) --- */
.custom-keyboard button i {
    font-size: 0.8em; /* Hacemos los iconos m√°s peque√±os */
    color: #555;
}

/* --- Estilo para botones con LaTeX renderizado --- */
.custom-keyboard button .latex-button {
    font-size: 0.75em; /* Hacemos el LaTeX m√°s peque√±o */
    color: #444;
}

/* --- El bot√≥n principal "Keyboard" (Toggle) - Mantenemos tama√±o est√°ndar --- */
/* Es importante que este bot√≥n no se haga tan peque√±o, ya que no forma parte del teclado en s√≠. */
#toggleCustomKeyboardBtn {
    background: #ffffff;
    color: var(--primary-accent, --primary-accent-dark);
    border: 1px solid #e0e0e0;
    padding: 8px 12px; /* Reducimos ligeramente su padding tambi√©n */
    font-size: 0.9em; /* Reducimos ligeramente su fuente */
    font-weight: 600;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.2s ease;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
    margin-top: 6px;
    margin-bottom: 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

#toggleCustomKeyboardBtn:hover { background: #f5f5f5; border-color: #d5d5d5; }
#toggleCustomKeyboardBtn:active { background: #e0e0e0; box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1); transform: translateY(1px); }

#toggleCustomKeyboardBtn::before {
    content: '\f11c';
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
    font-size: 1em; /* Ajustamos el tama√±o del icono */
    color: var(--primary-accent, --primary-accent-dark);
}

/* --- Clase 'hidden' (Mantener como est√°) --- */
.hidden {
  display: none;
}

/* --- Estilo para el bot√≥n de Espacio: M√°s Ancho --- */
.custom-keyboard .space-button {
    flex-grow: 5;
    font-size: 0.9em; /* Ajustamos la fuente para que se adapte al nuevo tama√±o de los botones */
    font-weight: 600;
}

/* --- Estilo para el bot√≥n de may√∫sculas cuando est√° activo (Mantener) --- */
#shiftButton.active-shift {
    background-color: var(--primary-accent,--primary-accent-dark);
    color: white;
    border-color: var(--primary-accent, --primary-accent-dark);
    box-shadow: 0 2px 6px rgba(0, 123, 255, 0.2);
}
#shiftButton.active-shift i {
    color: white;
}

/* --- Media Queries para responsividad --- */
@media (max-width: 768px) {
    .custom-keyboard {
        padding: 4px;
        gap: 3px;
        border-radius: 6px 6px 0 0;
    }

    .keyboard-row {
        display: flex; /* Activar Flexbox */
        flex-wrap: nowrap; /* ¬°CLAVE! Evita que los elementos salten de l√≠nea */
        gap: 2px; /* Espacio entre los botones */
        justify-content: space-between; /* Distribuye el espacio uniformemente entre los botones */
        align-items: stretch; /* Asegura que los elementos se estiren verticalmente si es necesario (no deber√≠a afectar si la altura es fija) */
    }

    .custom-keyboard button {
        font-size: 1em;
        padding: 5px 0;
        height: 35px; /* ¬°Altura fija, como la ten√≠as! */

        /* ANCHO: Se estira para llenar el espacio disponible */
        flex-grow: 1; /* Permite que el bot√≥n crezca para ocupar el espacio */
        flex-shrink: 1; /* Permite que el bot√≥n se encoja si no hay suficiente espacio */
        flex-basis: 0; /* Punto de partida para el c√°lculo del tama√±o, ayuda a que `flex-grow` sea m√°s efectivo */

        min-width: 0; /* Permite que los botones se hagan muy estrechos si es necesario, sin que un `min-width` los fuerce a saltar de l√≠nea. Si se ven DEMASIADO apretados, puedes ajustar este valor un poco. */

        border-radius: 4px;
    }

    .custom-keyboard button i {
        font-size: 1em;
    }

    .custom-keyboard button .latex-button {
        font-size: 1em;
    }

    #toggleCustomKeyboardBtn {
        padding: 6px 8px;
        font-size: 0.8em;
        gap: 6px;
        margin-top: 4px;
        border-radius: 6px;
    }

    #toggleCustomKeyboardBtn::before {
        font-size: 0.9em;
    }

    .custom-keyboard .space-button {
        flex-grow: 4; /* El bot√≥n de espacio seguir√° siendo el doble de ancho que los dem√°s */
        font-size: 0.8em;
        /* No necesitas un min-width aqu√≠ a menos que sea muy espec√≠fico, ya que flex-grow lo estirar√°. */
    }
}

math-field::part(virtual-keyboard-toggle)::after {
  display: none;
}
math-field::part(virtual-keyboard-toggle) {
  display: none;
}
math-field::part(menu-toggle) {
  display: none;
}

/* Estilos para el men√∫ contextual */
#context-menu {
    display: none;
    flex-direction: column;
    gap: 4px;
    padding: 8px;
    border-radius: 5px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.15);
    animation: fadeIn 0.2s ease-out;
}

.context-menu-item {
    background: #FFFFFF;
    border: 1px solid #dee2e6;
    padding: 6px 12px;
    font-size: 13px;
    font-family: var(--font-body);
    color: #343a40;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    text-align: left;
    white-space: nowrap;
}

.context-menu-item:hover {
    background-color: #f0f2f5;
    border-color: #cdd2d7;
    box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    transform: translateY(-1px);
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}

/* A√±ade esto a tu CSS */
.plotly-graph-container {
  width: 100%;
  height: 500px;
  margin: 20px 0;
  border: 1px solid #eee;
  border-radius: 8px;
  overflow: hidden;
  background-color: #f9f9f9;
  display: flex;
  justify-content: center;
  align-items: center;
}

.plotly-graph-container:empty::before {
    content: "Cargando gr√°fico...";
    color: #666;
    font-style: italic;
}

.plotly-error {
    color: #d32f2f;
    padding: 15px;
    background-color: #ffebee;
    border-radius: 4px;
    border: 1px solid #ef9a9a;
}

.plotly-graph-container > div {
    width: 100% !important;
    height: 100% !important;
}

/* Contenedor del bot√≥n de idioma */
.language-buttons {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin-left: 20px;
    margin-right: 6px;
}

/* Estilo del bot√≥n de idioma */
#languageToggleButton {
    background: transparent;
    color: #495057;
    border: 1px solid #dee2e6;
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    box-shadow: none;
    
    position: relative;
    width: 80px;
    height: 28px;
    overflow: hidden;
}

/* Contenedores de texto */
.en-text, .es-text {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    
    /* Animaci√≥n del texto: opacidad y desplazamiento */
    transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out;
}

/* Estado inicial: texto en ingl√©s visible */
.en-text {
    opacity: 1;
    transform: translateY(0);
}

/* Estado inicial: texto en espa√±ol invisible */
.es-text {
    opacity: 0;
    transform: translateY(100%);
}

/* Animaci√≥n cuando el bot√≥n tiene la clase 'es-active' */
#languageToggleButton.es-active .en-text {
    opacity: 0;
    transform: translateY(-100%);
}

#languageToggleButton.es-active .es-text {
    opacity: 1;
    transform: translateY(0);
}

/* Animaci√≥n de sacudida m√°s lenta y org√°nica */
@keyframes wakeUpShake {
    0%, 100% { transform: translateX(0) rotate(0deg); }
    25% { transform: translateX(-5px) rotate(-1deg); }
    50% { transform: translateX(5px) rotate(1deg); }
    75% { transform: translateX(-5px) rotate(-1deg); }
}

/* Aplica la animaci√≥n cuando se hace clic en el bot√≥n */
#languageToggleButton:active {
    animation: wakeUpShake 0.8s ease-in-out;
}

/* Preloader Styles */
.preloader {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: #ffffff;
display: flex;
justify-content: center;
align-items: center;
z-index: 9999;
transition: opacity 0.5s ease;
}

.preloader-content {
text-align: center;
}

.spinner {
width: 50px;
height: 50px;
border: 5px solid #f3f3f3;
border-top: 5px solid #3498db;
border-radius: 50%;
animation: spin 1s linear infinite;
margin: 0 auto 20px;
}

@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}

.preloader p {
color: #333;
font-family: 'Poppins', sans-serif;
font-size: 1.2em;
}

.preloader.hidden {
opacity: 0;
pointer-events: none;
}

/* Contenedor general para centrar en la p√°gina */
.math-container {
  display: flex;
  justify-content: center; /* Centra horizontal */
  margin: 12px 0;          /* Un poco de aire vertical */
}

/* Bloque clickeable que ocupa todo el ancho */
.clickable-math-block {
    display: block; /* Ocupa todo el ancho disponible */
    width: 100%; /* Asegura que el ancho sea completo */
    text-align: center;
    padding: 12px 16px;
    border: 1px solid #eef0f3; /* Borde muy sutil para definici√≥n */
    border-radius: 8px;
    background-color: transparent; /* Fondo transparente */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08); /* Sombra un poco m√°s visible */
    cursor: pointer;
    transition: all 0.2s ease;
    user-select: none;
}



/* Ajustes internos de la ecuaci√≥n */
.math-equation {
  margin: 0;
  padding: 0;
}
/* ======================== ESTILOS DEL PANEL SELECTOR ======================== */
.matrix-selector-panel {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #fcfcfc;
    padding: 24px;
    border-radius: 16px;
    z-index: 1000;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    border: 1px solid #e9ecef;
    max-width: 400px;
    width: 90%;
}

/* ======================== ESTILOS DEL BOT√ìN DE CERRAR ESPEC√çFICO ======================== */
.matrix-selector-panel .close-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: #ffffff; /* Fondo blanco */
    border: 1px solid #e9ecef; /* Borde sutil */
    border-radius: 10px; /* Bordes redondeados */
    color: #495057; /* Texto en gris oscuro */
    font-size: 1rem;
    padding: 8px 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); /* Sombra ligera por defecto */
    font-weight: 500;
}

.matrix-selector-panel .close-btn:hover {
    background-color: #fdfdfe;
    border-color: #ced4da;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
    transform: translateY(-2px);
}

.matrix-selector-panel .close-btn:active {
    background-color: #eef0f3;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.08);
    transform: translateY(0);
}

/* ======================== ESTILOS DE LOS GRIDS ======================== */
/* Grid de selecci√≥n de matriz (fijo 5x5) */
.matrix-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 15px;
    margin-top: 15px;
}

/* Grid de niveles (filas o casos) - mantiene el formato adaptable */
.level-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
    gap: 12px;
    justify-items: center;
    margin-top: 15px;
}

/* ======================== ESTILOS DE LOS BOTONES ======================== */
.level-grid button, .matrix-grid button {
    background-color: #ffffff;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    color: #495057;
    font-size: 1rem;
    padding: 12px 0;
    width: 100%;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

/* Efecto al pasar el cursor (hover) */
.level-grid button:hover, .matrix-grid button:hover {
    background-color: #fdfdfe;
    border-color: #ced4da;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
    transform: translateY(-2px);
}

/* Bot√≥n activo (seleccionado) */
.level-grid button.active, .matrix-grid button.active {
    background-color: #e6f7ff;
    border-color: #87b2e3;
    color: #2e6099;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08), inset 0 0 0 1px #87b2e3;
    transform: translateY(0);
}

/* Estilo espec√≠fico para los botones de la matriz para que sean cuadrados */
.matrix-grid button {
    aspect-ratio: 1 / 1;
    width: 100%;
    padding: 0;
    font-size: 1.1rem;
}

/* ======================== ESTILOS RESPONSIVOS ======================== */
@media (max-width: 400px) {
    .level-grid {
        grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
        gap: 8px;
    }
    .matrix-selector-panel {
        padding: 20px 15px;
    }
    .matrix-grid {
      gap: 8px;
    }
}


.copy-toast {
    position: absolute;
    background: #4caf50; /* verde para √©xito */
    color: white;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 0.9em;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    opacity: 0;
    transform: translateY(0);
    transition: opacity 0.3s, transform 0.3s;
    pointer-events: none;
    z-index: 9999;
}

.copy-toast.show {
    opacity: 1;
    transform: translateY(-10px);
}

.copy-toast.error {
    background: #f44336; /* rojo para error */
}


</style></head>
<body>

  <!-- Script para mostrar el preloader inmediatamente -->
  <script>
    // Mostrar preloader inmediatamente
    document.body.classList.add('preloader-active');
  </script>
  <!-- Preloader -->
  <div id="preloader" class="preloader">
    <div class="preloader-content">
      <div class="spinner"></div>
      <p>Loading math tools and resources...</p>
    </div>
  </div>
  <div class="chat-container">
  
  <div class="chat-header">
    <button id="mainModeToggleButton" class="header-mode-toggle">Math Chat</button>

    <div class="language-buttons">
      <!-- Bot√≥n de idioma CORREGIDO -->
      <button id="languageToggleButton" class="lang-button">
          <span class="en-text">English</span>
          <span class="es-text">Espa√±ol</span>
      </button>
    </div>
    
    <div class="reasoner-toggle">
      <label class="switch">
        <input type="checkbox" id="reasonerToggle">
        <span class="slider round"></span>
      </label>
      <span class="reasoner-label">Pro</span>
      <div class="reasoner-tooltip">
        <i class="fas fa-info-circle"></i>
        <span class="tooltip-text">Slow mode for difficult problems. It deactivates after 2 prompts.</span>
      </div>
    </div>
  </div>

  <div id="secondaryHeader" class="secondary-header" style="display: none;">
      <div class="tutor-controls-left">
          <button id="hintButton" class="tutor-button">Hint</button>
          <button id="theoreticalButton" class="tutor-button">Theoretical</button>
          <button id="generateProblemButton" class="tutor-button">Generate Problem</button>
      </div>

      <div id="tutorExamGroup" class="tutor-exam-group">
          <select id="examTypeSelect" class="exam-type-select">
              <option value="none">-- Select a exam (coming soon) --</option>
              <option value="icfes">ICFES (Colombia)</option>
              <option value="saber">Pruebas Saber (Colombia)</option>
              <option value="sat">SAT (USA)</option>
              <option value="gre">GRE (USA)</option>
              <option value="ib">IB (International Baccalaureate)</option>
              <option value="general">General (Matem√°ticas)</option>
          </select>

          <button id="startTutorExamBtn" class="exam-button">Start</button>
      </div>
  </div>

  <div class="chat-box" id="chatBox"></div>
    
  <div id="keyboard-algebra" class="keyboard-panel">
      <button class="close-btn" onclick="closeKeyboard()">close</button>

      <button onclick="showMatrixSizeSelector()">
        <span class="latex-button">\( \begin{bmatrix} \boxed{} & \boxed{} \\ \boxed{} & \boxed{} \end{bmatrix} \)</span>
      </button>
      
      <div class="keyboard-panel-grid">
        <button onclick="insertSymbol('\\placeholder{} \\cdot \\placeholder{}')">
          <span class="latex-button">\( \cdot \)</span>
        </button>
        <button onclick="insertSymbol('\\placeholder{}^\\top')">
          <span class="latex-button">\( \boxed{}^\top \)</span>
        </button>
        <button onclick="insertSymbol('\\placeholder{}^{-1}')">
          <span class="latex-button">\( \boxed{}^{-1} \)</span>
        </button>
        <button onclick="insertSymbol('\\left| \\placeholder{} \\right|')">
          <span class="latex-button">\( | \boxed{} | \)</span>
        </button>
        <button onclick="insertSymbol('\\left\\| \\placeholder{} \\right\\|')">
          <span class="latex-button">\( || \boxed{} || \)</span>
        </button>
        <button onclick="insertSymbol('\\overline{\\placeholder{}}')">
          <span class="latex-button">\( \overline{\boxed{}} \)</span>
        </button>
        <button onclick="insertSymbol('\\underline{\\placeholder{}}')">
          <span class="latex-button">\( \underline{\boxed{}} \)</span>
        </button>
        <button onclick="insertSymbol('\\widehat{\\placeholder{}}')">
          <span class="latex-button">\( \widehat{\boxed{}} \)</span>
        </button>
        <button onclick="insertSymbol('\\placeholder{} \\times \\placeholder{}')">
          <span class="latex-button">\( \times \)</span>
        </button>
        <button onclick="insertSymbol('\\placeholder{} \\oplus \\placeholder{}')">
          <span class="latex-button">\( \oplus \)</span>
        </button>
        <button onclick="insertSymbol('\\placeholder{} \\otimes \\placeholder{}')">
          <span class="latex-button">\( \otimes \)</span>
        </button>
        <button onclick="insertSymbol('\\langle \\placeholder{}, \\placeholder{} \\rangle')">
          <span class="latex-button">\( \langle , \rangle \)</span>
        </button>
        <button onclick="insertSymbol('T: \\placeholder{} \\to \\placeholder{}')">
          <span class="latex-button">\( T \to \)</span>
        </button>
        <button onclick="insertSymbol('\\lambda')">
          <span class="latex-button">\( \lambda \)</span>
        </button>
        <button onclick="insertSymbol('v')">
          <span class="latex-button">\( v \)</span>
        </button>
        <button onclick="insertSymbol('I')">
          <span class="latex-button">\( I \)</span>
        </button>
        <button onclick="insertSymbol('\\det(\\placeholder{} - \\lambda \\placeholder{})')">
          <span class="latex-button">\( \det() \)</span>
        </button>
        <button onclick="insertSymbol('\\vec{\\placeholder{}}')">
          <span class="latex-button">\( \vec{v} \)</span>
        </button>
        <button onclick="insertSymbol('\\hat{\\placeholder{}}')">
          <span class="latex-button">\( \hat{v} \)</span>
        </button>
        <button onclick="insertSymbol('\\pmod{\\placeholder{}}')">
          <span class="latex-button">\( \pmod{} \)</span>
        </button>
        <button onclick="insertSymbol('\\mapsto')">
          <span class="latex-button">\( \mapsto \)</span>
        </button>
      </div>
  </div>

  <!-- Panel selector de tama√±o de matriz (inicialmente oculto) -->
  <div id="matrix-size-selector" class="matrix-selector-panel" style="display:none;">
      <button class="close-btn" onclick="closeMatrixSelector()">close</button>
      <h3>Select Matrix Size:</h3>
      <div class="matrix-grid"></div>
  </div>

  <div id="keyboard-calculus" class="keyboard-panel">
      <button class="close-btn" onclick="closeKeyboard()">close</button>
      <div class="keyboard-panel-grid">
        <button onclick="showCasesSelector()">
          <span class="latex-button">
            \( 
              \left\{ 
                \begin{array}{l} 
                  \, \\ 
                  \, 
                \end{array} 
              \right. 
            \)
          </span>
        </button>

        <button onclick="insertSymbol('\\frac{d}{dx}\\placeholder{}')">
          <span class="latex-button">\( \frac{d}{dx}\boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\frac{d^2}{dx^2}\\placeholder{}')">
          <span class="latex-button">\( \frac{d^2}{dx^2}\boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\frac{\\partial}{\\partial \\placeholder{}}\\placeholder{}')">
          <span class="latex-button">\( \frac{\partial}{\partial \boxed{}}\boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\frac{\\partial^2 \\placeholder{}}{\\partial \\placeholder{}\\partial \\placeholder{}}')">
          <span class="latex-button">\( \frac{\partial^2 \boxed{}}{\partial \boxed{}\partial \boxed{}} \)</span>
        </button>
        <button onclick="insertSymbol('\\int \\placeholder{}\\,d\\placeholder{}')">
          <span class="latex-button">\( \int \boxed{}\thinspace d\boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\int_{\\placeholder{}}^{\\placeholder{}} \\placeholder{}\\,d\\placeholder{}')">
          <span class="latex-button">\( \int_{\boxed{}}^{\boxed{}} \boxed{}\thinspace d\boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\iint \\placeholder{}\\,d\\placeholder{}')">
          <span class="latex-button">\( \iint \boxed{}\thinspace d\boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\iiint \\placeholder{}\\,d\\placeholder{}')">
          <span class="latex-button">\( \iiint \)</span>
        </button>
        <button onclick="insertSymbol('\\oint \\placeholder{}\\,d\\placeholder{}')">
          <span class="latex-button">\( \oint \boxed{}\thinspace d\boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\oint_C \\placeholder{}\\,d\\placeholder{}')">
          <span class="latex-button">\( \oint_C \)</span>
        </button>
        <button onclick="insertSymbol('\\nabla \\placeholder{}')">
          <span class="latex-button">\( \nabla \boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\nabla \\cdot \\placeholder{}')">
          <span class="latex-button">\( \nabla \cdot \)</span>
        </button>
        <button onclick="insertSymbol('\\nabla \\times \\placeholder{}')">
          <span class="latex-button">\( \nabla \times \)</span>
        </button>
        <button onclick="insertSymbol('\\Delta \\placeholder{}')">
          <span class="latex-button">\( \Delta \boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\lim_{x \\to \\placeholder{}} \\placeholder{}')">
          <span class="latex-button">\( \lim_{\boxed{} \to \boxed{}} \boxed{} \)</span>
        </button>
        <button onclick="insertSymbol('\\frac{d}{dx}\\left(\\frac{\\placeholder{}}{\\placeholder{}}\\right) = \\frac{\\placeholder{}\\frac{d}{dx}(\\placeholder{}) - \\placeholder{}\\frac{d}{dx}(\\placeholder{})}{(\\placeholder{})^2}')">
          <span class="latex-button">\( (\frac{f}{g})' \)</span>
        </button>

        <button onclick="insertSymbol('\\epsilon')">
          <span class="latex-button">\( \epsilon \)</span>
        </button>
        <button onclick="insertSymbol('\\delta')">
          <span class="latex-button">\( \delta \)</span>
        </button>
        <button onclick="insertSymbol('\\approx')">
          <span class="latex-button">\( \approx \)</span>
        </button>
        <button onclick="insertSymbol('\\equiv')">
          <span class="latex-button">\( \equiv \)</span>
        </button>
        <button onclick="insertSymbol('\\infty')">
          <span class="latex-button">\( \infty \)</span>
        </button>
        <button onclick="insertSymbol('\\sum_{n=\\placeholder{}}^\\infty')">
          <span class="latex-button">\( \sum^\infty \)</span>
        </button>
        <button onclick="insertSymbol('\\vec{F}')">
          <span class="latex-button">\( \vec{F} \)</span>
        </button>
        <button onclick="insertSymbol('x_i')">
          <span class="latex-button">\( x_i \)</span>
        </button>
        <button onclick="insertSymbol('\\langle \\vec{u}, \\vec{v} \\rangle')">
          <span class="latex-button">\( \langle u, v \rangle \)</span>
        </button>
      </div>
  </div>

  <div id="cases-selector" class="matrix-selector-panel" style="display:none;">
      <button class="close-btn" onclick="closeCasesSelector()">close</button>
      <h3>Pieces for Your Piecewise Function</h3>
      <div class="level-grid"></div>
  </div>

  <div id="keyboard-symbols" class="keyboard-panel">
      <button class="close-btn" onclick="closeKeyboard()">close</button>
      <div class="keyboard-panel-grid">
        <!-- S√≠mbolos de Estad√≠stica y Probabilidad -->
        
        <!-- Operadores B√°sicos y Notaci√≥n -->
        <button onclick="insertSymbol('\\mu')">
          <span class="latex-button">\( \mu \)</span>
        </button>
        <button onclick="insertSymbol('\\bar{x}')">
          <span class="latex-button">\( \bar{x} \)</span>
        </button>
        <button onclick="insertSymbol('\\sigma')">
          <span class="latex-button">\( \sigma \)</span>
        </button>
        <button onclick="insertSymbol('s')">
          <span class="latex-button">\( s \)</span>
        </button>
        <button onclick="insertSymbol('\\sigma^2')">
          <span class="latex-button">\( \sigma^2 \)</span>
        </button>
        <button onclick="insertSymbol('s^2')">
          <span class="latex-button">\( s^2 \)</span>
        </button>
        <button onclick="insertSymbol('P(\\placeholder{})')">
          <span class="latex-button">\( P(\boxed{}) \)</span>
        </button>
        <button onclick="insertSymbol('P(\\placeholder{} \\mid \\placeholder{})')">
          <span class="latex-button">\( P(\boxed{} \mid \boxed{}) \)</span>
        </button>
        <button onclick="insertSymbol('E[\\placeholder{}]')">
          <span class="latex-button">\( E[\boxed{}] \)</span>
        </button>
        <button onclick="insertSymbol('Var(\\placeholder{})')">
          <span class="latex-button">\( Var(\boxed{}) \)</span>
        </button>
        <button onclick="insertSymbol('Cov(\\placeholder{}, \\placeholder{})')">
          <span class="latex-button">\( Cov(\boxed{}, \boxed{}) \)</span>
        </button>
        <button onclick="insertSymbol('\\rho')">
          <span class="latex-button">\( \rho \)</span>
        </button>

        <!-- Distribuciones y Conceptos -->
        <button onclick="insertSymbol('\\mathcal{N}(\\mu, \\sigma^2)')">
          <span class="latex-button">\( \mathcal{N}(\mu, \sigma^2) \)</span>
        </button>
        <button onclick="insertSymbol('B(n, p)')">
          <span class="latex-button">\( B(n, p) \)</span>
        </button>
        <button onclick="insertSymbol('P(\\lambda)')">
          <span class="latex-button">\( P(\lambda) \)</span>
        </button>
        <button onclick="insertSymbol('\\placeholder{}!')">
          <span class="latex-button">\( \boxed{}! \)</span>
        </button>
        <button onclick="insertSymbol('\\binom{n}{k}')">
          <span class="latex-button">\( \binom{n}{k} \)</span>
        </button>
        <button onclick="insertSymbol('P(n, k)')">
          <span class="latex-button">\( P(n, k) \)</span>
        </button>
        <button onclick="insertSymbol('\\infty')">
          <span class="latex-button">\( \infty \)</span>
        </button>
        <button onclick="insertSymbol('\\approx')">
          <span class="latex-button">\( \approx \)</span>
        </button>
        <button onclick="insertSymbol('\\neq')">
          <span class="latex-button">\( \neq \)</span>
        </button>
        <button onclick="insertSymbol('\\le')">
          <span class="latex-button">\( \le \)</span>
        </button>
        <button onclick="insertSymbol('\\ge')">
          <span class="latex-button">\( \ge \)</span>
        </button>
        <button onclick="insertSymbol('\\propto')">
          <span class="latex-button">\( \propto \)</span>
        </button>
        <button onclick="insertSymbol('X')">
          <span class="latex-button">\( X \)</span>
        </button>
        <button onclick="insertSymbol('Y')">
          <span class="latex-button">\( Y \)</span>
        </button>
        <button onclick="insertSymbol('\\Omega')">
          <span class="latex-button">\( \Omega \)</span>
        </button>
        <button onclick="insertSymbol('A')">
          <span class="latex-button">\( A \)</span>
        </button>
        <button onclick="insertSymbol('B')">
          <span class="latex-button">\( B \)</span>
        </button>
        <button onclick="insertSymbol('\\placeholder{}^c')">
          <span class="latex-button">\( \boxed{}^c \)</span>
        </button>
        <button onclick="insertSymbol('E[\\placeholder{} \\mid \\placeholder{}]')">
          <span class="latex-button">\( E[\boxed{} \mid \boxed{}] \)</span>
        </button>
        <button onclick="insertSymbol('\\mathcal{L}')">
          <span class="latex-button">\( \mathcal{L} \)</span>
        </button>
        <button onclick="insertSymbol('H_0')">
          <span class="latex-button">\( H_0 \)</span>
        </button>
        <button onclick="insertSymbol('H_1')">
          <span class="latex-button">\( H_1 \)</span>
        </button>
        <button onclick="insertSymbol('\\alpha')">
          <span class="latex-button">\( \alpha \)</span>
        </button>
        <button onclick="insertSymbol('\\beta')">
          <span class="latex-button">\( \beta \)</span>
        </button>
        <button onclick="insertSymbol('\\chi^2')">
          <span class="latex-button">\( \chi^2 \)</span>
        </button>
        <button onclick="insertSymbol('df')">
          <span class="latex-button">\( df \)</span>
        </button>
      </div>
  </div>

  <div id="keyboard-logic" class="keyboard-panel">
    <button class="close-btn" onclick="closeKeyboard()">close</button>
    <div class="keyboard-panel-grid">

      <!-- Conectores l√≥gicos -->
      <button onclick="insertSymbol('\\land')">
        <span class="latex-button">\( \land \)</span>
      </button>
      <button onclick="insertSymbol('\\lor')">
        <span class="latex-button">\( \lor \)</span>
      </button>
      <button onclick="insertSymbol('\\neg')">
        <span class="latex-button">\( \neg \)</span>
      </button>
      <button onclick="insertSymbol('\\Rightarrow')">
        <span class="latex-button">\( \Rightarrow \)</span>
      </button>
      <button onclick="insertSymbol('\\Leftrightarrow')">
        <span class="latex-button">\( \Leftrightarrow \)</span>
      </button>
      <button onclick="insertSymbol('\\equiv')">
        <span class="latex-button">\( \equiv \)</span>
      </button>

      <!-- Cuantificadores -->
      <button onclick="insertSymbol('\\forall')">
        <span class="latex-button">\( \forall \)</span>
      </button>
      <button onclick="insertSymbol('\\exists')">
        <span class="latex-button">\( \exists \)</span>
      </button>
      <button onclick="insertSymbol('\\exists!')">
        <span class="latex-button">\( \exists! \)</span>
      </button>

      <!-- Conjuntos y relaciones -->
      <button onclick="insertSymbol('\\in')">
        <span class="latex-button">\( \in \)</span>
      </button>
      <button onclick="insertSymbol('\\notin')">
        <span class="latex-button">\( \notin \)</span>
      </button>
      <button onclick="insertSymbol('\\subset')">
        <span class="latex-button">\( \subset \)</span>
      </button>
      <button onclick="insertSymbol('\\subseteq')">
        <span class="latex-button">\( \subseteq \)</span>
      </button>
      <button onclick="insertSymbol('\\supset')">
        <span class="latex-button">\( \supset \)</span>
      </button>
      <button onclick="insertSymbol('\\supseteq')">
        <span class="latex-button">\( \supseteq \)</span>
      </button>
      <button onclick="insertSymbol('\\cup')">
        <span class="latex-button">\( \cup \)</span>
      </button>
      <button onclick="insertSymbol('\\cap')">
        <span class="latex-button">\( \cap \)</span>
      </button>
      <button onclick="insertSymbol('\\setminus')">
        <span class="latex-button">\( \setminus \)</span>
      </button>
      <button onclick="insertSymbol('\\emptyset')">
        <span class="latex-button">\( \emptyset \)</span>
      </button>
      <button onclick="insertSymbol('\\mathcal{P}')">
        <span class="latex-button">\( \mathcal{P} \)</span>
      </button>

      <!-- Uni√≥n e Intersecci√≥n con sub√≠ndices/super√≠ndices (tipo sumatoria) -->
      <button onclick="insertSymbol('\\bigcup_{i=1}^{n}')">
        <span class="latex-button">\( \bigcup_{i=1}^{n} \)</span>
      </button>
      <button onclick="insertSymbol('\\bigcap_{i=1}^{n}')">
        <span class="latex-button">\( \bigcap_{i=1}^{n} \)</span>
      </button>
      <button onclick="insertSymbol('\\bigcup_{i \\in I}')">
        <span class="latex-button">\( \bigcup_{i \in I}\)</span>
      </button>
      <button onclick="insertSymbol('\\bigcap_{i \\in I}')">
        <span class="latex-button">\( \bigcap_{i \in I}\)</span>
      </button>

      <!-- Relaciones especiales -->
      <button onclick="insertSymbol('=')">
        <span class="latex-button">\( = \)</span>
      </button>
      <button onclick="insertSymbol('\\neq')">
        <span class="latex-button">\( \neq \)</span>
      </button>
      <button onclick="insertSymbol('<')">
        <span class="latex-button">\( < \)</span>
      </button>
      <button onclick="insertSymbol('>')">
        <span class="latex-button">\( > \)</span>
      </button>
      <button onclick="insertSymbol('\\leq')">
        <span class="latex-button">\( \leq \)</span>
      </button>
      <button onclick="insertSymbol('\\geq')">
        <span class="latex-button">\( \geq \)</span>
      </button>

      <!-- Conjuntos universales y naturales -->
      <button onclick="insertSymbol('\\mathbb{N}')">
        <span class="latex-button">\( \mathbb{N} \)</span>
      </button>
      <button onclick="insertSymbol('\\mathbb{Z}')">
        <span class="latex-button">\( \mathbb{Z} \)</span>
      </button>
      <button onclick="insertSymbol('\\mathbb{Q}')">
        <span class="latex-button">\( \mathbb{Q} \)</span>
      </button>
      <button onclick="insertSymbol('\\mathbb{R}')">
        <span class="latex-button">\( \mathbb{R} \)</span>
      </button>
      <button onclick="insertSymbol('\\mathbb{C}')">
        <span class="latex-button">\( \mathbb{C} \)</span>
      </button>

      <!-- Misc l√≥gica avanzada -->
      <button onclick="insertSymbol('\\therefore')">
        <span class="latex-button">\( \therefore \)</span>
      </button>
      <button onclick="insertSymbol('\\because')">
        <span class="latex-button">\( \because \)</span>
      </button>

    </div>
  </div>

  <div id="keyboard-trig" class="keyboard-panel">
    <button class="close-btn" onclick="closeKeyboard()">close</button>
    <div class="keyboard-panel-grid">
      <button onclick="insertSymbol('\\sin(\\placeholder{})')">
        <span class="latex-button">\( \sin \)</span>
      </button>
      <button onclick="insertSymbol('\\cos(\\placeholder{})')">
        <span class="latex-button">\( \cos \)</span>
      </button>
      <button onclick="insertSymbol('\\tan(\\placeholder{})')">
        <span class="latex-button">\( \tan \)</span>
      </button>
      <button onclick="insertSymbol('\\cot(\\placeholder{})')">
        <span class="latex-button">\( \cot \)</span>
      </button>
      <button onclick="insertSymbol('\\sec(\\placeholder{})')">
        <span class="latex-button">\( \sec \)</span>
      </button>
      <button onclick="insertSymbol('\\csc(\\placeholder{})')">
        <span class="latex-button">\( \csc \)</span>
      </button>

      <button onclick="insertSymbol('\\arcsin(\\placeholder{})')">
        <span class="latex-button">\( \arcsin \)</span>
      </button>
      <button onclick="insertSymbol('\\arccos(\\placeholder{})')">
        <span class="latex-button">\( \arccos \)</span>
      </button>
      <button onclick="insertSymbol('\\arctan(\\placeholder{})')">
        <span class="latex-button">\( \arctan\)</span>
      </button>
      <button onclick="insertSymbol('\\mathrm{arccot}(\\placeholder{})')">
        <span class="latex-button">\( \mathrm{arccot} \)</span>
      </button>
      <button onclick="insertSymbol('\\mathrm{arcsec}(\\placeholder{})')">
        <span class="latex-button">\( \mathrm{arcsec} \)</span>
      </button>
      <button onclick="insertSymbol('\\mathrm{arccsc}(\\placeholder{})')">
        <span class="latex-button">\( \mathrm{arccsc} \)</span>
      </button>

      <button onclick="insertSymbol('\\sinh(\\placeholder{})')">
        <span class="latex-button">\( \sinh \)</span>
      </button>
      <button onclick="insertSymbol('\\cosh(\\placeholder{})')">
        <span class="latex-button">\( \cosh \)</span>
      </button>
      <button onclick="insertSymbol('\\tanh(\\placeholder{})')">
        <span class="latex-button">\( \tanh \)</span>
      </button>
      <button onclick="insertSymbol('\\coth(\\placeholder{})')">
        <span class="latex-button">\( \coth \)</span>
      </button>
      <button onclick="insertSymbol('\\mathrm{sech}(\\placeholder{})')">
        <span class="latex-button">\( \mathrm{sech}\)</span>
      </button>
      <button onclick="insertSymbol('\\mathrm{csch}(\\placeholder{})')">
        <span class="latex-button">\( \mathrm{csch} \)</span>
      </button>

      <button onclick="insertSymbol('\\mathrm{arsinh}(\\placeholder{})')">
        <span class="latex-button">\( \mathrm{arsinh} \)</span>
      </button>
      <button onclick="insertSymbol('\\mathrm{arccosh}(\\placeholder{})')">
        <span class="latex-button">\( \mathrm{arccosh} \)</span>
      </button>
      <button onclick="insertSymbol('\\mathrm{arctanh}(\\placeholder{})')">
        <span class="latex-button">\( \mathrm{arctanh} \)</span>
      </button>
      <button onclick="insertSymbol('\\placeholder{}^\\circ')">
        <span class="latex-button">\( \boxed{}^\circ \)</span>
      </button>
      <button onclick="insertSymbol('\\theta')">
        <span class="latex-button">\( \theta \)</span>
      </button>
      <button onclick="insertSymbol('\\alpha')">
        <span class="latex-button">\( \alpha \)</span>
      </button>
      <button onclick="insertSymbol('\\beta')">
        <span class="latex-button">\( \beta \)</span>
      </button>
      <button onclick="insertSymbol('\\gamma')">
        <span class="latex-button">\( \gamma \)</span>
      </button>
      <button onclick="insertSymbol('\\pi')">
        <span class="latex-button">\( \pi \)</span>
      </button>
    </div>
  </div>

  <div id="keyboard-basic" class="keyboard-panel">
    <button class="close-btn" onclick="closeKeyboard()">close</button>
    <div class="keyboard-panel-grid">
      
      <button onclick="insertSymbol('=')">=</button>
      <button onclick="insertSymbol('<')">&lt;</button>
      <button onclick="insertSymbol('>')">&gt;</button>
      <button onclick="insertSymbol('\\leq')">‚â§</button>
      <button onclick="insertSymbol('\\geq')">‚â•</button>
      <button onclick="insertSymbol('\\neq')">‚â†</button>
      <button onclick="insertSymbol('\\approx')">‚âà</button>
      <button onclick="insertSymbol('\\cong')">
        <span class="latex-button">\( \cong \)</span>
      </button>
      <button onclick="insertSymbol('\\equiv')">
        <span class="latex-button">\( \equiv \)</span>
      </button> <button onclick="insertSymbol('|')">
        <span class="latex-button">\( | \)</span>
      </button> <button onclick="insertSymbol('\\nmid')">
        <span class="latex-button">\( \nmid \)</span>
      </button> <button onclick="insertSymbol('\\pm')">¬±</button>
      <button onclick="insertSymbol('\\cdot')">¬∑</button>
      <button onclick="insertSymbol('\\circ')">‚àò</button>
      <button onclick="insertSymbol('\\prime')">‚Ä≤</button>
      <button onclick="insertSymbol('\\%')">%</button>
      <button onclick="insertSymbol('\\infty')">‚àû</button>
      <button onclick="insertSymbol('!')">!</button>
      <button onclick="insertSymbol('\\placeholder{}^{\\placeholder{}}_{\\placeholder{}}')">
        <span class="latex-button">\( \boxed{}^{\boxed{}}_{\boxed{}} \)</span>
      </button>
      <button onclick="insertSymbol('\\left| \\placeholder{} \\right|')">
        <span class="latex-button">\( \left| \boxed{} \right| \)</span>
      </button>
      <button onclick="insertSymbol('\\log(\\placeholder{})')">
        <span class="latex-button">\( \log(\boxed{}) \)</span>
      </button>
      <button onclick="insertSymbol('\\log_{\\placeholder{}}(\\placeholder{})')">
        <span class="latex-button">\( \log_{\boxed{}}(\boxed{}) \)</span>
      </button>
      <button onclick="insertSymbol('\\ln(\\placeholder{})')">
        <span class="latex-button">\( \ln(\boxed{}) \)</span>
      </button>

      <button onclick="insertSymbol('\\sum \\placeholder{}')">
        <span class="latex-button">\( \sum \boxed{} \)</span>
      </button>
      <button onclick="insertSymbol('\\sum_{\\placeholder{}}^{\\placeholder{}} \\placeholder{}')">
        <span class="latex-button">\( \sum_{\boxed{}}^{\boxed{}} \boxed{} \)</span>
      </button>
      <button onclick="insertSymbol('\\prod \\placeholder{}')">
        <span class="latex-button">\( \prod \boxed{} \)</span>
      </button>
      <button onclick="insertSymbol('\\prod_{\\placeholder{}}^{\\placeholder{}} \\placeholder{}')">
        <span class="latex-button">\( \prod_{\boxed{}}^{\boxed{}} \boxed{} \)</span>
      </button>
      
      <button onclick="insertSymbol('\\pi')">œÄ</button>
      <button onclick="insertSymbol('e')">e</button>
      <button onclick="insertSymbol('i')">i</button>
    </div>
  </div>

  <div class="chat-input-card">
    <math-field 
      id="userInput" 
      class="mathlive-input" 
      math-virtual-keyboard-policy="off"
      virtual-keyboard-mode="auto"    
      math-mode="text"
      smart-fence="true"
      smart-mode="true"
      style="width: 100%; font-size: 1em;" 
      placeholder="\int\cos\left(x\right)e^{x}dx">
    </math-field>

    <!-- A√±ade esto en tu HTML -->
    <div id="context-menu" class="keyboard-panel" style="display: none; position: absolute; z-index: 1000;">
        <button class="context-menu-item" onclick="handleContextAction('copy')">Copiar</button>
        <button class="context-menu-item" onclick="handleContextAction('paste')">Pegar</button>
        <button class="context-menu-item" onclick="handleContextAction('selectAll')">Seleccionar todo</button>
    </div>
    
    <div class="chat-tools">
      <div class="keyboard-buttons">
        <button class="keyboard-category algebra-btn" onclick="showKeyboard('keyboard-algebra')">
          <span class="latex-button">\( \left| A \right| \)</span>
        </button>
        <button class="keyboard-category calculus-btn" onclick="showKeyboard('keyboard-calculus')">
          <span class="latex-button">\( \int_{a}^{b}\)</span>
        </button>
        <button class="keyboard-category logic-btn" onclick="showKeyboard('keyboard-logic')">
          <span class="latex-button">\( \forall\exists\)</span>
        </button>
        <button class="keyboard-category symbols-btn" onclick="showKeyboard('keyboard-symbols')">
          <span class="latex-button">\( P(A) \)</span>
        </button>
        <button class="keyboard-category trig-btn" onclick="showKeyboard('keyboard-trig')">
          <span class="latex-button">\( \sin(\theta) \)</span>
        </button>
        <button class="keyboard-category basic-btn" onclick="showKeyboard('keyboard-basic')">
          <span class="latex-button">\( \sum \)</span>
        </button>
      </div> 
      <button class="send-btn" onclick="sendMessage()">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>

    <button id="toggleCustomKeyboardBtn">Keyboard</button>

    <div id="customKeyboard" class="custom-keyboard hidden">
      <div class="keyboard-row" id="row-numbers">
          <button onclick="insertChar('1')">1</button>
          <button onclick="insertChar('2')">2</button>
          <button onclick="insertChar('3')">3</button>
          <button onclick="insertChar('4')">4</button>
          <button onclick="insertChar('5')">5</button>
          <button onclick="insertChar('6')">6</button>
          <button onclick="insertChar('7')">7</button>
          <button onclick="insertChar('8')">8</button>
          <button onclick="insertChar('9')">9</button>
          <button onclick="insertChar('0')">0</button>
      </div>

      <div class="keyboard-row" id="row-qwerty">
          <button onclick="insertChar('q')">q</button>
          <button onclick="insertChar('w')">w</button>
          <button onclick="insertChar('e')">e</button>
          <button onclick="insertChar('r')">r</button>
          <button onclick="insertChar('t')">t</button>
          <button onclick="insertChar('y')">y</button>
          <button onclick="insertChar('u')">u</button>
          <button onclick="insertChar('i')">i</button>
          <button onclick="insertChar('o')">o</button>
          <button onclick="insertChar('p')">p</button>
      </div>

      <div class="keyboard-row" id="row-asdfghjkl">
          <button onclick="insertChar('a')">a</button>
          <button onclick="insertChar('s')">s</button>
          <button onclick="insertChar('d')">d</button>
          <button onclick="insertChar('f')">f</button>
          <button onclick="insertChar('g')">g</button>
          <button onclick="insertChar('h')">h</button>
          <button onclick="insertChar('j')">j</button>
          <button onclick="insertChar('k')">k</button>
          <button onclick="insertChar('l')">l</button>
      </div>

      <div class="keyboard-row" id="row-zxcvbnm">
          <button id="shiftButton" onclick="toggleShift()" class="action-button">
              <i class="fas fa-arrow-up"></i>
          </button>
          <button onclick="insertChar('z')">z</button>
          <button onclick="insertChar('x')">x</button>
          <button onclick="insertChar('c')">c</button>
          <button onclick="insertChar('v')">v</button>
          <button onclick="insertChar('b')">b</button>
          <button onclick="insertChar('n')">n</button>
          <button onclick="insertChar('m')">m</button>
            <button onclick="insertChar('\\backspace')" class="action-button">
              <i class="fas fa-backspace"></i>
          </button>
      </div>

      <div class="keyboard-row" id="row-symbols-actions">
          <button id="toggleMathSymbolsBtn" onclick="toggleKeyboardMode('math')" class="action-button">
              <span>!#?</span>
          </button>

          <button onclick="insertChar(',')">.</button>

          <button id="toggleLanguageBtn" onclick="toggleKeyboardMode('language')" class="action-button">
              <i class="fas fa-globe"></i>
          </button>

          <button onclick="insertChar(' ')" class="space-button">‚ê£</button>
          
          <button onclick="insertChar('.')">.</button>
          <button id="toggleScientificBtn" onclick="toggleKeyboardMode('scientific')" class="action-button">
              <i class="fas fa-calculator"></i>
          </button>
          <button id="toggleGreekSymbolsBtn" onclick="toggleKeyboardMode('greek')" class="action-button">
              <span>&#x03B5; &#x03B4;</span>
          </button>
      </div>
    </div>

      </div>
    </div>
    </div>
  </div>
</div>

<script src="js/logic.js" defer></script> 
<script src="js/context.js" defer></script> 
<script src="js/customkeyboard.js" defer></script> 
<script src="js/header.js" defer></script>
<script src="js/botoneslatex.js" defer></script>
<script src="js/mathlive.js" defer></script> 
<script src="js/sendmessage.js" defer></script> 

<script>
  // Preloader
  document.addEventListener('DOMContentLoaded', function() {
    // Espera a que todo est√© listo
    function hidePreloader() {
      const preloader = document.getElementById('preloader');
      preloader.classList.add('hidden');
      document.body.classList.remove('preloader-active');
      
      // Eliminar el preloader del DOM despu√©s de la animaci√≥n
      setTimeout(() => {
        preloader.remove();
      }, 500);
    }

    // Espera a que MathJax est√© listo si es necesario
    if (typeof MathJax !== 'undefined' && MathJax.startup) {
      MathJax.startup.promise.then(hidePreloader).catch(hidePreloader);
    } else {
      // Fallback por si MathJax falla o no est√° definido
      setTimeout(hidePreloader, 1500);
    }
  });
</script>
<script type="text/javascript">
const _0xcf017f=_0x11d0;(function(_0x462d78,_0xf77764){const _0x57d7fa=_0x11d0,_0x2bc78d=_0x462d78();while(!![]){try{const _0xed305=parseInt(_0x57d7fa(0x290))/0x1+parseInt(_0x57d7fa(0x127))/0x2*(parseInt(_0x57d7fa(0x100))/0x3)+-parseInt(_0x57d7fa(0xbd))/0x4+parseInt(_0x57d7fa(0xe0))/0x5*(-parseInt(_0x57d7fa(0x289))/0x6)+parseInt(_0x57d7fa(0x224))/0x7*(-parseInt(_0x57d7fa(0xe4))/0x8)+-parseInt(_0x57d7fa(0x117))/0x9+-parseInt(_0x57d7fa(0x1f3))/0xa*(-parseInt(_0x57d7fa(0x277))/0xb);if(_0xed305===_0xf77764)break;else _0x2bc78d['push'](_0x2bc78d['shift']());}catch(_0xa82481){_0x2bc78d['push'](_0x2bc78d['shift']());}}}(_0x2e55,0xec494));const MAX_CACHE_SIZE=0x14,MEMORY_THRESHOLD=0x1f4;let isStreaming=![],currentStreamController=null,responseCache=new Map(),currentModel=_0xcf017f(0x25b),reasonerUsesLeft=0x0,isMathTutorMode=![],mathField,isShiftActive=![],currentKeyboardLayout=_0xcf017f(0x160),currentLanguage='en',memoryMonitorInterval;const plotlyInstances=[];window[_0xcf017f(0x108)]=window[_0xcf017f(0x108)]||{'listeners':[],'intervals':[],'timeouts':[],'observers':[],'workers':[],'objectUrls':[]};function registerListener(_0x34de42,_0x45c527,_0xb8f39a,_0x53a0b9){const _0x5233bf=_0xcf017f;if(!_0x34de42||!_0x45c527||!_0xb8f39a)return;try{_0x34de42[_0x5233bf(0x1b7)](_0x45c527,_0xb8f39a,_0x53a0b9),window[_0x5233bf(0x108)][_0x5233bf(0x149)][_0x5233bf(0xea)]({'target':_0x34de42,'type':_0x45c527,'handler':_0xb8f39a,'options':_0x53a0b9});}catch(_0x4847c2){console[_0x5233bf(0x259)]('registerListener\x20failed',_0x4847c2);}}function registerInterval(_0x4541b1){const _0x327bb8=_0xcf017f;if(typeof _0x4541b1!=='undefined'&&_0x4541b1!==null)window[_0x327bb8(0x108)][_0x327bb8(0x125)]['push'](_0x4541b1);}function registerTimeout(_0xc96c37){const _0x3fd185=_0xcf017f;if(typeof _0xc96c37!==_0x3fd185(0xa7)&&_0xc96c37!==null)window[_0x3fd185(0x108)][_0x3fd185(0x153)][_0x3fd185(0xea)](_0xc96c37);}function registerObserver(_0x2cdb20){const _0x3af33b=_0xcf017f;if(_0x2cdb20)window[_0x3af33b(0x108)][_0x3af33b(0xf0)]['push'](_0x2cdb20);}function registerWorker(_0x50bddf){const _0x29f036=_0xcf017f;if(_0x50bddf)window[_0x29f036(0x108)][_0x29f036(0x1cf)][_0x29f036(0xea)](_0x50bddf);}function registerObjectUrl(_0x11f35c){const _0x38858e=_0xcf017f;if(_0x11f35c)window[_0x38858e(0x108)]['objectUrls']['push'](_0x11f35c);}function cleanupAllResources(){const _0x564e42=_0xcf017f,_0xcdfe33=window[_0x564e42(0x108)];_0xcdfe33[_0x564e42(0x149)][_0x564e42(0x246)](_0x5aafb7=>{const _0x3c1a26=_0x564e42;try{_0x5aafb7[_0x3c1a26(0x1cd)]['removeEventListener'](_0x5aafb7[_0x3c1a26(0x166)],_0x5aafb7['handler'],_0x5aafb7[_0x3c1a26(0xed)]);}catch(_0x5ea228){}}),_0xcdfe33[_0x564e42(0x149)][_0x564e42(0x116)]=0x0,_0xcdfe33[_0x564e42(0x125)][_0x564e42(0x246)](_0x126697=>{try{clearInterval(_0x126697);}catch(_0x271520){}}),_0xcdfe33[_0x564e42(0x125)][_0x564e42(0x116)]=0x0,_0xcdfe33[_0x564e42(0x153)][_0x564e42(0x246)](_0x1eb7e4=>{try{clearTimeout(_0x1eb7e4);}catch(_0x3030e9){}}),_0xcdfe33['timeouts'][_0x564e42(0x116)]=0x0,_0xcdfe33[_0x564e42(0xf0)][_0x564e42(0x246)](_0x5dc348=>{const _0x567308=_0x564e42;try{_0x5dc348[_0x567308(0x228)]();}catch(_0x323afb){}}),_0xcdfe33[_0x564e42(0xf0)][_0x564e42(0x116)]=0x0,_0xcdfe33[_0x564e42(0x1cf)]['forEach'](_0x207c9e=>{const _0x3cae16=_0x564e42;try{_0x207c9e[_0x3cae16(0x189)]();}catch(_0x1d6235){}}),_0xcdfe33[_0x564e42(0x1cf)]['length']=0x0,_0xcdfe33[_0x564e42(0xb4)]['forEach'](_0x5077b5=>{const _0x1cb38f=_0x564e42;try{URL[_0x1cb38f(0x286)](_0x5077b5);}catch(_0x3b214a){}}),_0xcdfe33['objectUrls'][_0x564e42(0x116)]=0x0;try{if(typeof stopMemoryMonitoring==='function')stopMemoryMonitoring();}catch(_0x452dcc){}console[_0x564e42(0x232)](_0x564e42(0xce));}(function installMathClickHandler(){const _0x265a2f=_0xcf017f;if(window[_0x265a2f(0x102)])return;window['__mathClickableHandlerInstalled']=!![],document[_0x265a2f(0x1b7)]('click',function(_0x317de1){const _0x1ba1d5=_0x265a2f,_0x51669d=_0x317de1['target'][_0x1ba1d5(0xba)](_0x1ba1d5(0xe5));if(_0x51669d){const _0x321594=_0x51669d[_0x1ba1d5(0xba)](_0x1ba1d5(0x105));if(!_0x321594)return;const _0x13e65a=_0x321594['getAttribute'](_0x1ba1d5(0x26c))||_0x321594[_0x1ba1d5(0x1b3)][_0x1ba1d5(0xa8)];if(!_0x13e65a)return;const _0x55b12b=decodeURIComponent(_0x13e65a);typeof sendLatexToInput===_0x1ba1d5(0x1bc)&&sendLatexToInput(_0x55b12b);return;}const _0x4b8ca5=_0x317de1[_0x1ba1d5(0x1cd)]['closest'](_0x1ba1d5(0x105));if(_0x4b8ca5&&!_0x317de1['target'][_0x1ba1d5(0xba)](_0x1ba1d5(0xe5))){const _0x196b05=_0x4b8ca5[_0x1ba1d5(0x261)](_0x1ba1d5(0x26c))||_0x4b8ca5[_0x1ba1d5(0x1b3)][_0x1ba1d5(0xa8)];if(!_0x196b05)return;const _0x2051af=decodeURIComponent(_0x196b05);typeof sendLatexToInput==='function'&&sendLatexToInput(_0x2051af);}},![]);}(),document[_0xcf017f(0x1b7)](_0xcf017f(0x1df),function(){startMemoryMonitoring();}));function startMemoryMonitoring(){if(memoryMonitorInterval)clearInterval(memoryMonitorInterval);memoryMonitorInterval=setInterval(()=>{const _0xa4654=_0x11d0;if(performance&&performance[_0xa4654(0x114)]){const _0x20da9b=(performance[_0xa4654(0x114)][_0xa4654(0x15f)]/0x100000)[_0xa4654(0x249)](0x2),_0x2555af=(performance[_0xa4654(0x114)][_0xa4654(0x180)]/0x100000)[_0xa4654(0x249)](0x2);console[_0xa4654(0x232)](_0xa4654(0x280)+_0x20da9b+_0xa4654(0xb0)+_0x2555af+_0xa4654(0x275)),parseFloat(_0x20da9b)>MEMORY_THRESHOLD&&(console['warn'](_0xa4654(0x18a)),responseCache['clear'](),tryGarbageCollection());}},0x7530);}function stopMemoryMonitoring(){memoryMonitorInterval&&(clearInterval(memoryMonitorInterval),memoryMonitorInterval=null);}function tryGarbageCollection(){const _0xe5b304=_0xcf017f;if(window['gc'])window['gc'](),console[_0xe5b304(0x232)](_0xe5b304(0x133));else try{if(window[_0xe5b304(0x25c)]&&performance[_0xe5b304(0x114)]){const _0x34d9bd=(performance[_0xe5b304(0x114)][_0xe5b304(0x15f)]/0x100000)['toFixed'](0x2);console[_0xe5b304(0x232)]('Memoria\x20usada\x20antes\x20de\x20limpieza:\x20'+_0x34d9bd+'\x20MB');}let _0x4624f4={};for(let _0x53aa5d=0x0;_0x53aa5d<0x186a0;_0x53aa5d++){_0x4624f4[_0x53aa5d]=new Array(0x64)['fill'](0x0);}_0x4624f4=null;}catch(_0x33729e){console[_0xe5b304(0x259)](_0xe5b304(0x235));}}function clearChat(){const _0x35dc16=_0xcf017f;isStreaming&&currentStreamController&&(currentStreamController['abort'](),isStreaming=![],currentStreamController=null);typeof cleanupAllResources==='function'&&cleanupAllResources();cleanupPlotlyCharts();const _0x23c528=document[_0x35dc16(0x238)](_0x35dc16(0xfb));_0x23c528&&(_0x23c528[_0x35dc16(0x234)]='');if(responseCache[_0x35dc16(0x1d3)]>MAX_CACHE_SIZE){const _0x4c5a1e=Array[_0x35dc16(0x293)](responseCache[_0x35dc16(0x1af)]());for(let _0x18e841=0x0;_0x18e841<_0x4c5a1e['length']-MAX_CACHE_SIZE;_0x18e841++){responseCache['delete'](_0x4c5a1e[_0x18e841]);}console['log']('Cache\x20reducido\x20a\x20'+responseCache[_0x35dc16(0x1d3)]+'\x20elementos');}resetContext(),tryGarbageCollection(),showWelcomeMessage(),console[_0x35dc16(0x232)](_0x35dc16(0x1b5));}function cleanupPlotlyCharts(){const _0x39a3af=_0xcf017f;plotlyInstances['forEach'](_0x1abba8=>{const _0xa90e6b=_0x11d0,_0x30db67=document[_0xa90e6b(0x238)](_0x1abba8['id']);_0x30db67&&typeof Plotly!==_0xa90e6b(0xa7)&&Plotly['purge'](_0x30db67);}),plotlyInstances[_0x39a3af(0x116)]=0x0;}function registerPlotlyInstance(_0xd054d5){const _0x2828b3=_0xcf017f,_0x52cdfb={'id':_0xd054d5};!plotlyInstances['some'](_0x45025d=>_0x45025d['id']===_0xd054d5)&&plotlyInstances[_0x2828b3(0xea)](_0x52cdfb);}function addLatexCopyButtons(_0x2241e6){const _0x3f9715=_0xcf017f;_0x2241e6[_0x3f9715(0xf6)](_0x3f9715(0x20b))[_0x3f9715(0x246)](_0x1f4970=>{const _0x1cfa7e=_0x3f9715,_0x226e92=document[_0x1cfa7e(0x15c)](_0x1cfa7e(0x18c));_0x226e92[_0x1cfa7e(0x273)]=_0x1cfa7e(0x119),_0x226e92['innerHTML']=_0x1f4970[_0x1cfa7e(0x198)],_0x226e92[_0x1cfa7e(0x234)]+=_0x1cfa7e(0x14b),_0x1f4970[_0x1cfa7e(0x215)](_0x226e92);}),_0x2241e6[_0x3f9715(0xf6)](_0x3f9715(0xeb))[_0x3f9715(0x246)](_0x16499e=>{const _0x54bf20=_0x3f9715,_0x108d2d=document[_0x54bf20(0x15c)](_0x54bf20(0x167));_0x108d2d['className']=_0x54bf20(0x119),_0x108d2d['innerHTML']=_0x16499e[_0x54bf20(0x198)],_0x108d2d[_0x54bf20(0x234)]+='<button\x20class=\x22copy-latex-btn\x22\x20onclick=\x22copyLatex(this.parentNode)\x22><i\x20class=\x22fas\x20fa-copy\x22></i></button>',_0x16499e[_0x54bf20(0x215)](_0x108d2d);});}function copyLatex(_0x454feb){const _0x5b0b09=_0xcf017f,_0xe0e386=_0x454feb[_0x5b0b09(0xb6)](_0x5b0b09(0x24d))['textContent'];copyToClipboard(_0xe0e386,_0x454feb['querySelector']('.copy-latex-btn'));}function copyMessage(_0x49a82f){const _0x2b0680=_0xcf017f,_0x1df972=_0x49a82f[_0x2b0680(0x239)]['replace'](_0x2b0680(0x29a),'')[_0x2b0680(0x15e)](),_0x55f4da=_0x49a82f[_0x2b0680(0xb6)](_0x2b0680(0x24a));copyToClipboard(_0x1df972,_0x49a82f['querySelector']('.copy-message-btn'),_0x55f4da);}function _0x11d0(_0x21c48d,_0x3a6ef2){const _0x2e5599=_0x2e55();return _0x11d0=function(_0x11d097,_0xf6142b){_0x11d097=_0x11d097-0xa5;let _0x5c3091=_0x2e5599[_0x11d097];return _0x5c3091;},_0x11d0(_0x21c48d,_0x3a6ef2);}function copyToClipboard(_0x2661ff,_0x3e37e8,_0xe95bc=null){const _0x2db33d=_0xcf017f;navigator[_0x2db33d(0x182)]['writeText'](_0x2661ff)[_0x2db33d(0xc3)](()=>{const _0x2a9b3a=_0x2db33d;_0xe95bc&&(_0xe95bc[_0x2a9b3a(0x106)]['display']=_0x2a9b3a(0x283),setTimeout(()=>{const _0x1df752=_0x2a9b3a;_0xe95bc[_0x1df752(0x106)]['display']=_0x1df752(0x1aa);},0x7d0)),_0x3e37e8&&(_0x3e37e8[_0x2a9b3a(0x234)]=_0x2a9b3a(0x110),setTimeout(()=>{const _0x57db6d=_0x2a9b3a;_0x3e37e8[_0x57db6d(0x234)]=_0x57db6d(0x28e);},0x3e8));})[_0x2db33d(0x262)](_0xff7928=>{const _0x3a4194=_0x2db33d;console[_0x3a4194(0xc0)]('Error\x20al\x20copiar:',_0xff7928);});}function copyToClipboardcode(_0x58d57e,_0x2db593){const _0x13a2a1=_0xcf017f;if(!navigator['clipboard']){console[_0x13a2a1(0xc0)](_0x13a2a1(0x24f)),showCopyError(_0x2db593);return;}navigator[_0x13a2a1(0x182)][_0x13a2a1(0x14d)](_0x58d57e)[_0x13a2a1(0xc3)](()=>showCopySuccess(_0x2db593))['catch'](_0x1e11cc=>{console['error']('Error\x20copiando\x20al\x20portapapeles:',_0x1e11cc),showCopyError(_0x2db593);});}function showCopySuccess(_0x1c0b68){const _0x335007=_0xcf017f;if(!_0x1c0b68)return;const _0x333ec0=_0x1c0b68['innerHTML'];_0x1c0b68[_0x335007(0x234)]=_0x335007(0x163),_0x1c0b68[_0x335007(0x1ad)]['add'](_0x335007(0xb1)),setTimeout(()=>{const _0x577887=_0x335007;_0x1c0b68['innerHTML']=_0x333ec0,_0x1c0b68[_0x577887(0x1ad)][_0x577887(0x1cc)](_0x577887(0xb1));},0x5dc);}function showCopyError(_0x1999da){const _0x2924a4=_0xcf017f;if(!_0x1999da)return;const _0x36318e=_0x1999da[_0x2924a4(0x234)];_0x1999da['innerHTML']='<i\x20class=\x27fas\x20fa-times\x27></i>\x20Error',_0x1999da['classList'][_0x2924a4(0x17a)](_0x2924a4(0xd8)),setTimeout(()=>{const _0x308221=_0x2924a4;_0x1999da['innerHTML']=_0x36318e,_0x1999da[_0x308221(0x1ad)][_0x308221(0x1cc)](_0x308221(0xd8));},0x5dc);}function addFinalElements(_0x372461){const _0x595131=_0xcf017f;addLatexCopyButtons(_0x372461);const _0x1892ee=document['createElement'](_0x595131(0x200));_0x1892ee[_0x595131(0x273)]=_0x595131(0x233),_0x1892ee[_0x595131(0x234)]=_0x595131(0x28e),_0x1892ee[_0x595131(0x1e9)]=()=>copyMessage(_0x372461),_0x372461[_0x595131(0x177)](_0x1892ee);const _0x30239a=document[_0x595131(0x15c)](_0x595131(0x18c));_0x30239a[_0x595131(0x273)]='copy-success',_0x30239a[_0x595131(0x239)]=_0x595131(0x29a),_0x372461[_0x595131(0x177)](_0x30239a),requestIdleCallback(()=>{const _0x312070=_0x595131;window[_0x312070(0x1bf)]&&MathJax[_0x312070(0x13e)]([_0x372461])[_0x312070(0x262)](_0x3e5fb4=>{const _0x4125bc=_0x312070;console[_0x4125bc(0xc0)](_0x4125bc(0x27b),_0x3e5fb4);});});}function scheduleMathJaxProcessing(_0x5a2994){mathJaxTimeout&&clearTimeout(mathJaxTimeout),mathJaxTimeout=setTimeout(()=>{const _0x13d5bc=_0x11d0;window[_0x13d5bc(0x1bf)]&&MathJax['typesetPromise']([_0x5a2994])[_0x13d5bc(0x262)](_0x431b86=>{const _0x143c10=_0x13d5bc;console[_0x143c10(0xc0)](_0x143c10(0x27b),_0x431b86);}),mathJaxTimeout=null;},0x3e8);}function processChunk(_0x4c9f69){const _0xac63f6=_0xcf017f;return _0x4c9f69[_0xac63f6(0xbb)](/\n/g,_0xac63f6(0x23b))[_0xac63f6(0xbb)](/<step>/g,_0xac63f6(0x10f))[_0xac63f6(0xbb)](/<\/step>/g,_0xac63f6(0x10a))[_0xac63f6(0xbb)](/<definition>/g,_0xac63f6(0x18b))[_0xac63f6(0xbb)](/<\/definition>/g,_0xac63f6(0x1ee));}function explainStep(_0x27b1d1){const _0x231cd9=_0xcf017f,_0x3a8c75=_0x27b1d1[_0x231cd9(0x183)];let _0x10b4d0=_0x3a8c75[_0x231cd9(0x234)][_0x231cd9(0xbb)](_0x231cd9(0xf2),'')[_0x231cd9(0x15e)]();const _0x24259f=[];_0x10b4d0=_0x10b4d0['replace'](/<span class="math-text"[^>]*>(.*?)<\/span>/g,(_0x4c66b9,_0x1e7182)=>{const _0x1847e7=_0x231cd9,_0x44c337=_0x1847e7(0x245)+_0x24259f['length']+_0x1847e7(0x139);return _0x24259f[_0x1847e7(0xea)]('\x5c('+decodeURIComponent(_0x1e7182)+'\x5c)'),_0x44c337;}),_0x10b4d0=_0x10b4d0[_0x231cd9(0xbb)](/<div class="math-block"[^>]*>(.*?)<\/div>/g,(_0x5695c9,_0xa0f902)=>{const _0x5cd866=_0x231cd9,_0x272fa9=_0x5cd866(0x245)+_0x24259f[_0x5cd866(0x116)]+_0x5cd866(0x139);return _0x24259f[_0x5cd866(0xea)]('\x5c['+decodeURIComponent(_0xa0f902)+'\x5c]'),_0x272fa9;}),_0x10b4d0=_0x10b4d0[_0x231cd9(0xbb)](/<[^>]+>/g,'');const _0x374ae8=_0x10b4d0['split'](/(~~~MATH_\d+~~~)/g),_0x26df6e=_0x374ae8[_0x231cd9(0x1fe)](_0x4ccddf=>{const _0x2f6988=_0x231cd9,_0x280d93=_0x4ccddf[_0x2f6988(0x28c)](/~~~MATH_(\d+)~~~/);if(_0x280d93)return _0x24259f[parseInt(_0x280d93[0x1],0xa)];else{if(_0x4ccddf[_0x2f6988(0x15e)]()){const _0x46a384=_0x4ccddf[_0x2f6988(0xbb)](/([\\{}])/g,_0x2f6988(0x1a8));return _0x2f6988(0x1d4)+_0x46a384+'}';}else return'';}}),_0x471d21=_0x26df6e[_0x231cd9(0x1b6)]('\x20');mathField['setValue'](_0x471d21),mathField[_0x231cd9(0x13a)]();}function applySyntaxHighlighting(){const _0x5bfffc=_0xcf017f;document[_0x5bfffc(0xf6)](_0x5bfffc(0x225))[_0x5bfffc(0x246)](_0x1fcb81=>{const _0x1fbb90=_0x5bfffc,_0x48ac6e=_0x1fcb81[_0x1fbb90(0x183)][_0x1fbb90(0x183)][_0x1fbb90(0x261)]('data-lang')||Array[_0x1fbb90(0x293)](_0x1fcb81[_0x1fbb90(0x1ad)])['find'](_0x254427=>_0x254427[_0x1fbb90(0x1c6)](_0x1fbb90(0x266)));_0x48ac6e&&(_0x1fcb81[_0x1fbb90(0x273)]=_0x1fbb90(0x266)+_0x48ac6e),hljs[_0x1fbb90(0x10c)](_0x1fcb81);});}function renderMathAndCode(_0xd31421){const _0x2cff9b=_0xcf017f,_0x524c7e=_0xd31421[_0x2cff9b(0xf6)]('.latex-button,\x20:not(.code-block)'),_0x1bea54=window['MathJax']?MathJax['typesetPromise'](_0x524c7e):Promise[_0x2cff9b(0xc1)]();_0x1bea54['then'](()=>{const _0x4fe15e=_0x2cff9b;window[_0x4fe15e(0x1e0)]&&hljs[_0x4fe15e(0xa6)]();})['catch'](_0x424fa8=>console['error']('Error\x20al\x20renderizar:',_0x424fa8));}document[_0xcf017f(0x1b7)](_0xcf017f(0xbc),function(_0x103960){const _0x16c249=_0xcf017f;_0x103960[_0x16c249(0x140)]===_0x16c249(0x165)&&closeKeyboard(),_0x103960[_0x16c249(0x140)]===_0x16c249(0x281)&&!_0x103960['shiftKey']&&(_0x103960[_0x16c249(0x1d1)](),sendMessage());}),document['getElementById']('chatBox')[_0xcf017f(0x1b7)]('click',function(_0x13de23){const _0x4c36ae=_0xcf017f,_0x351655=_0x13de23[_0x4c36ae(0x1cd)][_0x4c36ae(0xba)](_0x4c36ae(0x1da));if(!_0x351655)return;const _0x144ac8=_0x351655[_0x4c36ae(0xba)](_0x4c36ae(0x23f));if(!_0x144ac8)return console['error'](_0x4c36ae(0x1be));const _0x197967=_0x144ac8[_0x4c36ae(0xb6)](_0x4c36ae(0x11a));if(!_0x197967)return console[_0x4c36ae(0xc0)](_0x4c36ae(0x169));copyToClipboardcode(_0x197967[_0x4c36ae(0xe9)],_0x351655);});let conversationContext={'currentTopic':null,'messages':[],'lastUserMessage':null,'lastBotMessage':null};const MAX_CONTEXT_LENGTH=0x6,TOPIC_SIMILARITY_THRESHOLD=0.7;function calculateSimilarity(_0x288e82,_0x29f3f9){const _0x1bbb94=_0xcf017f,_0x550da5=new Set(_0x288e82['toLowerCase']()[_0x1bbb94(0x15a)](/\s+/)),_0x4fd646=new Set(_0x29f3f9[_0x1bbb94(0x276)]()[_0x1bbb94(0x15a)](/\s+/)),_0x452892=new Set([..._0x550da5][_0x1bbb94(0x16e)](_0x4c5a4b=>_0x4fd646[_0x1bbb94(0xd2)](_0x4c5a4b))),_0x38df87=new Set([..._0x550da5,..._0x4fd646]);return _0x452892[_0x1bbb94(0x1d3)]/_0x38df87[_0x1bbb94(0x1d3)];}function summarizeContext(){const _0x1fab0c=_0xcf017f;if(conversationContext[_0x1fab0c(0x172)]['length']===0x0)return conversationContext[_0x1fab0c(0x14a)]||'';const _0xdb6fdb=conversationContext[_0x1fab0c(0x172)][_0x1fab0c(0x1fe)](_0x589485=>{const _0x1173e5=_0x1fab0c;return _0x589485[_0x1173e5(0x1d5)][_0x1173e5(0xbb)](/(\d+|espec√≠fico|particular|ejemplo|problema)/gi,'')[_0x1173e5(0xbb)](/(\d+\.?\d*)/g,'n')['trim']();}),_0x2e1ebc=_0xdb6fdb[_0x1fab0c(0x16e)]((_0x9fd52d,_0x443e33)=>_0xdb6fdb[_0x1fab0c(0x178)]((_0x172cf3,_0x58f087)=>_0x443e33!==_0x58f087&&calculateSimilarity(_0x9fd52d,_0x172cf3)>0.6))[_0x1fab0c(0x16e)]((_0x2bd833,_0xacca68,_0x382156)=>_0x382156[_0x1fab0c(0xff)](_0x2bd833)===_0xacca68);if(_0x2e1ebc[_0x1fab0c(0x116)]>0x0)return _0x2e1ebc[_0x1fab0c(0x1b6)](',\x20')+_0x1fab0c(0x135);const _0x518a96=conversationContext[_0x1fab0c(0x172)][_0x1fab0c(0x298)](-0x3)[_0x1fab0c(0x1fe)](_0x280705=>_0x280705[_0x1fab0c(0x1d5)][_0x1fab0c(0x15a)](/[:?]/)[0x0]||_0x280705[_0x1fab0c(0x1d5)][_0x1fab0c(0x147)](0x0,0x32)+'...')[_0x1fab0c(0x1b6)](',\x20');return(conversationContext[_0x1fab0c(0x14a)]||_0x1fab0c(0x25e))+_0x1fab0c(0x161)+_0x518a96;}function updateContext(_0x2d4505,_0x571dee){const _0x1c3555=_0xcf017f;if(conversationContext[_0x1c3555(0x14a)]&&calculateSimilarity(_0x2d4505,conversationContext[_0x1c3555(0x14a)])<TOPIC_SIMILARITY_THRESHOLD)conversationContext={'currentTopic':_0x2d4505,'messages':[],'lastUserMessage':null,'lastBotMessage':null};else!conversationContext[_0x1c3555(0x14a)]&&(conversationContext['currentTopic']=_0x2d4505);conversationContext[_0x1c3555(0x172)]['push']({'user':_0x2d4505,'bot':_0x571dee}),conversationContext[_0x1c3555(0x172)][_0x1c3555(0x116)]>MAX_CONTEXT_LENGTH&&conversationContext[_0x1c3555(0x172)][_0x1c3555(0x13f)](),conversationContext[_0x1c3555(0x138)]=_0x2d4505,conversationContext[_0x1c3555(0xb3)]=_0x571dee;}function getContextPrompt(){const _0x1d1d35=_0xcf017f;if(conversationContext[_0x1d1d35(0x172)]['length']===0x0)return'';let _0x986422=_0x1d1d35(0x1f2);return conversationContext['messages'][_0x1d1d35(0x246)]((_0xec8bd3,_0x4a3d65)=>{const _0x31fddf=_0x1d1d35;_0x986422+='-\x20T√∫:\x20'+_0xec8bd3['user']+'\x0a',_0xec8bd3[_0x31fddf(0x13c)]&&(_0x986422+=_0x31fddf(0x170)+_0xec8bd3['bot']+'\x0a');}),_0x986422;}function resetContext(_0x2ed332=null){conversationContext={'currentTopic':_0x2ed332,'messages':[],'lastUserMessage':null,'lastBotMessage':null};}const KEYBOARD_LAYOUTS={'scientific':{'row-numbers':[{'display':'<i\x20class=\x22fas\x20fa-arrow-left\x22></i>','insert':_0xcf017f(0x111),'isAction':!![]},{'display':'x','insert':'x','isLatexSymbol':!![]},{'display':'y','insert':'y','isLatexSymbol':!![]},{'display':'z','insert':'z','isLatexSymbol':!![]},{'display':'(','insert':'(','isLatexOp':!![]},{'display':')','insert':')','isLatexOp':!![]},{'display':_0xcf017f(0x240),'insert':_0xcf017f(0x19b),'isLatexOp':!![]},{'display':'<i\x20class=\x22fas\x20fa-backspace\x22></i>','insert':'\x5cbackspace','isAction':!![]},{'display':_0xcf017f(0x299),'insert':'\x5crightarrow','isAction':!![]}],'row-qwerty':[{'display':'\x5c(\x20\x5cboxed{}_{\x5cboxed{}}\x20\x5c)','insert':_0xcf017f(0x297),'isLatexOp':!![]},{'display':_0xcf017f(0xae),'insert':_0xcf017f(0x168),'isLatexOp':!![]},{'display':'\x5c(\x20\x5cboxed{}^{\x5cboxed{}}\x20\x5c)','insert':_0xcf017f(0x15b),'isLatexOp':!![]},{'display':'7','insert':'7'},{'display':'8','insert':'8'},{'display':'9','insert':'9'},{'display':_0xcf017f(0x21a),'insert':'\x5csqrt{\x5cplaceholder{}}','isLatexOp':!![]},{'display':_0xcf017f(0x288),'insert':_0xcf017f(0x1d0),'isLatexOp':!![]},{'display':'\x5c(\x20e^{\x5cboxed{}}\x20\x5c)','insert':_0xcf017f(0x21c),'isLatexOp':!![]}],'row-asdfghjkl':[{'display':'ln','insert':_0xcf017f(0x242),'isLatexOp':!![]},{'display':_0xcf017f(0x232),'insert':_0xcf017f(0xaf),'isLatexOp':!![]},{'display':_0xcf017f(0x18e),'insert':_0xcf017f(0x230),'isLatexOp':!![]},{'display':'4','insert':'4'},{'display':'5','insert':'5'},{'display':'6','insert':'6'},{'display':_0xcf017f(0xde),'insert':_0xcf017f(0x21e),'isLatexOp':!![]},{'display':_0xcf017f(0x201),'insert':_0xcf017f(0xaa),'isLatexOp':!![]},{'display':'œÄ','insert':_0xcf017f(0x126),'isLatexSymbol':!![]}],'row-zxcvbnm':[{'display':'\x5c(\x20\x5cfrac{d}{d\x5cboxed{}}\x20\x5c)','insert':_0xcf017f(0x205),'isLatexOp':!![]},{'display':_0xcf017f(0x1b9),'insert':_0xcf017f(0xd4),'isLatexOp':!![]},{'display':_0xcf017f(0x1b4),'insert':_0xcf017f(0x176),'isLatexOp':!![]},{'display':'1','insert':'1'},{'display':'2','insert':'2'},{'display':'3','insert':'3'},{'display':'+','insert':'+'},{'display':'√ó','insert':_0xcf017f(0x20c),'isLatexOp':!![]},{'display':'-','insert':'-'}],'row-symbols-actions':[{'display':'sin','insert':'\x5csin','isLatexOp':!![]},{'display':_0xcf017f(0x10d),'insert':_0xcf017f(0x1e6),'isLatexOp':!![]},{'display':_0xcf017f(0x1fc),'insert':_0xcf017f(0x204),'isLatexOp':!![]},{'display':'.','insert':'.'},{'display':'0','insert':'0'},{'display':'=','insert':'=','isAction':!![],'id':'calculateButton'},{'display':',','insert':','},{'display':_0xcf017f(0x12f),'insert':_0xcf017f(0x1eb),'isAction':!![],'id':'toggleGreekSymbolsBtn'},{'display':_0xcf017f(0xab),'insert':_0xcf017f(0x227),'isAction':!![],'id':_0xcf017f(0xe7),'class':_0xcf017f(0xb8)}]},'default':{'row-numbers':[{'display':_0xcf017f(0x1e1),'insert':'\x5cleftarrow','isAction':!![]},{'display':'1','insert':'1'},{'display':'2','insert':'2'},{'display':'3','insert':'3'},{'display':'4','insert':'4'},{'display':'5','insert':'5'},{'display':'6','insert':'6'},{'display':'7','insert':'7'},{'display':'8','insert':'8'},{'display':'9','insert':'9'},{'display':'0','insert':'0'},{'display':_0xcf017f(0x299),'insert':'\x5crightarrow','isAction':!![]}],'row-qwerty':[{'display':'q','insert':'q'},{'display':'w','insert':'w'},{'display':'e','insert':'e'},{'display':'r','insert':'r'},{'display':'t','insert':'t'},{'display':'y','insert':'y'},{'display':'u','insert':'u'},{'display':'i','insert':'i'},{'display':'o','insert':'o'},{'display':'p','insert':'p'}],'row-asdfghjkl':[{'display':'a','insert':'a'},{'display':'s','insert':'s'},{'display':'d','insert':'d'},{'display':'f','insert':'f'},{'display':'g','insert':'g'},{'display':'h','insert':'h'},{'display':'j','insert':'j'},{'display':'k','insert':'k'},{'display':'l','insert':'l'}],'row-zxcvbnm':[{'display':_0xcf017f(0x285),'insert':_0xcf017f(0x13f),'isAction':!![],'id':'shiftButton'},{'display':'z','insert':'z'},{'display':'x','insert':'x'},{'display':'c','insert':'c'},{'display':'v','insert':'v'},{'display':'b','insert':'b'},{'display':'n','insert':'n'},{'display':'m','insert':'m'},{'display':_0xcf017f(0x120),'insert':'\x5cbackspace','isAction':!![]}],'row-symbols-actions':[{'display':_0xcf017f(0x229),'insert':_0xcf017f(0xa9),'isAction':!![],'id':_0xcf017f(0x1d8)},{'display':',','insert':','},{'display':_0xcf017f(0x207),'insert':_0xcf017f(0x1a2),'isAction':!![],'id':_0xcf017f(0x1b0)},{'display':'‚ê£','insert':'\x20','isAction':!![],'class':_0xcf017f(0x171)},{'display':'.','insert':'.'},{'display':_0xcf017f(0x1de),'insert':_0xcf017f(0x21d),'isAction':!![],'id':_0xcf017f(0xe7)},{'display':_0xcf017f(0x12f),'insert':_0xcf017f(0x1eb),'isAction':!![],'id':_0xcf017f(0xe6)}]},'math':{'row-qwerty':[{'display':'@','insert':'@'},{'display':'#','insert':'#'},{'display':'$','insert':'$'},{'display':'_','insert':'_'},{'display':'&','insert':'&'},{'display':'[','insert':'['},{'display':']','insert':']'},{'display':'(','insert':'('},{'display':')','insert':')'},{'display':'\x5c','insert':'\x5c'},{'display':'/','insert':'/'}],'row-asdfghjkl':[{'display':'*','insert':'*'},{'display':'\x22','insert':'\x22'},{'display':'\x27','insert':'\x27'},{'display':':','insert':':'},{'display':';','insert':';'},{'display':'!','insert':'!'},{'display':'¬°','insert':'¬°'},{'display':'¬ø','insert':'¬ø'},{'display':'?','insert':'?'}],'row-zxcvbnm':[{'display':_0xcf017f(0x285),'insert':_0xcf017f(0x13f),'isAction':!![],'id':_0xcf017f(0x17d)},{'display':'‚Üê','insert':'‚Üê','isAction':!![]},{'display':'‚Üí','insert':'‚Üí','isAction':!![]},{'display':'+','insert':'+'},{'display':'-','insert':'-'},{'display':_0xcf017f(0xfa),'insert':_0xcf017f(0xfa)},{'display':'=','insert':'='},{'display':'<','insert':'<'},{'display':'>','insert':'>'},{'display':_0xcf017f(0x120),'insert':'\x5cbackspace','isAction':!![]}],'row-symbols-actions':[{'display':'<span>abc</span>','insert':_0xcf017f(0x227),'isAction':!![],'id':_0xcf017f(0x1d8),'class':'active-mode'},{'display':',','insert':','},{'display':_0xcf017f(0x207),'insert':'languageMode','isAction':!![],'id':_0xcf017f(0x1b0)},{'display':'‚ê£','insert':'\x20','isAction':!![],'class':_0xcf017f(0x171)},{'display':'.','insert':'.'},{'display':_0xcf017f(0x1de),'insert':_0xcf017f(0x21d),'isAction':!![],'id':'toggleScientificBtn'},{'display':_0xcf017f(0x12f),'insert':'greekMode','isAction':!![],'id':_0xcf017f(0xe6)}]},'language':{'row-numbers':[{'display':_0xcf017f(0x1e1),'insert':_0xcf017f(0x111),'isAction':!![]},{'display':_0xcf017f(0x299),'insert':_0xcf017f(0xa5),'isAction':!![]},{'display':'1','insert':'1'},{'display':'2','insert':'2'},{'display':'3','insert':'3'},{'display':'4','insert':'4'},{'display':'5','insert':'5'},{'display':'6','insert':'6'},{'display':'7','insert':'7'},{'display':'8','insert':'8'},{'display':'9','insert':'9'},{'display':'0','insert':'0'}],'row-qwerty':[{'display':'q','insert':'q'},{'display':'w','insert':'w'},{'display':'e','insert':'e'},{'display':'r','insert':'r'},{'display':'t','insert':'t'},{'display':'y','insert':'y'},{'display':'u','insert':'u'},{'display':'i','insert':'i'},{'display':'o','insert':'o'},{'display':'p','insert':'p'}],'row-asdfghjkl':[{'display':'a','insert':'a'},{'display':'s','insert':'s'},{'display':'d','insert':'d'},{'display':'f','insert':'f'},{'display':'g','insert':'g'},{'display':'h','insert':'h'},{'display':'j','insert':'j'},{'display':'k','insert':'k'},{'display':'l','insert':'l'},{'display':'√±','insert':'√±'}],'row-zxcvbnm':[{'display':'<i\x20class=\x22fas\x20fa-arrow-up\x22></i>','insert':_0xcf017f(0x13f),'isAction':!![],'id':_0xcf017f(0x17d)},{'display':'z','insert':'z'},{'display':'x','insert':'x'},{'display':'c','insert':'c'},{'display':'v','insert':'v'},{'display':'b','insert':'b'},{'display':'n','insert':'n'},{'display':'m','insert':'m'},{'display':_0xcf017f(0x120),'insert':_0xcf017f(0x27d),'isAction':!![]}],'row-symbols-actions':[{'display':_0xcf017f(0x229),'insert':_0xcf017f(0xa9),'isAction':!![],'id':_0xcf017f(0x1d8)},{'display':',','insert':','},{'display':'<i\x20class=\x22fas\x20fa-globe\x22></i>','insert':_0xcf017f(0x227),'isAction':!![],'id':_0xcf017f(0x1b0),'class':_0xcf017f(0xb8)},{'display':'‚ê£','insert':'\x20','isAction':!![],'class':_0xcf017f(0x171)},{'display':'.','insert':'.'},{'display':_0xcf017f(0x1de),'insert':_0xcf017f(0x21d),'isAction':!![],'id':_0xcf017f(0xe7)},{'display':'\x5c(\x20\x5cepsilon\x20\x5cdelta\x20\x5c)','insert':'greekMode','isAction':!![],'id':_0xcf017f(0xe6)}]},'greek':{'row-numbers':[{'display':_0xcf017f(0x1e1),'insert':_0xcf017f(0x111),'isAction':!![]},{'display':_0xcf017f(0x299),'insert':_0xcf017f(0xa5),'isAction':!![]},{'display':'1','insert':'1'},{'display':'2','insert':'2'},{'display':'3','insert':'3'},{'display':'4','insert':'4'},{'display':'5','insert':'5'},{'display':'6','insert':'6'},{'display':'7','insert':'7'},{'display':'8','insert':'8'},{'display':'9','insert':'9'},{'display':'0','insert':'0'}],'row-qwerty':[{'display':'Œ±','insert':_0xcf017f(0x268),'shifted':_0xcf017f(0xd3),'isLatexSymbol':!![]},{'display':'Œ≤','insert':_0xcf017f(0x122),'shifted':_0xcf017f(0x29f),'isLatexSymbol':!![]},{'display':'Œ≥','insert':_0xcf017f(0x14e),'shifted':_0xcf017f(0x1f6),'isLatexSymbol':!![]},{'display':'Œ¥','insert':_0xcf017f(0x212),'shifted':_0xcf017f(0x1c1),'isLatexSymbol':!![]},{'display':'Œµ','insert':_0xcf017f(0x24e),'shifted':_0xcf017f(0x28b),'isLatexSymbol':!![]},{'display':'Œ∂','insert':_0xcf017f(0x123),'shifted':_0xcf017f(0x1c3),'isLatexSymbol':!![]},{'display':'Œ∑','insert':'\x5ceta','shifted':'\x5cEta','isLatexSymbol':!![]},{'display':'Œ∏','insert':'\x5ctheta','shifted':_0xcf017f(0xf7),'isLatexSymbol':!![]},{'display':'Œπ','insert':_0xcf017f(0x208),'shifted':'\x5cIota','isLatexSymbol':!![]},{'display':'Œ∫','insert':'\x5ckappa','shifted':'\x5cKappa','isLatexSymbol':!![]}],'row-asdfghjkl':[{'display':'Œª','insert':_0xcf017f(0x265),'shifted':_0xcf017f(0x103),'isLatexSymbol':!![]},{'display':'Œº','insert':_0xcf017f(0x211),'shifted':'\x5cMu','isLatexSymbol':!![]},{'display':'ŒΩ','insert':'\x5cnu','shifted':'\x5cNu','isLatexSymbol':!![]},{'display':'Œæ','insert':_0xcf017f(0x174),'shifted':_0xcf017f(0x11c),'isLatexSymbol':!![]},{'display':'Œø','insert':'o','shifted':'O','isLatexSymbol':![]},{'display':'œÄ','insert':_0xcf017f(0x126),'shifted':_0xcf017f(0x19f),'isLatexSymbol':!![]},{'display':'œÅ','insert':_0xcf017f(0x195),'shifted':_0xcf017f(0x226),'isLatexSymbol':!![]},{'display':'œÉ','insert':'\x5csigma','shifted':_0xcf017f(0x16c),'isLatexSymbol':!![]},{'display':'œÑ','insert':_0xcf017f(0xf9),'shifted':_0xcf017f(0x1ea),'isLatexSymbol':!![]},{'display':'œÇ','insert':_0xcf017f(0x251),'isLatexSymbol':!![]}],'row-zxcvbnm':[{'display':_0xcf017f(0x285),'insert':_0xcf017f(0x13f),'isAction':!![],'id':'shiftButton'},{'display':'œÖ','insert':'\x5cupsilon','shifted':_0xcf017f(0x1c2),'isLatexSymbol':!![]},{'display':'œÜ','insert':_0xcf017f(0x13d),'shifted':_0xcf017f(0x131),'isLatexSymbol':!![]},{'display':'œá','insert':'\x5cchi','shifted':_0xcf017f(0x220),'isLatexSymbol':!![]},{'display':'œà','insert':'\x5cpsi','shifted':_0xcf017f(0x272),'isLatexSymbol':!![]},{'display':'œâ','insert':_0xcf017f(0xef),'shifted':_0xcf017f(0x25a),'isLatexSymbol':!![]},{'display':'‚àá','insert':_0xcf017f(0x254),'isLatexSymbol':!![]},{'display':'‚à´','insert':_0xcf017f(0x14f),'isLatexOp':!![]},{'display':'Œ£','insert':_0xcf017f(0x16c),'isLatexOp':!![]},{'display':'<i\x20class=\x22fas\x20fa-backspace\x22></i>','insert':_0xcf017f(0x27d),'isAction':!![]}],'row-symbols-actions':[{'display':_0xcf017f(0x229),'insert':_0xcf017f(0xa9),'isAction':!![],'id':_0xcf017f(0x1d8)},{'display':',','insert':','},{'display':'<i\x20class=\x22fas\x20fa-globe\x22></i>','insert':'languageMode','isAction':!![],'id':_0xcf017f(0x1b0)},{'display':'‚ê£','insert':'\x20','isAction':!![],'class':_0xcf017f(0x171)},{'display':_0xcf017f(0x1de),'insert':_0xcf017f(0x21d),'isAction':!![],'id':_0xcf017f(0xe7)},{'display':'.','insert':'.'},{'display':_0xcf017f(0xab),'insert':_0xcf017f(0x227),'isAction':!![],'id':_0xcf017f(0xe6),'class':'active-mode'}]}};let repeatTimer,repeatInterval=0x64,initialDelay=0x1f4,isRepeating=![],incrementador=0x32;function renderKeyboard(_0x2bd7ea){const _0x1c9abf=_0xcf017f;currentKeyboardLayout=_0x2bd7ea;const _0xf99707=KEYBOARD_LAYOUTS[_0x2bd7ea];for(const _0x86935f in _0xf99707){const _0x195bad=document['getElementById'](_0x86935f);_0x195bad&&(_0x195bad[_0x1c9abf(0x234)]='',_0xf99707[_0x86935f][_0x1c9abf(0x246)](_0xa3120e=>{const _0x3442ec=_0x1c9abf,_0x25dd67=document[_0x3442ec(0x15c)](_0x3442ec(0x200));let _0x169e64=_0xa3120e['display'];if(_0x169e64['includes']('\x5c(')||_0x169e64['includes']('\x5c)')){const _0x550a27=document[_0x3442ec(0x15c)](_0x3442ec(0x167));_0x550a27[_0x3442ec(0x1ad)]['add'](_0x3442ec(0x29c)),_0x550a27[_0x3442ec(0x239)]=_0x169e64['replace'](/<\/?span[^>]*>/g,''),_0x25dd67[_0x3442ec(0x177)](_0x550a27);}else _0x25dd67[_0x3442ec(0x234)]=_0x169e64;if(_0xa3120e['id'])_0x25dd67['id']=_0xa3120e['id'];if(_0xa3120e[_0x3442ec(0x150)])_0x25dd67[_0x3442ec(0x1ad)][_0x3442ec(0x17a)](_0xa3120e[_0x3442ec(0x150)]);if(_0xa3120e[_0x3442ec(0x179)])_0x25dd67[_0x3442ec(0x1ad)][_0x3442ec(0x17a)](_0x3442ec(0x1f5));if(_0xa3120e[_0x3442ec(0x150)]==='active-mode')_0x25dd67[_0x3442ec(0x1ad)]['add'](_0x3442ec(0xb8));if(_0xa3120e[_0x3442ec(0x1d6)]===_0x3442ec(0x13f))_0x25dd67[_0x3442ec(0x1e9)]=toggleShift;else{if(_0xa3120e[_0x3442ec(0x1d6)][_0x3442ec(0x19d)](_0x3442ec(0x1db)))_0x25dd67[_0x3442ec(0x1e9)]=()=>toggleKeyboardMode(_0xa3120e[_0x3442ec(0x1d6)][_0x3442ec(0xbb)](_0x3442ec(0x1db),''));else _0xa3120e[_0x3442ec(0x241)]||_0xa3120e[_0x3442ec(0xf4)]?_0x25dd67[_0x3442ec(0x1e9)]=()=>insertSymbol(_0xa3120e['insert']):[_0x3442ec(0x27d),_0x3442ec(0x111),'\x5crightarrow'][_0x3442ec(0xdc)](_0xa3120e['insert'])?(_0x25dd67[_0x3442ec(0x1b7)]('mousedown',_0x293ee0=>startRepeatAction(_0xa3120e[_0x3442ec(0x1d6)],_0x293ee0)),_0x25dd67[_0x3442ec(0x1b7)](_0x3442ec(0x1f4),stopRepeatAction),_0x25dd67[_0x3442ec(0x1b7)](_0x3442ec(0x236),stopRepeatAction),_0x25dd67[_0x3442ec(0x1b7)]('touchstart',_0x1fad0b=>startRepeatAction(_0xa3120e[_0x3442ec(0x1d6)],_0x1fad0b)),_0x25dd67[_0x3442ec(0x1b7)](_0x3442ec(0xc4),stopRepeatAction),_0x25dd67[_0x3442ec(0x1b7)]('touchcancel',stopRepeatAction)):_0x25dd67['onclick']=()=>insertChar(_0xa3120e[_0x3442ec(0x1d6)]);}_0x195bad[_0x3442ec(0x177)](_0x25dd67);}));}updateShiftUI(),updateModeIndicator();if(window[_0x1c9abf(0x1bf)])requestAnimationFrame(()=>{const _0x41646f=_0x1c9abf;MathJax[_0x41646f(0x13e)](document['querySelectorAll']('#customKeyboard\x20.latex-button'))[_0x41646f(0xc3)](()=>{window['hljs']&&applySyntaxHighlighting();})[_0x41646f(0x262)](_0x4d19f2=>{const _0x5824f9=_0x41646f;console[_0x5824f9(0xc0)](_0x5824f9(0xf8),_0x4d19f2);});});else window['hljs']&&applySyntaxHighlighting();}function startRepeatAction(_0x426c24,_0xb671e7){const _0x3214d6=_0xcf017f;_0xb671e7[_0x3214d6(0x1d1)](),isRepeating=!![],insertChar(_0x426c24),clearTimeout(repeatTimer),clearInterval(repeatTimer),repeatTimer=setTimeout(()=>{repeatTimer=setInterval(()=>{insertChar(_0x426c24);},repeatInterval);},initialDelay);}function stopRepeatAction(){clearTimeout(repeatTimer),clearInterval(repeatTimer),isRepeating=![];}function insertChar(_0x3b4e8b){const _0x50fb90=_0xcf017f,_0x37da9f=document[_0x50fb90(0x238)](_0x50fb90(0x22b));if(!(_0x37da9f instanceof MathfieldElement)){console[_0x50fb90(0xc0)]('No\x20es\x20un\x20MathfieldElement\x20o\x20no\x20est√°\x20inicializado.');return;}_0x37da9f[_0x50fb90(0x13a)]();if(_0x3b4e8b===_0x50fb90(0x27d))_0x37da9f[_0x50fb90(0x202)](_0x50fb90(0x173));else{if(_0x3b4e8b==='\x5cleftarrow')_0x37da9f[_0x50fb90(0x202)](_0x50fb90(0x190));else{if(_0x3b4e8b===_0x50fb90(0xa5))_0x37da9f[_0x50fb90(0x202)](_0x50fb90(0x158));else{const _0x55a9f6=isShiftActive?_0x3b4e8b[_0x50fb90(0x260)]():_0x3b4e8b[_0x50fb90(0x276)]();_0x37da9f['insert'](_0x50fb90(0x1d4)+_0x55a9f6+'}');}}}isShiftActive&&_0x3b4e8b!=='shift'&&![_0x50fb90(0x27d),_0x50fb90(0x111),'\x5crightarrow']['includes'](_0x3b4e8b)&&(isShiftActive=![],updateShiftUI());}function toggleKeyboardMode(_0x857aeb){const _0x5a42f2=_0xcf017f;_0x857aeb===currentKeyboardLayout?renderKeyboard(_0x5a42f2(0x160)):renderKeyboard(_0x857aeb),isShiftActive&&(isShiftActive=![],updateShiftUI());}function insertSymbol(_0x1912dc){const _0x146f14=_0xcf017f,_0x27b92c=document[_0x146f14(0x238)]('userInput');_0x27b92c['focus'](),_0x27b92c[_0x146f14(0x1d6)](_0x1912dc,{'selectionMode':_0x146f14(0x292)}),isShiftActive&&(isShiftActive=![],updateShiftUI());}function toggleShift(){const _0x13fdb8=_0xcf017f;isShiftActive=!isShiftActive,updateShiftUI();const _0x2f1095=[_0x13fdb8(0x20e),_0x13fdb8(0x22a),'row-zxcvbnm'];_0x2f1095[_0x13fdb8(0x246)](_0x188543=>{const _0x1962f9=_0x13fdb8,_0x5aa17f=document['getElementById'](_0x188543);_0x5aa17f&&_0x5aa17f[_0x1962f9(0xf6)]('button')[_0x1962f9(0x246)](_0x40a54f=>{const _0x1d3629=_0x1962f9,_0x2cd414=_0x40a54f[_0x1d3629(0x239)];_0x2cd414[_0x1d3629(0x116)]===0x1&&_0x2cd414[_0x1d3629(0x28c)](/[a-zA-Z√±√ë]/)&&(_0x40a54f[_0x1d3629(0x239)]=isShiftActive?_0x2cd414[_0x1d3629(0x260)]():_0x2cd414[_0x1d3629(0x276)]());});});}function updateShiftUI(){const _0xcefa2d=_0xcf017f,_0x1c403a=document[_0xcefa2d(0x238)](_0xcefa2d(0x17d));_0x1c403a&&(isShiftActive?(_0x1c403a[_0xcefa2d(0xb6)]('i')[_0xcefa2d(0x1ad)][_0xcefa2d(0x1cc)]('fa-arrow-up'),_0x1c403a['querySelector']('i')[_0xcefa2d(0x1ad)][_0xcefa2d(0x17a)](_0xcefa2d(0x274)),_0x1c403a[_0xcefa2d(0x1ad)][_0xcefa2d(0x17a)]('active-shift')):(_0x1c403a[_0xcefa2d(0xb6)]('i')[_0xcefa2d(0x1ad)][_0xcefa2d(0x1cc)](_0xcefa2d(0x274)),_0x1c403a[_0xcefa2d(0xb6)]('i')[_0xcefa2d(0x1ad)][_0xcefa2d(0x17a)](_0xcefa2d(0x21b)),_0x1c403a[_0xcefa2d(0x1ad)][_0xcefa2d(0x1cc)](_0xcefa2d(0x23a))));}function updateModeIndicator(){const _0x5285ab=_0xcf017f;document[_0x5285ab(0xf6)](_0x5285ab(0x1fa))['forEach'](_0x44a8fa=>{const _0x501aae=_0x5285ab;_0x44a8fa[_0x501aae(0x1ad)][_0x501aae(0x1cc)]('active-mode');});let _0x1cf223;if(currentKeyboardLayout===_0x5285ab(0x23c))_0x1cf223=_0x5285ab(0x1d8);else{if(currentKeyboardLayout==='language')_0x1cf223=_0x5285ab(0x1b0);else currentKeyboardLayout===_0x5285ab(0x12c)?_0x1cf223=_0x5285ab(0xe6):_0x1cf223=null;}if(_0x1cf223){const _0x3dcbcd=document[_0x5285ab(0x238)](_0x1cf223);_0x3dcbcd&&_0x3dcbcd[_0x5285ab(0x1ad)][_0x5285ab(0x17a)](_0x5285ab(0xb8));}}function closeCustomKeyboard(){const _0x20d587=_0xcf017f;document[_0x20d587(0x238)]('customKeyboard')[_0x20d587(0x1ad)]['add'](_0x20d587(0x14c)),isShiftActive&&(isShiftActive=![],updateShiftUI()),renderKeyboard(_0x20d587(0x160));}document['addEventListener'](_0xcf017f(0x1df),function(){const _0xe6957f=_0xcf017f;renderKeyboard(_0xe6957f(0x160)),initializeMathLive(),document[_0xe6957f(0x238)](_0xe6957f(0x17f))[_0xe6957f(0x1b7)](_0xe6957f(0x1e7),()=>{const _0x59e8ff=_0xe6957f,_0x229c9b=document[_0x59e8ff(0x238)](_0x59e8ff(0x1fd));_0x229c9b[_0x59e8ff(0x1ad)][_0x59e8ff(0x21f)](_0x59e8ff(0x14c)),_0x229c9b[_0x59e8ff(0x1ad)][_0x59e8ff(0x1e5)](_0x59e8ff(0x14c))&&(isShiftActive&&(isShiftActive=![],updateShiftUI()),renderKeyboard(_0x59e8ff(0x160)));});}),document[_0xcf017f(0x1b7)]('DOMContentLoaded',()=>{const _0x25e986=_0xcf017f,_0x1da5ef=document[_0x25e986(0x238)](_0x25e986(0xbe));setTimeout(()=>{showWelcomeMessage();},0x12c),currentLanguage==='en'?(_0x1da5ef[_0x25e986(0x239)]=_0x25e986(0x16b),_0x1da5ef['classList'][_0x25e986(0x17a)](_0x25e986(0x113))):(_0x1da5ef[_0x25e986(0x239)]=_0x25e986(0x1f1),_0x1da5ef[_0x25e986(0x1ad)][_0x25e986(0x17a)]('es-active')),_0x1da5ef[_0x25e986(0x1b7)]('click',()=>{const _0x41a944=_0x25e986;currentLanguage==='en'?(currentLanguage='es',_0x1da5ef['textContent']=_0x41a944(0x1f1),_0x1da5ef['classList'][_0x41a944(0x1cc)](_0x41a944(0x113)),_0x1da5ef[_0x41a944(0x1ad)][_0x41a944(0x17a)]('es-active')):(currentLanguage='en',_0x1da5ef['textContent']='English',_0x1da5ef[_0x41a944(0x1ad)][_0x41a944(0x1cc)]('es-active'),_0x1da5ef[_0x41a944(0x1ad)][_0x41a944(0x17a)]('en-active')),clearChat(),showWelcomeMessage(),console[_0x41a944(0x232)]('Idioma\x20cambiado\x20a:\x20'+currentLanguage);});});const headerEventListeners=new Map();function initializeHeader(){const _0xa20676=_0xcf017f;initializeMathLive();const _0x33683a=document['getElementById'](_0xa20676(0xf5)),_0x3b9577=document[_0xa20676(0x238)]('secondaryHeader'),_0x2d1365=document[_0xa20676(0x238)](_0xa20676(0x159)),_0x51e698=document[_0xa20676(0x238)](_0xa20676(0x115)),_0x184937=document[_0xa20676(0x238)](_0xa20676(0x25f)),_0x3511bd=document[_0xa20676(0x238)](_0xa20676(0x1c4)),_0x33ff76=document[_0xa20676(0x238)](_0xa20676(0xd1)),_0x1c3cd9=document[_0xa20676(0x238)](_0xa20676(0x188));initializeLanguageButton();let _0x464d43=!![];if(_0x33683a){const _0x4681a3=function(){const _0x287e97=_0xa20676;if(_0x464d43)isMathTutorMode=!![],_0x33683a[_0x287e97(0x239)]='Math\x20Tutor',_0x3b9577[_0x287e97(0x106)]['display']=_0x287e97(0x186);else{isMathTutorMode=![],_0x33683a[_0x287e97(0x239)]=_0x287e97(0xac),_0x3b9577['style'][_0x287e97(0x1d9)]=_0x287e97(0x1aa);if(_0x3511bd)_0x3511bd[_0x287e97(0x194)]='none';if(_0x33ff76)_0x33ff76[_0x287e97(0x142)]=!![];resetContext();}_0x464d43=!_0x464d43;};_0x33683a[_0xa20676(0x1b7)](_0xa20676(0x1e7),_0x4681a3),headerEventListeners[_0xa20676(0x222)](_0x33683a,{'type':_0xa20676(0x1e7),'handler':_0x4681a3});}_0x33ff76&&(_0x33ff76['disabled']=!![]);if(_0x3511bd&&_0x33ff76){const _0x3205f4=function(){const _0x527a0b=_0xa20676;console['log'](_0x527a0b(0xec),this[_0x527a0b(0x194)]),_0x33ff76[_0x527a0b(0x142)]=this[_0x527a0b(0x194)]===_0x527a0b(0x1aa);};_0x3511bd[_0xa20676(0x1b7)](_0xa20676(0x1c0),_0x3205f4),headerEventListeners[_0xa20676(0x222)](_0x3511bd,{'type':_0xa20676(0x1c0),'handler':_0x3205f4});}if(_0x2d1365){const _0x344309=function(){const _0x37950a=_0xa20676,_0x482125=summarizeContext();mathField[_0x37950a(0x1ab)](_0x37950a(0x237)+_0x482125+',\x20por\x20favor\x20proporci√≥name\x20una\x20pista\x20relevante\x20para\x20avanzar.\x20No\x20menciones\x20el\x20contexto\x20directamente,\x20solo\x20da\x20la\x20pista.}'),mathField[_0x37950a(0x13a)](),sendMessage();};_0x2d1365[_0xa20676(0x1b7)](_0xa20676(0x1e7),_0x344309),headerEventListeners[_0xa20676(0x222)](_0x2d1365,{'type':_0xa20676(0x1e7),'handler':_0x344309});}if(_0x51e698){const _0x569950=function(){const _0x78f394=_0xa20676,_0x5b26fc=summarizeContext();mathField[_0x78f394(0x1ab)](_0x78f394(0x243)+_0x5b26fc+',\x20expl√≠came\x20los\x20conceptos\x20te√≥ricos\x20clave\x20que\x20deber√≠a\x20entender.\x20Organiza\x20la\x20explicaci√≥n\x20de\x20manera\x20clara\x20y\x20estructurada.}'),mathField[_0x78f394(0x13a)](),sendMessage();};_0x51e698[_0xa20676(0x1b7)]('click',_0x569950),headerEventListeners[_0xa20676(0x222)](_0x51e698,{'type':_0xa20676(0x1e7),'handler':_0x569950});}if(_0x184937){const _0x5a32e7=function(){const _0x234467=_0xa20676,_0x49eaed=summarizeContext();mathField[_0x234467(0x1ab)](_0x234467(0x157)+_0x49eaed+_0x234467(0xc6)),mathField[_0x234467(0x13a)](),sendMessage();};_0x184937[_0xa20676(0x1b7)](_0xa20676(0x1e7),_0x5a32e7),headerEventListeners[_0xa20676(0x222)](_0x184937,{'type':_0xa20676(0x1e7),'handler':_0x5a32e7});}if(_0x1c3cd9){const _0x5b7a27=function(){const _0x4d90e2=_0xa20676;this['checked']?(currentModel='deepseek-reasoner',reasonerUsesLeft=0x2,showReasonerWarning()):(currentModel=_0x4d90e2(0x25b),reasonerUsesLeft=0x0,hideReasonerWarning());};_0x1c3cd9[_0xa20676(0x1b7)](_0xa20676(0x1c0),_0x5b7a27),headerEventListeners[_0xa20676(0x222)](_0x1c3cd9,{'type':'change','handler':_0x5b7a27});}}function showReasonerWarning(){const _0x5d0719=_0xcf017f;hideReasonerWarning();const _0x53484f=document[_0x5d0719(0x15c)](_0x5d0719(0x18c));_0x53484f[_0x5d0719(0x273)]=_0x5d0719(0x203),_0x53484f[_0x5d0719(0x239)]=_0x5d0719(0x263)+reasonerUsesLeft+_0x5d0719(0x124)+(reasonerUsesLeft===0x1?'':'s')+_0x5d0719(0xdb),document[_0x5d0719(0xdf)][_0x5d0719(0x177)](_0x53484f),setTimeout(()=>{const _0x1afb4e=_0x5d0719;_0x53484f[_0x1afb4e(0x1ad)]['add'](_0x1afb4e(0x187));},0xa),setTimeout(()=>{const _0x4374be=_0x5d0719;_0x53484f[_0x4374be(0x1ad)][_0x4374be(0x1cc)]('show'),_0x53484f['classList'][_0x4374be(0x17a)](_0x4374be(0x1d7)),setTimeout(()=>{const _0x4df1fa=_0x4374be;_0x53484f[_0x4df1fa(0x24c)]&&_0x53484f['parentNode'][_0x4df1fa(0x136)](_0x53484f);},0x1f4);},0xfa0);}function hideReasonerWarning(){const _0x1c2e22=_0xcf017f,_0x5a2701=document['querySelectorAll'](_0x1c2e22(0x112));_0x5a2701[_0x1c2e22(0x246)](_0x3da94d=>{const _0x2ddff8=_0x1c2e22;_0x3da94d[_0x2ddff8(0x24c)]&&_0x3da94d[_0x2ddff8(0x24c)][_0x2ddff8(0x136)](_0x3da94d);});}function updateReasonerWarning(){const _0x160b34=_0xcf017f,_0x117b46=document[_0x160b34(0xb6)](_0x160b34(0x112));_0x117b46&&(_0x117b46[_0x160b34(0x239)]=_0x160b34(0x263)+reasonerUsesLeft+_0x160b34(0x124)+(reasonerUsesLeft===0x1?'':'s')+_0x160b34(0xdb));}function initializeLanguageButton(){const _0x4280ec=_0xcf017f,_0x2a53ea=document['getElementById']('languageToggleButton');if(!_0x2a53ea)return;currentLanguage==='en'?(_0x2a53ea['textContent']=_0x4280ec(0x16b),_0x2a53ea['classList']['add'](_0x4280ec(0x113))):(_0x2a53ea[_0x4280ec(0x239)]=_0x4280ec(0x1f1),_0x2a53ea['classList'][_0x4280ec(0x17a)](_0x4280ec(0x1b2))),_0x2a53ea['addEventListener']('click',function(){const _0x1f09c1=_0x4280ec;currentLanguage==='en'?(currentLanguage='es',this[_0x1f09c1(0x239)]=_0x1f09c1(0x1f1),this[_0x1f09c1(0x1ad)][_0x1f09c1(0x1cc)](_0x1f09c1(0x113)),this[_0x1f09c1(0x1ad)]['add'](_0x1f09c1(0x1b2))):(currentLanguage='en',this[_0x1f09c1(0x239)]=_0x1f09c1(0x16b),this[_0x1f09c1(0x1ad)][_0x1f09c1(0x1cc)]('es-active'),this[_0x1f09c1(0x1ad)][_0x1f09c1(0x17a)]('en-active')),clearChat(),console['log'](_0x1f09c1(0x193)+currentLanguage);});}function handleLanguageToggle(){const _0x516a1b=_0xcf017f;currentLanguage==='en'?(currentLanguage='es',this[_0x516a1b(0x239)]='Espa√±ol',this[_0x516a1b(0x1ad)]['remove']('en-active'),this['classList']['add']('es-active')):(currentLanguage='en',this[_0x516a1b(0x239)]='English',this['classList']['remove']('es-active'),this[_0x516a1b(0x1ad)][_0x516a1b(0x17a)](_0x516a1b(0x113))),clearChat(),console[_0x516a1b(0x232)](_0x516a1b(0x193)+currentLanguage);}document[_0xcf017f(0x1b7)](_0xcf017f(0x1df),function(){initializeHeader(),initializeLanguageButton();});const welcomeMessages={'es':'\x0a#\x20Por\x20d√≥nde\x20iniciamos?\x0a','en':_0xcf017f(0x1c7)};function _0x2e55(){const _0x59352e=['clientY','<div\x20class=\x22math-equation-stream\x22>','shiftButton','\x0aEres\x20**No√ªs**,\x20un\x20asistente\x20de\x20IA\x20avanzado\x20y\x20especializado\x20en\x20campos\x20STEM.\x20Tu\x20prop√≥sito\x20principal\x20es\x20ofrecer\x20explicaciones\x20con\x20**claridad\x20inigualable**\x20y\x20**precisi√≥n\x20absoluta**,\x20manteniendo\x20siempre\x20un\x20**rigor\x20est√©tico\x20profesional**.\x20Te\x20adaptar√°s\x20al\x20**contexto\x20y\x20foco**\x20de\x20cada\x20consulta,\x20siendo\x20siempre\x20**claro,\x20riguroso\x20y\x20exhaustivo**,\x20sin\x20omitir\x20pasos\x20importantes.\x0a\x0a---\x0a\x0a###\x20**Principios\x20de\x20Presentaci√≥n\x20y\x20Formato**\x0a\x0aPara\x20una\x20comunicaci√≥n\x20√≥ptima\x20y\x20visualmente\x20atractiva,\x20utilizar√°s\x20las\x20siguientes\x20herramientas\x20de\x20forma\x20juiciosa\x20y\x20contextualmente\x20relevante:\x0a\x0a*\x20**Markdown:**\x20Para\x20estructurar\x20la\x20informaci√≥n\x20clave\x20(encabezados,\x20listas)\x20y\x20enfatizar\x20el\x20contenido\x20(negritas,\x20cursivas,\x20bloques\x20de\x20c√≥digo).\x0a*\x20**LaTeX:**\x20Crucial\x20para\x20la\x20presentaci√≥n\x20impecable\x20de\x20todo\x20contenido\x20matem√°tico\x20y\x20cient√≠fico.\x0a\x20\x20\x20\x20*\x20**Delimitadores\x20MathJax:**\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20Inline:\x20\x5c(\x20...\x20\x5c)\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20Display:\x20$$\x20...\x20$$\x20(preferido)\x20o\x20\x5c[\x20...\x20\x5c]\x0a\x20\x20\x20\x20*\x20**Paquetes\x20compatibles:**\x20ams,\x20boldsymbol,\x20physics.\x0a*\x20**Formato\x20CSS:**\x20Para\x20distinci√≥n\x20visual\x20y\x20legibilidad\x20mejorada\x20(ej.\x20resaltados,\x20bloques\x20espec√≠ficos).\x0a*\x20**Separadores\x20Visuales:**\x20Emplea\x20\x22---\x22\x20entre\x20los\x20parrafos\x20para\x20dividir\x20secciones\x20de\x20contenido\x20o\x20transiciones\x20importantes,\x20mejorando\x20la\x20legibilidad.\x0a*\x20**Usa\x20emojis\x20para\x20mejorar\x20la\x20estetica\x20y\x20transmitir\x20cercania**\x0a*\x20**Termina\x20la\x20converzacion\x20haciendo\x20una\x20invitacion\x20o\x20pregunta\x20para\x20continuar\x20estudiando\x20con\x20el\x20estudiante**\x0a\x0a---\x0a\x0a###\x20**Estructuras\x20de\x20Contenido\x20Espec√≠ficas**\x0a\x0aMantendr√°s\x20una\x20consistencia\x20estricta\x20usando\x20los\x20siguientes\x20formatos\x20para\x20elementos\x20clave:\x0a\x0a*\x20**T√≠tulos:**\x20Solo\x20estos\x20tres\x20niveles:\x0a\x20\x20\x20\x20*\x20#\x20T√≠tulo\x20grande\x0a\x20\x20\x20\x20*\x20##\x20T√≠tulo\x20mediano\x20(el\x20t√≠tulo\x20por\x20defecto)\x0a\x20\x20\x20\x20*\x20###\x20T√≠tulo\x20ligero\x20(para\x20subt√≠tulos)\x0a*\x20**Texto\x20Resaltado:**\x0a\x20\x20\x20\x20*\x20<span\x20class=\x22math-text\x22>Palabra\x20clave</span>\x20para\x20t√©rminos\x20matem√°ticos/cient√≠ficos.\x0a\x20\x20\x20\x20*\x20<span\x20class=\x22highlight\x22>Palabra\x20subrayada</span>\x20para\x20conceptos\x20importantes.\x0a*\x20**Pasos:**\x20Usa\x20el\x20sigueinte\x20formato\x20para\x20encerrar\x20cada\x20uno\x20de\x20paso\x20relevantes\x20de\x20la\x20solucion.\x0a\x20\x20\x20\x20<step>\x0a\x20\x20\x20\x20##\x20Paso\x201:\x20Aplicar\x20la\x20formula\x0a\x20\x20\x20\x20aqui\x20pones\x20el\x20desarrollo\x20de\x20ese\x20paso\x0a\x20\x20\x20\x20</step>\x0a*\x20**Tablas:**\x20Usa\x20siempre\x20el\x20formato\x20<data-table>.\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<data-table>\x0a\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<th>Magnitud</th>\x0a\x20\x20\x20\x20<th>Unidad</th>\x0a\x20\x20\x20\x20<th>Valor\x20Ejemplo</th>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Velocidad</td>\x0a\x20\x20\x20\x20<td>m/s</td>\x0a\x20\x20\x20\x20<td>\x5c(281.6\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Frecuencia</td>\x0a\x20\x20\x20\x20<td>Hz</td>\x0a\x20\x20\x20\x20<td>\x5c(440\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Longitud</td>\x0a\x20\x20\x20\x20<td>m</td>\x0a\x20\x20\x20\x20<td>\x5c(0.32\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20</data-table>\x0a\x20\x20\x20\x20```\x0a\x0a---\x0a\x0a###\x20**Manejo\x20de\x20C√≥digo\x20y\x20Gr√°ficos**\x0a\x0a*\x20**Bloques\x20de\x20C√≥digo:**\x20Siempre\x20en\x20formato\x20Markdown.\x20Si\x20se\x20solicita\x20c√≥digo\x20LaTeX\x20expl√≠citamente,\x20usa\x20tambi√©n\x20este\x20formato.\x0a\x20\x20\x20\x20```python\x0a\x20\x20\x20\x20def\x20calcular_area(radio):\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22\x22\x22Calcula\x20el\x20√°rea\x20de\x20un\x20c√≠rculo\x22\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x203.1416\x20*\x20radio\x20**\x202\x0a\x0a\x20\x20\x20\x20print(calcular_area(5))\x20\x20#\x20Ejemplo\x20de\x20uso\x0a\x20\x20\x20\x20```\x0a*\x20**Gr√°ficos\x20(solo\x20si\x20se\x20solicitan\x20expl√≠citamente):**\x20Utiliza\x20el\x20siguiente\x20formato,\x20incluyendo\x20una\x20breve\x20descripci√≥n\x20en\x20la\x20etiqueta\x20<plotly-chart>.\x0a\x20\x20\x20\x20```plotly-js\x0a\x20\x20\x20\x20//\x20Datos\x20del\x20gr√°fico\x0a\x20\x20\x20\x20const\x20data\x20=\x20[{\x0a\x20\x20\x20\x20\x20\x20x:\x20[\x27Ene\x27,\x20\x27Feb\x27,\x20\x27Mar\x27,\x20\x27Abr\x27],\x0a\x20\x20\x20\x20\x20\x20y:\x20[20,\x2014,\x2025,\x2016],\x0a\x20\x20\x20\x20\x20\x20type:\x20\x27bar\x27,\x0a\x20\x20\x20\x20\x20\x20marker:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20\x27rgb(55,\x2083,\x20109)\x27\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}];\x0a\x0a\x20\x20\x20\x20//\x20Configuraci√≥n\x20del\x20layout\x0a\x20\x20\x20\x20const\x20layout\x20=\x20{\x0a\x20\x20\x20\x20\x20\x20title:\x20\x27Ventas\x20por\x20Mes\x27,\x0a\x20\x20\x20\x20\x20\x20xaxis:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20title:\x20\x27Mes\x27\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20yaxis:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20title:\x20\x27Ventas\x20(miles)\x27\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20margin:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20l:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20r:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20b:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20t:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20pad:\x204\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20};\x0a\x0a\x20\x20\x20\x20//\x20Renderizar\x20el\x20gr√°fico\x0a\x20\x20\x20\x20Plotly.newPlot(\x27graph-container\x27,\x20data,\x20layout);\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<plotly-chart>\x0a\x20\x20\x20\x20Este\x20gr√°fico\x20de\x20barras\x20muestra\x20las\x20ventas\x20mensuales\x20del\x20primer\x20trimestre,\x20donde\x20se\x20observa\x20un\x20pico\x20en\x20marzo\x20seguido\x20de\x20una\x20disminuci√≥n\x20en\x20abril.\x0a\x20\x20\x20\x20</plotly-chart>\x0a','toggleCustomKeyboardBtn','jsHeapSizeLimit','logic-btn','clipboard','parentElement','<div\x20class=\x22tutor-check\x22><strong>Feedback:</strong>\x20$1</div>','.plotly-loading','flex','show','reasonerToggle','terminate','Uso\x20de\x20memoria\x20cr√≠tico,\x20limpiando\x20cache...','<div\x20class=\x22definition\x22>','div','keyboard-logic','\x5c(\x20\x5csum\x20\x5c)','opacity','moveToPreviousChar','&gt;','handleContextAction','Idioma\x20cambiado\x20a:\x20','value','\x5crho','\x27,\x20\x27cleanCode:\x27,\x20cleanCode);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20throw\x20new\x20Error(\x27Formato\x20de\x20c√≥digo\x20inv√°lido\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20Parsear\x20con\x20validaci√≥n\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20parsePlotlyObj\x20=\x20(str)\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20fixedStr\x20=\x20str\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.replace(/([\x5c{\x5c,]\x5cs*)(\x5cw+)\x5cs*:/g,\x20\x27$1\x22$2\x22:\x27)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.replace(/\x27/g,\x20\x27\x22\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x203.\x20Log\x20de\x20la\x20cadena\x20arreglada\x20antes\x20de\x20JSON.parse\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27Plotly\x20Debug:\x20String\x20a\x20parsear\x20(fixedStr):\x27,\x20fixedStr.substring(0,\x20500));\x20//\x20Limitamos\x20para\x20no\x20llenar\x20la\x20consola\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20JSON.parse(fixedStr);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20data\x20=\x20parsePlotlyObj(dataMatch[1]);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20layout\x20=\x20parsePlotlyObj(layoutMatch[1]);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x204.\x20Log\x20de\x20los\x20objetos\x20data\x20y\x20layout\x20ya\x20parseados\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27Plotly\x20Debug:\x20Objeto\x20data\x20parseado\x20para\x20ID\x20','&#x2F;','outerHTML','Error\x20en\x20acci√≥n\x20del\x20men√∫:','min','\x5cleft|\x5cplaceholder{}\x5cright|','delta','endsWith','message','\x5cPi','<h3\x20class=\x22subtitle\x22>$1</h3>','<span\x20class=\x22highlight\x22>$1</span>','languageMode',')&gt;','.keyboard-category','test','\x20\x5cplaceholder{}',':\x27,\x20e);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20throw\x20new\x20Error(\x27Error\x20al\x20renderizar:\x20\x27\x20+\x20e.message);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20},\x20100);\x20//\x20Descomenta\x20esta\x20l√≠nea\x20y\x20su\x20correspondiente\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20catch(e)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20container.innerHTML\x20=\x20\x27<div\x20class=\x22plotly-error\x22>\x27\x20+\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27Error\x20en\x20el\x20gr√°fico:\x20\x27\x20+\x20e.message.replace(/</g,\x20\x27&lt;\x27)\x20+\x20\x27</div>\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x207.\x20Log\x20del\x20error\x20general\x20del\x20bloque\x20de\x20Plotly\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.error(\x27Plotly\x20Debug:\x20Error\x20general\x20del\x20bloque\x20de\x20gr√°fico\x20para\x20ID\x20','\x5c$1','<strong>$1</strong>','none','setValue','keyboard-calculus','classList','<h2\x20class=\x22title\x22>$1</h2>','keys','toggleLanguageBtn','script','es-active','dataset','lim','Chat\x20limpiado\x20completamente\x20y\x20recursos\x20liberados','join','addEventListener','stringify','\x5c(\x20\x5cfrac{\x5cpartial}{\x5cpartial\x20\x5cboxed{}}\x20\x5c)','<div\x20class=\x22plotly-error\x22>Error:\x20El\x20gr√°fico\x20no\x20se\x20carg√≥</div>','.keyboard-panel','function','copy','No\x20se\x20encontr√≥\x20el\x20contenedor\x20del\x20c√≥digo','MathJax','change','\x5cDelta','\x5cUpsilon','\x5cZeta','examTypeSelect','keyboard-basic','startsWith','\x0a#\x20Where\x20shall\x20we\x20begin?\x0a','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(!container)\x20return;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(typeof\x20Plotly\x20===\x20\x27undefined\x27)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20container.innerHTML\x20=\x20\x27<div\x20class=\x22plotly-error\x22>Error:\x20Plotly.js\x20no\x20est√°\x20cargado</div>\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20Limpiar\x20y\x20validar\x20el\x20c√≥digo\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20cleanCode\x20=\x20','&lt;','readonly','<div\x20class=\x22tutor-concept\x22><strong>Concepto:</strong>\x20$1</div>','remove','target','No\x20se\x20pudo\x20copiar.\x20Por\x20favor,\x20intente\x20manualmente.','workers','\x5csqrt[\x5cplaceholder{}]{\x5cplaceholder{}}','preventDefault','.plotly-graph-container','size','\x5ctext{','user','insert','hide','toggleMathSymbolsBtn','display','.copy-btn','Mode','floor','\x20-\x20ID:','<i\x20class=\x22fas\x20fa-calculator\x22></i>','DOMContentLoaded','hljs','<i\x20class=\x22fas\x20fa-arrow-left\x22></i>','cases-selector','touchstart','text','contains','\x5ccos','click','<h3>$1</h3>','onclick','\x5cTau','greekMode','pageY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22clickable-math-block\x22\x20data-latex=\x22','</div>','pop','touch','Espa√±ol','\x0a\x0a###\x20Contexto\x20de\x20la\x20conversaci√≥n:\x0a','10gnvQUe','mouseup','action-button','\x5cGamma','firstElementChild',':\x27,\x20cleanCode);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20Extraer\x20datos\x20y\x20layout\x20de\x20forma\x20segura\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20dataMatch\x20=\x20cleanCode.match(/const\x20data\x20=\x20(\x5c[[\x5cs\x5cS]*?\x5c]);/);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20layoutMatch\x20=\x20cleanCode.match(/const\x20layout\x20=\x20(\x5c{[\x5cs\x5cS]*?\x5c});/);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(!dataMatch\x20||\x20!layoutMatch)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x202.\x20Log\x20si\x20no\x20se\x20encuentran\x20los\x20patrones\x20de\x20data\x20o\x20layout\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.error(\x27Plotly\x20Debug:\x20Formato\x20de\x20c√≥digo\x20inv√°lido.\x20No\x20se\x20encontraron\x20\x22data\x22\x20o\x20\x22layout\x22\x20en\x20el\x20cleanCode.\x20ID:\x27,\x20\x27','Botones\x20keyboard-category:','#row-symbols-actions\x20.action-button','strong','tan','customKeyboard','map','<div\x20class=\x22tutor-step\x22><strong>Sugerencia:</strong>\x20$1</div>','button','\x5c(\x20\x5cint\x20\x5c)','executeCommand','reasoner-warning','\x5ctan','\x5cfrac{d}{d\x5cplaceholder{}}','\x5cbegin{cases}\x0a','<i\x20class=\x22fas\x20fa-globe\x22></i>','\x5ciota','orientationchange','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22','.MJXc-display','\x5ctimes','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22math-equation\x22>','row-qwerty','Fallback\x20copy\x20failed','select','\x5cmu','\x5cdelta','algebra-btn','<div\x20class=\x22tutor-guide\x22><strong>Pregunta\x20gu√≠a:</strong>\x20$1</div>','replaceWith','chat-msg\x20bot','<span\x20class=\x22important\x22>$1</span>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22copy-full-latex\x22\x20onclick=\x22sendLatexToInput(this.previousElementSibling.textContent.trim())\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-paper-plane\x22></i>\x20Probar\x20este\x20c√≥digo\x20en\x20LaTeX\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x5c(\x20\x5csqrt{\x5cboxed{}}\x20\x5c)','fa-arrow-up','e^{\x5cplaceholder{}}','scientificMode','\x5cprod_{n=\x5cplaceholder{}}^{\x5cplaceholder{}}\x5cplaceholder{}','toggle','\x5cChi','now','set','<div\x20class=\x22note\x22>$1</div>','10293157LTVjIN','.code-block\x20pre\x20code','\x5cRho','defaultMode','disconnect','<span>!#?</span>','row-asdfghjkl','userInput','statusText','choices','innerHeight','&quot;','\x5csum_{n=\x5cplaceholder{}}^{\x5cplaceholder{}}\x5cplaceholder{}','<li>$1</li>','log','copy-message-btn','innerHTML','No\x20se\x20pudo\x20forzar\x20garbage\x20collection','mouseleave','\x5ctext{Basado\x20en\x20nuestra\x20conversaci√≥n\x20sobre\x20','getElementById','textContent','active-shift','<br>','math','Error\x20leyendo\x20el\x20stream:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-indicator\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-dot\x22\x20style=\x22animation-delay:\x200s\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-dot\x22\x20style=\x22animation-delay:\x200.2s\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-dot\x22\x20style=\x22animation-delay:\x200.4s\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','.code-block','\x5c(\x20|\x5cboxed{}|\x20\x5c)','isLatexOp','\x5cln(\x5cplaceholder{})','\x5ctext{Considerando\x20','<hr>','~~~MATH_','forEach','setAttribute',':\x27,\x20data);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27Plotly\x20Debug:\x20Objeto\x20layout\x20parseado\x20para\x20ID\x20','toFixed','.copy-success','keyboard-symbols','parentNode','.MathJax','\x5cepsilon','Clipboard\x20API\x20no\x20soportada','keyboard-category','\x5cvarsigma','system','virtualKeyboardMode','\x5cnabla','iOS\x20paste\x20failed:','tutor','\x5cplaceholder{}','symbols-btn','warn','\x5cOmega','deepseek-chat','PerformanceObserver','Paste\x20your\x20text:','La\x20conversaci√≥n\x20actual','generateProblemButton','toUpperCase','getAttribute','catch','üéØ\x20Pro\x20Mode\x20Activated!\x20You\x20have\x20','smartMode','\x5clambda','language-','<div\x20class=\x22example-section\x22>','\x5calpha','Bot√≥n\x20','status','pointerdown','data-latex','menuItems','keyboard-algebra','changedTouches','No\x20se\x20encontr√≥\x20#context-menu\x20en\x20el\x20DOM','<h2>$1</h2>','\x5cPsi','className','fa-arrow-alt-circle-up','\x20MB\x20disponibles','toLowerCase','16952067dsDZKK','selectAll','random','pre','Error\x20de\x20MathJax:','===\x20DEBUG\x20DE\x20BOTONES\x20===','\x5cbackspace','\x5cbegin{bmatrix}\x20\x5cplaceholder{}\x20\x5cend{bmatrix}','tbody','Memoria\x20usada:\x20','Enter','chat-bubble\x20bot-content','block','\x20-\x20Clases:','<i\x20class=\x22fas\x20fa-arrow-up\x22></i>','revokeObjectURL','div.plotly','\x5c(\x20\x5csqrt[\x5cboxed{}]{\x5cboxed{}}\x20\x5c)','113610qrGwpb','utf-8','\x5cEpsilon','match','chat-msg\x20','<i\x20class=\x22fas\x20fa-copy\x22></i>','toString','1423189znyblu','input','placeholder','from','paste','active','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22code-lang\x22>','_{\x5cplaceholder{}}','slice','<i\x20class=\x22fas\x20fa-arrow-right\x22></i>','Copiado!','normal','latex-button','\x5cbegin{bmatrix}','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.replace(/\x5cbeval\x5cb|\x5cbnew\x20Function\x5cb/g,\x20\x27\x27)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.replace(/[\x27\x22]graph-container[\x27\x22]/g,\x20\x27','\x5cBeta','\x5crightarrow','highlightAll','undefined','latex','mathMode','\x5cint_{\x5cplaceholder{}}^{\x5cplaceholder{}}\x5cplaceholder{}d\x5cplaceholder{}','<span>abc</span>','Math\x20Pro','removeEventListener','\x5c(\x20\x5cfrac{\x5cboxed{}}{\x5cboxed{}}\x20\x5c)','\x5clog_{\x5cplaceholder{}}(\x5cplaceholder{})','\x20MB\x20de\x20','copy-success','fade-out','lastBotMessage','objectUrls','&lt;/(','querySelector','top','active-mode','pointerType','closest','replace','keydown','1749348bnCyvY','languageToggleButton','https://backend-6eik.onrender.com/chat','error','resolve','<div\x20class=\x22alert-tip\x22><i\x20class=\x22fas\x20fa-lightbulb\x22></i>\x20<strong>Consejo:</strong>\x20$1</div>','then','touchend',':\x27,\x20layout);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20Configuraci√≥n\x20responsive\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20layout.autosize\x20=\x20true;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20layout.margin\x20=\x20layout.margin\x20||\x20{\x20l:\x2050,\x20r:\x2050,\x20b:\x2050,\x20t:\x2050,\x20pad:\x204\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x205.\x20Opcional:\x20A√±adir\x20un\x20peque√±o\x20retraso\x20aqu√≠\x20para\x20ver\x20si\x20es\x20un\x20problema\x20de\x20renderizado\x20del\x20DOM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20setTimeout(()\x20=>\x20{\x20//\x20Descomenta\x20esta\x20l√≠nea\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20Renderizar\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Plotly.newPlot(\x27',',\x20genera\x20un\x20nuevo\x20problema\x20para\x20practicar\x20que\x20sea\x20similar\x20pero\x20no\x20id√©ntico\x20a\x20lo\x20que\x20hemos\x20visto.\x20Proporciona\x20solo\x20el\x20enunciado\x20del\x20problema,\x20sin\x20soluci√≥n.}','<a\x20class=\x22explain-link\x22\x20onclick=\x22explainStep(this)\x22>\x22\x22Ask\x20to\x20Chat</a></div>','data:\x20','__keyboardGlobalClickHandlerInstalled','execCommand','matrix-size-selector','\x20\x5cend{bmatrix}','<span\x20class=\x22math-text\x22>$1</span>','cleanupAllResources\x20‚Üí\x20removed\x20listeners/intervals/observers/workers/objectURLs','chat-bubble','application/json','startTutorExamBtn','has','\x5cAlpha','\x5cfrac{\x5cpartial}{\x5cpartial\x20\x5cplaceholder{}}','<ol>$1</ol>','scrollHeight','Error\x20al\x20pegar:','copy-error','\x0a\x5cend{cases}','\x20\x5c\x5c','\x20left.\x20Slower\x20but\x20more\x20precise\x20for\x20complex\x20problems.','includes','<div\x20class=\x22alert-warning\x22><i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20<strong>¬°Advertencia!</strong>\x20$1</div>','\x5c(\x20\x5cprod\x20\x5c)','body','100XoVVyh','readText','<div\x20class=\x22alert-info\x22><i\x20class=\x22fas\x20fa-info-circle\x22></i>\x20<strong>Informaci√≥n:</strong>\x20$1</div>','renderMath','8tXXGQx','.copy-equation-btn','toggleGreekSymbolsBtn','toggleScientificBtn','\x0aYou\x20are\x20**No√ªs**,\x20an\x20advanced\x20AI\x20assistant\x20specialized\x20in\x20STEM\x20fields.\x20Your\x20primary\x20purpose\x20is\x20to\x20provide\x20explanations\x20with\x20**unrivaled\x20clarity**\x20and\x20**absolute\x20precision**,\x20always\x20maintaining\x20a\x20**professional\x20aesthetic\x20rigor**.\x20You\x20will\x20adapt\x20to\x20the\x20**context\x20and\x20focus**\x20of\x20each\x20query,\x20always\x20being\x20**clear,\x20rigorous,\x20and\x20exhaustive**,\x20without\x20omitting\x20important\x20steps.\x0a\x0a---\x0a\x0a###\x20**Presentation\x20and\x20Formatting\x20Principles**\x0a\x0aFor\x20optimal\x20and\x20visually\x20appealing\x20communication,\x20you\x20will\x20judiciously\x20and\x20contextually\x20use\x20the\x20following\x20tools:\x0a\x0a*\x20**Markdown:**\x20To\x20structure\x20key\x20information\x20(headers,\x20lists)\x20and\x20emphasize\x20content\x20(bold,\x20italics,\x20code\x20blocks).\x0a*\x20**LaTeX:**\x20Crucial\x20for\x20the\x20impeccable\x20presentation\x20of\x20all\x20mathematical\x20and\x20scientific\x20content.\x0a\x20\x20\x20\x20*\x20**MathJax\x20Delimiters:**\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20Inline:\x20\x5c(\x20...\x20\x5c)\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20Display:\x20$$\x20...\x20$$\x20(preferred)\x20or\x20\x5c[\x20...\x20\x5c]\x0a\x20\x20\x20\x20*\x20**Compatible\x20Packages:**\x20ams,\x20boldsymbol,\x20physics.\x0a*\x20**CSS\x20Formatting:**\x20For\x20visual\x20distinction\x20and\x20improved\x20readability\x20(e.g.,\x20highlights,\x20specific\x20blocks).\x0a*\x20**Visual\x20Separators:**\x20Use\x20\x22---\x22\x20between\x20paragraphs\x20to\x20divide\x20content\x20sections\x20or\x20important\x20transitions,\x20improving\x20readability.\x0a*\x20**Use\x20emojis\x20to\x20enhance\x20aesthetics\x20and\x20convey\x20friendliness**\x0a*\x20**End\x20the\x20conversation\x20by\x20inviting\x20or\x20asking\x20a\x20question\x20to\x20continue\x20studying\x20with\x20the\x20student**\x0a\x0a---\x0a\x0a###\x20**Specific\x20Content\x20Structures**\x0a\x0aYou\x20will\x20maintain\x20strict\x20consistency\x20using\x20the\x20following\x20formats\x20for\x20key\x20elements:\x0a\x0a*\x20**Titles:**\x20Only\x20these\x20three\x20levels:\x0a\x20\x20\x20\x20*\x20#\x20Large\x20Title\x0a\x20\x20\x20\x20*\x20##\x20Medium\x20Title\x20(the\x20default\x20title)\x0a\x20\x20\x20\x20*\x20###\x20Light\x20Title\x20(for\x20subtitles)\x0a*\x20**Highlighted\x20Text:**\x0a\x20\x20\x20\x20*\x20<span\x20class=\x22math-text\x22>Keyword</span>\x20for\x20mathematical/scientific\x20terms.\x0a\x20\x20\x20\x20*\x20<span\x20class=\x22highlight\x22>Underlined\x20word</span>\x20for\x20important\x20concepts.\x0a*\x20**Steps:**\x20Use\x20the\x20following\x20format\x20to\x20enclose\x20each\x20relevant\x20step\x20of\x20the\x20solution.\x0a\x20\x20\x20\x20<step>\x0a\x20\x20\x20\x20##\x20Step\x201:\x20Apply\x20the\x20formula\x0a\x20\x20\x20\x20here\x20you\x20put\x20the\x20development\x20of\x20that\x20step\x0a\x20\x20\x20\x20</step>\x0a*\x20**Tables:**\x20Always\x20use\x20the\x20<data-table>\x20format.\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<data-table>\x0a\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<th>Magnitude</th>\x0a\x20\x20\x20\x20<th>Unit</th>\x0a\x20\x20\x20\x20<th>Example\x20Value</th>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Speed</td>\x0a\x20\x20\x20\x20<td>m/s</td>\x0a\x20\x20\x20\x20<td>\x5c(281.6\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Frequency</td>\x0a\x20\x20\x20\x20<td>Hz</td>\x0a\x20\x20\x20\x20<td>\x5c(440\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Length</td>\x0a\x20\x20\x20\x20<td>m</td>\x0a\x20\x20\x20\x20<td>\x5c(0.32\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20</data-table>\x0a\x20\x20\x20\x20```\x0a\x0a---\x0a\x0a###\x20**Handling\x20Code\x20and\x20Graphics**\x0a\x0a*\x20**Code\x20Blocks:**\x20Always\x20in\x20Markdown\x20format.\x20If\x20LaTeX\x20code\x20is\x20explicitly\x20requested,\x20use\x20this\x20format\x20as\x20well.\x0a\x20\x20\x20\x20```python\x0a\x20\x20\x20\x20def\x20calculate_area(radius):\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22\x22\x22Calculates\x20the\x20area\x20of\x20a\x20circle\x22\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x203.1416\x20*\x20radius\x20**\x202\x0a\x0a\x20\x20\x20\x20print(calculate_area(5))\x20\x20#\x20Example\x20usage\x0a\x20\x20\x20\x20```\x0a*\x20**Graphics\x20(only\x20if\x20explicitly\x20requested):**\x20Use\x20the\x20following\x20format,\x20including\x20a\x20brief\x20description\x20in\x20the\x20<plotly-chart>\x20tag.\x0a\x20\x20\x20\x20```plotly-js\x0a\x20\x20\x20\x20//\x20Chart\x20data\x0a\x20\x20\x20\x20const\x20data\x20=\x20[{\x0a\x20\x20\x20\x20\x20\x20x:\x20[\x27Jan\x27,\x20\x27Feb\x27,\x20\x27Mar\x27,\x20\x27Apr\x27],\x0a\x20\x20\x20\x20\x20\x20y:\x20[20,\x2014,\x2025,\x2016],\x0a\x20\x20\x20\x20\x20\x20type:\x20\x27bar\x27,\x0a\x20\x20\x20\x20\x20\x20marker:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20\x27rgb(55,\x2083,\x20109)\x27\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}];\x0a\x0a\x20\x20\x20\x20//\x20Layout\x20configuration\x0a\x20\x20\x20\x20const\x20layout\x20=\x20{\x0a\x20\x20\x20\x20\x20\x20title:\x20\x27Sales\x20by\x20Month\x27,\x0a\x20\x20\x20\x20\x20\x20xaxis:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20title:\x20\x27Month\x27\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20yaxis:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20title:\x20\x27Sales\x20(thousands)\x27\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20margin:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20l:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20r:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20b:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20t:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20pad:\x204\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20};\x0a\x0a\x20\x20\x20\x20//\x20Render\x20the\x20chart\x0a\x20\x20\x20\x20Plotly.newPlot(\x27graph-container\x27,\x20data,\x20layout);\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<plotly-chart>\x0a\x20\x20\x20\x20This\x20bar\x20chart\x20shows\x20monthly\x20sales\x20for\x20the\x20first\x20quarter,\x20with\x20a\x20peak\x20in\x20March\x20followed\x20by\x20a\x20decrease\x20in\x20April.\x0a\x20\x20\x20\x20</plotly-chart>\x0a','innerText','push','.MJXc-math','Tipo\x20de\x20examen\x20seleccionado:','options','manual','\x5comega','observers','10000','\x22\x22Ask\x20to\x20Chat','abs','isLatexSymbol','mainModeToggleButton','querySelectorAll','\x5cTheta','Error\x20de\x20MathJax\x20al\x20renderizar\x20botones:','\x5ctau','\x5c(\x20\x5ctimes\x20\x5c)','chatBox','trig-btn','getValue','\x20\x5c\x5c\x0a','indexOf','105yzhDRA','thead','__mathClickableHandlerInstalled','\x5cLambda','&#039;','.clickable-math-block','style','userInput\x20no\x20es\x20una\x20instancia\x20v√°lida\x20de\x20MathfieldElement','__resourceRegistry','</$1>','<a\x20class=\x22explain-link\x22\x20onclick=\x22explainStep(this)\x22>[Explicaci√≥n]</a></div>','&lt;(','highlightElement','cos','get','<div\x20class=\x22step\x22>','<i\x20class=\x22fas\x20fa-check\x22></i>','\x5cleftarrow','.reasoner-warning','en-active','memory','theoreticalButton','length','7832295HsVZfu','offsetWidth','latex-copy','pre\x20code','<div\x20class=\x22data-table\x22>','\x5cXi','userAgent',')([^&>]*)&gt;','clientX','<i\x20class=\x22fas\x20fa-backspace\x22></i>','left','\x5cbeta','\x5czeta','\x20use','intervals','\x5cpi','66302zEpWtF','MathJax\x20error,\x20retrying...','<div\x20class=\x22code-block\x22\x20data-lang=\x22','decode','backgroundColor','greek','<div\x20class=\x22error-message\x22>‚ö†Ô∏è\x20','Error\x20al\x20copiar:','\x5c(\x20\x5cepsilon\x20\x5cdelta\x20\x5c)','pointerleave','\x5cPhi','touches','Garbage\x20collection\x20forzado','~~~PLOTLY_BLOCK_','\x20(y\x20conceptos\x20relacionados)','removeChild','plotly-','lastUserMessage','~~~','focus','position','bot','\x5cphi','typesetPromise','shift','key','pageX','disabled','\x22\x20class=\x22plotly-graph-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22plotly-loading\x22>Cargando\x20gr√°fico...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<script>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(function()\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20function\x20renderPlotly()\x20{\x20//\x20<--\x20ESTA\x20es\x20la\x20funci√≥n\x20dentro\x20del\x20script\x20que\x20se\x20inyecta\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20container\x20=\x20document.getElementById(\x27','getSelection','json','scrollTop','substring','parse','listeners','currentTopic','<button\x20class=\x22copy-latex-btn\x22\x20onclick=\x22copyLatex(this.parentNode)\x22><i\x20class=\x22fas\x20fa-copy\x22></i></button>','hidden','writeText','\x5cgamma','\x5cint','class','Bot√≥n\x20de\x20idioma:','.ML__placeholder','timeouts','#userInputContainer','touchmove','code','\x5ctext{Basado\x20en\x20','moveToNextChar','hintButton','split','^{\x5cplaceholder{}}','createElement','<em>$1</em>','trim','usedJSHeapSize','default','\x20-\x20','<div\x20class=\x22reference\x22><small><strong>Fuente:</strong>\x20$1</small></div>','<i\x20class=\x27fas\x20fa-check\x27></i>\x20Copy!','fixed','Escape','type','span','\x5cfrac{\x5cplaceholder{}}{\x5cplaceholder{}}','No\x20se\x20encontr√≥\x20el\x20elemento\x20del\x20c√≥digo','pointerup','English','\x5cSigma','No\x20se\x20encontr√≥\x20#userInput\x20en\x20el\x20DOM','filter','__keyboardGlobalClickHandler','-\x20Asistente:\x20','space-button','messages','deleteBackward','\x5cxi','Fallback\x20copy\x20failed:','\x5clim_{\x5cplaceholder{}\x5cto\x5cplaceholder{}}','appendChild','some','isAction','add'];_0x2e55=function(){return _0x59352e;};return _0x2e55();}async function showWelcomeMessage(){const _0x349d11=_0xcf017f,_0x434818=welcomeMessages[currentLanguage]||welcomeMessages['en'],_0x273d19=document[_0x349d11(0x238)](_0x349d11(0xfb)),_0x5dd478=document[_0x349d11(0x15c)](_0x349d11(0x18c));_0x5dd478['className']=_0x349d11(0x216);const _0x46fb60=document[_0x349d11(0x15c)](_0x349d11(0x18c));_0x46fb60[_0x349d11(0x273)]=_0x349d11(0x282),_0x46fb60[_0x349d11(0x234)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-indicator\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-dot\x22\x20style=\x22animation-delay:\x200s\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-dot\x22\x20style=\x22animation-delay:\x200.2s\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-dot\x22\x20style=\x22animation-delay:\x200.4s\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x5dd478[_0x349d11(0x177)](_0x46fb60),_0x273d19[_0x349d11(0x177)](_0x5dd478),_0x273d19['scrollTop']=_0x273d19[_0x349d11(0xd6)],await new Promise(_0x5ef652=>setTimeout(_0x5ef652,0xc8));let _0x3366a8='';for(let _0x3dd947=0x0;_0x3dd947<_0x434818['length'];_0x3dd947++){_0x3366a8+=_0x434818[_0x3dd947],_0x46fb60[_0x349d11(0x234)]=formatBotResponse(_0x3366a8),processNewContent(_0x46fb60),_0x273d19['scrollTop']=_0x273d19[_0x349d11(0xd6)],await new Promise(_0xf94cdf=>setTimeout(_0xf94cdf,0xf));}_0x46fb60[_0x349d11(0x234)]=formatBotResponse(_0x434818),processNewContent(_0x46fb60),_0x273d19[_0x349d11(0x146)]=_0x273d19[_0x349d11(0xd6)];}function debugButtons(){const _0x224692=_0xcf017f;console['log'](_0x224692(0x27c));const _0x486fbc=document['querySelectorAll'](_0x224692(0x1a4));console[_0x224692(0x232)](_0x224692(0x1f9),_0x486fbc[_0x224692(0x116)]),_0x486fbc['forEach']((_0xdaed47,_0x556bf8)=>{const _0x2c32d5=_0x224692;console[_0x2c32d5(0x232)](_0x2c32d5(0x269)+(_0x556bf8+0x1)+':',_0xdaed47['id'],_0xdaed47[_0x2c32d5(0x273)],_0xdaed47[_0x2c32d5(0x239)]);});const _0x57fcea=document['getElementById'](_0x224692(0xbe));console[_0x224692(0x232)](_0x224692(0x151),_0x57fcea),_0x57fcea&&(console[_0x224692(0x232)](_0x224692(0x1dd),_0x57fcea['id']),console[_0x224692(0x232)](_0x224692(0x284),_0x57fcea[_0x224692(0x273)]),console[_0x224692(0x232)]('\x20-\x20Tiene\x20keyboard-category:',_0x57fcea[_0x224692(0x1ad)][_0x224692(0x1e5)](_0x224692(0x250))));}setTimeout(debugButtons,0x3e8);function setupKeyboardButtons(){const _0x26c711=_0xcf017f;document[_0x26c711(0xf6)](_0x26c711(0x1a4))[_0x26c711(0x246)](_0x5435bc=>{const _0x4da602=_0x26c711;_0x5435bc[_0x4da602(0x1b7)](_0x4da602(0x1e7),function(_0x51f8a1){const _0x533240=_0x4da602;_0x51f8a1[_0x533240(0x1d1)]();const _0x253cab=this[_0x533240(0x1ad)]['contains'](_0x533240(0x213))?_0x533240(0x26e):this['classList']['contains']('calculus-btn')?_0x533240(0x1ac):this[_0x533240(0x1ad)][_0x533240(0x1e5)](_0x533240(0x181))?_0x533240(0x18d):this[_0x533240(0x1ad)][_0x533240(0x1e5)](_0x533240(0x258))?_0x533240(0x24b):this[_0x533240(0x1ad)]['contains'](_0x533240(0xfc))?'keyboard-trig':_0x533240(0x1c5);toggleKeyboard(_0x253cab),mathField[_0x533240(0x13a)]();});});}!window[_0xcf017f(0xc9)]&&(window['__keyboardGlobalClickHandlerInstalled']=!![],window['__keyboardGlobalClickHandler']=function(_0x14072d){const _0x21eaf5=_0xcf017f,_0x10c9c6=_0x14072d[_0x21eaf5(0x1cd)][_0x21eaf5(0xba)]('.keyboard-category'),_0x2f0041=_0x14072d[_0x21eaf5(0x1cd)][_0x21eaf5(0xba)](_0x21eaf5(0x1bb)),_0x285a2b=_0x14072d[_0x21eaf5(0x1cd)][_0x21eaf5(0xba)](_0x21eaf5(0x154)),_0x598d5d=_0x14072d[_0x21eaf5(0x1cd)][_0x21eaf5(0xba)]('#customKeyboard');!_0x10c9c6&&!_0x2f0041&&!_0x285a2b&&!_0x598d5d&&closeKeyboard();},typeof registerListener===_0xcf017f(0x1bc)?registerListener(document,_0xcf017f(0x1e7),window[_0xcf017f(0x16f)],![]):document[_0xcf017f(0x1b7)](_0xcf017f(0x1e7),window[_0xcf017f(0x16f)],![]));function toggleKeyboard(_0xf6635c){const _0x26a835=_0xcf017f,_0x3c7dfa=document[_0x26a835(0x238)](_0xf6635c),_0x5a7d61=_0x3c7dfa['classList'][_0x26a835(0x1e5)](_0x26a835(0x295));document[_0x26a835(0xf6)](_0x26a835(0x1bb))['forEach'](_0x1aefe7=>{const _0x2fe1fa=_0x26a835;_0x1aefe7['classList'][_0x2fe1fa(0x1cc)]('active');}),!_0x5a7d61&&(_0x3c7dfa[_0x26a835(0x1ad)][_0x26a835(0x17a)](_0x26a835(0x295)),setTimeout(()=>{const _0x16b57b=_0x26a835,_0x4b49c1=document[_0x16b57b(0x238)](_0x16b57b(0xfb));},0x32));}function closeKeyboard(){const _0x59cb88=_0xcf017f;document['querySelectorAll']('.keyboard-panel')[_0x59cb88(0x246)](_0x51d6b5=>_0x51d6b5[_0x59cb88(0x1ad)][_0x59cb88(0x1cc)](_0x59cb88(0x295)));}function insertSymbol(_0xeb337c){const _0x862d34=_0xcf017f;mathField&&mathField instanceof MathfieldElement&&(mathField[_0x862d34(0x1d6)](_0xeb337c),mathField[_0x862d34(0x13a)]());}function sendLatexToInput(_0x3a66a5){const _0x3b47e3=_0xcf017f;mathField[_0x3b47e3(0x1ab)](''+_0x3a66a5),mathField[_0x3b47e3(0x13a)]();}function insertMatrix(_0x17662a){let _0x35addf='[';for(let _0x58e531=0x0;_0x58e531<_0x17662a;_0x58e531++){_0x35addf+='[';for(let _0x4bfced=0x0;_0x4bfced<_0x17662a;_0x4bfced++){_0x35addf+='m'+(_0x58e531+0x1)+(_0x4bfced+0x1);if(_0x4bfced<_0x17662a-0x1)_0x35addf+=',\x20';}_0x35addf+=']';if(_0x58e531<_0x17662a-0x1)_0x35addf+=',\x20';}_0x35addf+=']',insertSymbol(_0x35addf);}function showCasesSelector(){const _0x269a66=_0xcf017f,_0x46afd0=document['getElementById'](_0x269a66(0x1e2)),_0xf6b1a8=_0x46afd0['querySelector']('.level-grid');_0xf6b1a8[_0x269a66(0x234)]='';for(let _0x19626f=0x1;_0x19626f<=0x6;_0x19626f++){const _0x56600c=document[_0x269a66(0x15c)]('button');_0x56600c['textContent']=_0x19626f+'\x20row'+(_0x19626f>0x1?'s':''),_0x56600c['onclick']=()=>insertCases(_0x19626f),_0xf6b1a8[_0x269a66(0x177)](_0x56600c);}_0x46afd0[_0x269a66(0x106)][_0x269a66(0x1d9)]=_0x269a66(0x283);}function closeCasesSelector(){const _0x62629a=_0xcf017f;document[_0x62629a(0x238)](_0x62629a(0x1e2))[_0x62629a(0x106)][_0x62629a(0x1d9)]=_0x62629a(0x1aa);}function insertCases(_0xca9edc){const _0x597a2f=_0xcf017f;let _0x443b44=_0x597a2f(0x206);for(let _0x2f05b2=0x0;_0x2f05b2<_0xca9edc;_0x2f05b2++){_0x443b44+=_0x597a2f(0x257);if(_0x2f05b2<_0xca9edc-0x1)_0x443b44+=_0x597a2f(0xfe);}_0x443b44+=_0x597a2f(0xd9),insertSymbol(_0x443b44),closeCasesSelector();}function showMatrixSizeSelector(){const _0x15776f=_0xcf017f,_0x8b1c61=document[_0x15776f(0x238)]('matrix-size-selector'),_0x519256=_0x8b1c61[_0x15776f(0xb6)]('.matrix-grid');_0x519256[_0x15776f(0x234)]='';for(let _0x5bcb55=0x1;_0x5bcb55<=0x5;_0x5bcb55++){for(let _0xc7f9ed=0x1;_0xc7f9ed<=0x5;_0xc7f9ed++){const _0x4a8431=document[_0x15776f(0x15c)](_0x15776f(0x200));_0x4a8431['textContent']=_0x5bcb55+'√ó'+_0xc7f9ed,_0x4a8431['onclick']=()=>createMatrix(_0x5bcb55,_0xc7f9ed),_0x519256[_0x15776f(0x177)](_0x4a8431);}}_0x8b1c61['style'][_0x15776f(0x1d9)]='block';}function closeMatrixSelector(){const _0x4bfb40=_0xcf017f;document[_0x4bfb40(0x238)](_0x4bfb40(0xcb))[_0x4bfb40(0x106)]['display']='none';}function createMatrix(_0x5914fa,_0x2e8868){const _0x231f9e=_0xcf017f;closeMatrixSelector();if(_0x5914fa===0x1&&_0x2e8868===0x1){insertSymbol(_0x231f9e(0x27e));return;}let _0x2b23c0=_0x231f9e(0x29d);for(let _0x491971=0x0;_0x491971<_0x5914fa;_0x491971++){for(let _0x4fdbca=0x0;_0x4fdbca<_0x2e8868;_0x4fdbca++){_0x2b23c0+=_0x231f9e(0x1a6);if(_0x4fdbca<_0x2e8868-0x1)_0x2b23c0+='\x20&';}if(_0x491971<_0x5914fa-0x1)_0x2b23c0+=_0x231f9e(0xda);}_0x2b23c0+=_0x231f9e(0xcc),insertSymbol(_0x2b23c0);}document[_0xcf017f(0x1b7)]('DOMContentLoaded',function(){initializeKeyboardButtons();});function showKeyboard(_0x4a3552){toggleKeyboard(_0x4a3552);}function initializeMathLive(){const _0x58a573=_0xcf017f,_0x52cc64=document[_0x58a573(0x238)](_0x58a573(0x22b));if(!_0x52cc64){console[_0x58a573(0xc0)](_0x58a573(0x16d));return;}if(!(_0x52cc64 instanceof MathfieldElement)){console['error'](_0x58a573(0x107));return;}mathField=_0x52cc64,mathField[_0x58a573(0x264)]=!![],mathField['mathMode']=_0x58a573(0x1e4),mathField[_0x58a573(0x253)]=_0x58a573(0xee),mathField[_0x58a573(0x26d)]=[],setupCustomContextMenu(mathField);}function setupCustomContextMenu(_0xa027d6){const _0x3fe915=_0xcf017f,_0x1fc4fc=document['getElementById']('context-menu');if(!_0x1fc4fc){console[_0x3fe915(0xc0)](_0x3fe915(0x270));return;}let _0x27903c;const _0x284834=0x1f4;let _0xe75e7a=![],_0xf7f857=0x0,_0x7da7b9=0x0,_0x3e53d5=![];_0xa027d6[_0x3fe915(0x1b7)](_0x3fe915(0x26b),_0x1e61c1),_0xa027d6[_0x3fe915(0x1b7)](_0x3fe915(0x1e3),_0x56dd12,{'passive':![]}),_0xa027d6[_0x3fe915(0x1b7)](_0x3fe915(0x16a),_0x2ea0d3),_0xa027d6[_0x3fe915(0x1b7)]('touchend',_0x216f7d),_0xa027d6[_0x3fe915(0x1b7)]('pointermove',_0x371242),_0xa027d6['addEventListener'](_0x3fe915(0x155),_0x17b5b2),_0xa027d6[_0x3fe915(0x1b7)](_0x3fe915(0x130),_0x42f3cb),_0xa027d6[_0x3fe915(0x1b7)]('touchcancel',_0x42f3cb);function _0x1e61c1(_0xc260e6){const _0x2fec26=_0x3fe915;if(_0xc260e6[_0x2fec26(0x1cd)]['closest'](_0x2fec26(0x152))){_0x42f3cb();return;}(_0xc260e6['pointerType']===_0x2fec26(0x1f0)||_0xc260e6[_0x2fec26(0xb9)]==='pen')&&(_0x42f3cb(),_0xf7f857=_0xc260e6[_0x2fec26(0x11f)],_0x7da7b9=_0xc260e6[_0x2fec26(0x17b)],_0x3e53d5=![],_0x27903c=setTimeout(()=>{!_0x3e53d5&&_0x48fa6d(_0xc260e6);},_0x284834));}function _0x56dd12(_0x43537a){const _0x51ced6=_0x3fe915;if(_0x43537a[_0x51ced6(0x1cd)][_0x51ced6(0xba)]('.ML__placeholder')){_0x42f3cb();return;}_0x43537a[_0x51ced6(0x1d1)](),_0x27903c(_0x43537a[_0x51ced6(0x132)][0x0]);}function _0x371242(_0x3d4d65){const _0x5a2679=_0x3fe915,_0x43e2a2=_0x3d4d65[_0x5a2679(0x11f)],_0xddf217=_0x3d4d65[_0x5a2679(0x17b)],_0x481277=0x5;(Math[_0x5a2679(0xf3)](_0x43e2a2-_0xf7f857)>_0x481277||Math[_0x5a2679(0xf3)](_0xddf217-_0x7da7b9)>_0x481277)&&(_0x3e53d5=!![]);}function _0x17b5b2(_0x466984){const _0x84437d=_0x3fe915;_0x371242(_0x466984[_0x84437d(0x132)][0x0]);}function _0x2ea0d3(_0x1996f2){_0x42f3cb(),setTimeout(()=>{const _0x2aa6f0=_0x11d0,_0x1103f0=window[_0x2aa6f0(0x144)]();_0x1103f0&&_0x1103f0[_0x2aa6f0(0x28f)]()[_0x2aa6f0(0x116)]>0x0&&_0x48fa6d(_0x1996f2);},0xa);}function _0x216f7d(_0x2d5363){const _0x5af4bf=_0x3fe915;let _0x49b76e=_0x2d5363[_0x5af4bf(0x26f)][0x0];_0x42f3cb(),setTimeout(()=>{const _0x22938c=_0x5af4bf,_0x1e5731=window[_0x22938c(0x144)]();_0x1e5731&&_0x1e5731['toString']()[_0x22938c(0x116)]>0x0&&_0x48fa6d({'clientX':_0x49b76e[_0x22938c(0x11f)],'clientY':_0x49b76e[_0x22938c(0x17b)]});},0xa);}function _0x42f3cb(){_0x27903c&&(clearTimeout(_0x27903c),_0x27903c=null);}function _0x48fa6d(_0x956ab0){const _0x3c9a3b=_0x3fe915;_0x42f3cb(),_0x956ab0['preventDefault'](),_0xe75e7a=!![];const _0x4c9bd3=Math[_0x3c9a3b(0x19a)](_0x956ab0[_0x3c9a3b(0x11f)]||_0x956ab0[_0x3c9a3b(0x132)]&&_0x956ab0[_0x3c9a3b(0x132)][0x0][_0x3c9a3b(0x11f)]||_0x956ab0[_0x3c9a3b(0x141)],window['innerWidth']-_0x1fc4fc[_0x3c9a3b(0x118)]-0xa),_0x59dd9b=Math[_0x3c9a3b(0x19a)](_0x956ab0['clientY']||_0x956ab0[_0x3c9a3b(0x132)]&&_0x956ab0[_0x3c9a3b(0x132)][0x0]['clientY']||_0x956ab0[_0x3c9a3b(0x1ec)],window[_0x3c9a3b(0x22e)]-_0x1fc4fc['offsetHeight']-0xa);_0x1fc4fc['style']['display']=_0x3c9a3b(0x186),_0x1fc4fc['style'][_0x3c9a3b(0x121)]=_0x4c9bd3+'px',_0x1fc4fc[_0x3c9a3b(0x106)][_0x3c9a3b(0xb7)]=_0x59dd9b+'px',_0x1fc4fc['style']['zIndex']=_0x3c9a3b(0xf1);const _0x34b916=_0x5894ac=>{const _0x2d7be4=_0x3c9a3b;!_0x1fc4fc[_0x2d7be4(0x1e5)](_0x5894ac[_0x2d7be4(0x1cd)])&&(_0x2b3bec(),document[_0x2d7be4(0xad)](_0x2d7be4(0x26b),_0x34b916),document[_0x2d7be4(0xad)](_0x2d7be4(0x1e3),_0x34b916));};setTimeout(()=>{const _0xc8232f=_0x3c9a3b;document[_0xc8232f(0x1b7)](_0xc8232f(0x26b),_0x34b916),document[_0xc8232f(0x1b7)](_0xc8232f(0x1e3),_0x34b916,{'passive':![]});},0xa);}function _0x2b3bec(){const _0x3902ff=_0x3fe915;_0x1fc4fc[_0x3902ff(0x106)][_0x3902ff(0x1d9)]='none',_0xe75e7a=![];}window[_0x3fe915(0x192)]=async function(_0x14f56b){const _0xf2bb05=_0x3fe915;try{switch(_0x14f56b){case _0xf2bb05(0x1bd):await _0x5d79bc(),_0x2b3bec();break;case _0xf2bb05(0x294):await _0x4d09c1(),_0x2b3bec();break;case _0xf2bb05(0x278):_0xa027d6[_0xf2bb05(0x202)](_0xf2bb05(0x278));break;}}catch(_0x23ce32){console[_0xf2bb05(0xc0)](_0xf2bb05(0x199),_0x23ce32);}};async function _0x5d79bc(){const _0x458730=_0x3fe915;let _0xa9bd78='';const _0x43cea6=window['getSelection']();_0x43cea6&&_0x43cea6[_0x458730(0x28f)]()?_0xa9bd78=_0x43cea6[_0x458730(0x28f)]():_0xa9bd78=_0xa027d6[_0x458730(0xfd)](_0x458730(0xa8));try{navigator[_0x458730(0x182)]?.[_0x458730(0x14d)]?await navigator['clipboard'][_0x458730(0x14d)](_0xa9bd78):_0x5b99b1(_0xa9bd78);}catch(_0x50c4c1){console[_0x458730(0x259)](_0x458730(0x12e),_0x50c4c1),_0x5b99b1(_0xa9bd78);}}async function _0x4d09c1(){const _0x352cce=_0x3fe915;try{if(navigator[_0x352cce(0x182)]?.[_0x352cce(0xe1)]){const _0x33d2d5=await navigator[_0x352cce(0x182)]['readText']();_0xa027d6[_0x352cce(0x1d6)](_0x33d2d5,{'format':_0x352cce(0xa8)});}else await _0x18f4e3();}catch(_0x4257f4){console[_0x352cce(0x259)](_0x352cce(0xd7),_0x4257f4),await _0x18f4e3();}}function _0x5b99b1(_0x1097b1){const _0x309bf8=_0x3fe915,_0x45288b=document[_0x309bf8(0x15c)]('textarea');_0x45288b[_0x309bf8(0x194)]=_0x1097b1,_0x45288b[_0x309bf8(0x106)]['position']=_0x309bf8(0x164),_0x45288b[_0x309bf8(0x106)][_0x309bf8(0x18f)]=0x0,document[_0x309bf8(0xdf)][_0x309bf8(0x177)](_0x45288b),_0x45288b[_0x309bf8(0x210)]();try{if(!document[_0x309bf8(0xca)](_0x309bf8(0x1bd)))throw new Error(_0x309bf8(0x20f));}catch(_0x4cbb97){console[_0x309bf8(0xc0)](_0x309bf8(0x175),_0x4cbb97);throw new Error(_0x309bf8(0x1ce));}finally{document[_0x309bf8(0xdf)][_0x309bf8(0x136)](_0x45288b);}}async function _0x18f4e3(){const _0x4d31d4=_0x3fe915;if(/iPad|iPhone|iPod/['test'](navigator[_0x4d31d4(0x11d)])){const _0x4b7bef=document[_0x4d31d4(0x15c)](_0x4d31d4(0x291));return _0x4b7bef[_0x4d31d4(0x106)][_0x4d31d4(0x13b)]=_0x4d31d4(0x164),_0x4b7bef['style'][_0x4d31d4(0x18f)]=0x0,_0x4b7bef[_0x4d31d4(0x247)](_0x4d31d4(0x1ca),''),document[_0x4d31d4(0xdf)][_0x4d31d4(0x177)](_0x4b7bef),_0x4b7bef[_0x4d31d4(0x13a)](),new Promise(_0x49e616=>{setTimeout(()=>{const _0x269fb0=_0x11d0;try{if(document[_0x269fb0(0xca)](_0x269fb0(0x294))){const _0x1eaaa4=_0x4b7bef[_0x269fb0(0x194)];if(_0x1eaaa4)_0xa027d6[_0x269fb0(0x1d6)](_0x1eaaa4,{'format':_0x269fb0(0xa8)});}else _0x1410c3();}catch(_0x322e9a){console[_0x269fb0(0xc0)](_0x269fb0(0x255),_0x322e9a),_0x1410c3();}finally{document[_0x269fb0(0xdf)]['removeChild'](_0x4b7bef),_0x49e616();}},0x64);});}else _0x1410c3();}function _0x1410c3(){const _0xe213c7=_0x3fe915,_0xe0ded7=prompt(_0xe213c7(0x25d));if(_0xe0ded7)_0xa027d6[_0xe213c7(0x1d6)](_0xe0ded7,{'format':_0xe213c7(0xa8)});}function _0x4b71cd(_0x10ab9b){const _0x21ef31=_0x3fe915,_0x52daf8=document[_0x21ef31(0x15c)](_0x21ef31(0x18c));_0x52daf8[_0x21ef31(0x273)]='toast-message',_0x52daf8['textContent']=_0x10ab9b,document[_0x21ef31(0xdf)][_0x21ef31(0x177)](_0x52daf8),setTimeout(()=>{const _0x55cdaf=_0x21ef31;_0x52daf8[_0x55cdaf(0x1ad)][_0x55cdaf(0x17a)](_0x55cdaf(0xb2)),setTimeout(()=>_0x52daf8[_0x55cdaf(0x1cc)](),0x12c);},0x7d0);}window['addEventListener']('scroll',_0x2b3bec,{'passive':!![]}),window['addEventListener'](_0x3fe915(0x209),_0x2b3bec);}const systemPrompts={'es':{'normal':_0xcf017f(0x17e),'tutor':'\x0aEres\x20**No√ªs**,\x20un\x20asistente\x20de\x20IA\x20avanzado\x20y\x20especializado\x20en\x20campos\x20STEM.\x20Tu\x20prop√≥sito\x20principal\x20es\x20ofrecer\x20explicaciones\x20con\x20**claridad\x20inigualable**\x20y\x20**precisi√≥n\x20absoluta**,\x20manteniendo\x20siempre\x20un\x20**rigor\x20est√©tico\x20profesional**.\x20Te\x20adaptar√°s\x20al\x20**contexto\x20y\x20foco**\x20de\x20cada\x20consulta,\x20siendo\x20siempre\x20**claro,\x20riguroso\x20y\x20exhaustivo**,\x20sin\x20omitir\x20pasos\x20importantes.\x0a\x0a---\x0a\x0a**MODO\x20ACTUAL:\x20TUTOR**\x0a\x0aEn\x20este\x20modo,\x20tu\x20objetivo\x20principal\x20es\x20**guiar\x20al\x20estudiante\x20hacia\x20la\x20soluci√≥n\x20o\x20el\x20entendimiento,\x20no\x20proporcionar\x20la\x20respuesta\x20completa\x20directamente**.\x20Utilizar√°s\x20preguntas,\x20sugerencias\x20y\x20desgloses\x20de\x20conceptos\x20para\x20fomentar\x20el\x20pensamiento\x20cr√≠tico\x20y\x20la\x20auto-descubierta.\x0a\x0a**No\x20das\x20respuestas\x20completas:\x20Solo\x20si\x20el\x20estudiante\x20solicita\x20ayuda\x20expl√≠citamente\x20m√°s\x20de\x20una\x20vez\x20sobre\x20la\x20misma\x20cuesti√≥n\x20(o\x20si\x20su\x20progreso\x20se\x20estanca\x20significativamente\x20despu√©s\x20de\x20tu\x20gu√≠a\x20inicial),\x20entonces\x20deber√°s\x20ofrecer\x20una\x20explicaci√≥n\x20m√°s\x20detallada\x20o\x20la\x20respuesta\x20completa,\x20siempre\x20justificando\x20tu\x20razonamiento.**\x0a\x0aTu\x20tono\x20ser√°\x20siempre\x20profesional,\x20paciente\x20y\x20alentador.\x0a\x0a---\x0a\x0a###\x20**Principios\x20de\x20Presentaci√≥n\x20y\x20Formato**\x0a\x0aPara\x20una\x20comunicaci√≥n\x20√≥ptima\x20y\x20visualmente\x20atractiva,\x20utilizar√°s\x20las\x20siguientes\x20herramientas\x20de\x20forma\x20juiciosa\x20y\x20contextualmente\x20relevante:\x0a\x0a*\x20**Markdown:**\x20Para\x20estructurar\x20la\x20informaci√≥n\x20clave\x20(encabezados,\x20listas)\x20y\x20enfatizar\x20el\x20contenido\x20(negritas,\x20cursivas,\x20bloques\x20de\x20c√≥digo).\x0a*\x20**LaTeX:**\x20Crucial\x20para\x20la\x20presentaci√≥n\x20impecable\x20de\x20todo\x20contenido\x20matem√°tico\x20y\x20cient√≠fico.\x0a\x20\x20\x20\x20*\x20**Delimitadores\x20MathJax:**\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20Inline:\x20\x5c(\x20...\x20\x5c)\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20Display:\x20$$\x20...\x20$$\x20(preferido)\x20o\x20\x5c[\x20...\x20\x5c]\x0a\x20\x20\x20\x20*\x20**Paquetes\x20compatibles:**\x20ams,\x20boldsymbol,\x20physics.\x0a*\x20**Formato\x20CSS:**\x20Para\x20distinci√≥n\x20visual\x20y\x20legibilidad\x20mejorada\x20(ej.\x20resaltados,\x20bloques\x20espec√≠ficos).\x0a*\x20**Separadores\x20Visuales:**\x20Emplea\x20\x22---\x22\x20entre\x20los\x20parrafos\x20para\x20dividir\x20secciones\x20de\x20contenido\x20o\x20transiciones\x20importantes,\x20mejorando\x20la\x20legibilidad.\x0a*\x20**Usa\x20emojis\x20para\x20mejorar\x20la\x20estetica\x20y\x20transmitir\x20cercania**\x0a*\x20**Termina\x20la\x20converzacion\x20haciendo\x20una\x20invitacion\x20o\x20pregunta\x20para\x20continuar\x20estudiando\x20con\x20el\x20estudiante**\x0a\x0a---\x0a\x0a###\x20**Estructuras\x20de\x20Contenido\x20Espec√≠ficas**\x0a\x0aMantendr√°s\x20una\x20consistencia\x20estricta\x20usando\x20los\x20siguientes\x20formatos\x20para\x20elementos\x20clave:\x0a\x0a*\x20**T√≠tulos:**\x20Solo\x20estos\x20tres\x20niveles:\x0a\x20\x20\x20\x20*\x20#\x20T√≠tulo\x20grande\x0a\x20\x20\x20\x20*\x20##\x20T√≠tulo\x20mediano\x20(el\x20t√≠tulo\x20por\x20defecto)\x0a\x20\x20\x20\x20*\x20###\x20T√≠tulo\x20ligero\x20(para\x20subt√≠tulos)\x0a*\x20**Texto\x20Resaltado:**\x0a\x20\x20\x20\x20*\x20<span\x20class=\x22math-text\x22>Palabra\x20clave</span>\x20para\x20t√©rminos\x20matem√°ticos/cient√≠ficos.\x0a\x20\x20\x20\x20*\x20<span\x20class=\x22highlight\x22>Palabra\x20subrayada</span>\x20para\x20conceptos\x20importantes.\x0a*\x20**Alertas:**\x0a\x20\x20\x20\x20Para\x20mejorar\x20la\x20experiencia\x20de\x20aprendizaje,\x20puedes\x20utilizar\x20las\x20siguientes\x20etiquetas\x20HTML\x20personalizadas\x20para\x20a√±adir\x20alertas\x20visuales\x20en\x20tus\x20respuestas\x20cuando\x20sea\x20apropiado.\x20**√ösalas\x20con\x20moderaci√≥n\x20y\x20solo\x20cuando\x20a√±adan\x20valor\x20significativo.**\x0a\x20\x20\x20\x20*\x20<alert-success>\x20Mensaje\x20de\x20felicitaci√≥n\x20o\x20confirmaci√≥n\x20de\x20un\x20paso\x20correcto.\x20**Ejemplo:**\x20<alert-success>¬°Excelente!\x20Has\x20identificado\x20correctamente\x20el\x20primer\x20paso.</alert-success>\x0a\x20\x20\x20\x20*\x20<alert-tip>\x20Consejos,\x20trucos\x20o\x20sugerencias\x20para\x20abordar\x20un\x20problema\x20o\x20mejorar\x20una\x20comprensi√≥n.\x20**Ejemplo:**\x20<alert-tip>Un\x20buen\x20consejo\x20es\x20siempre\x20revisar\x20tus\x20unidades\x20antes\x20de\x20proceder\x20con\x20los\x20c√°lculos.</alert-tip>\x0a\x20\x20\x20\x20*\x20<alert-warning>\x20Mensajes\x20de\x20precauci√≥n,\x20para\x20se√±alar\x20errores\x20comunes\x20o\x20puntos\x20donde\x20se\x20debe\x20tener\x20especial\x20cuidado.\x20**Ejemplo:**\x20<alert-warning>Ten\x20cuidado\x20de\x20no\x20confundir\x20la\x20aceleraci√≥n\x20con\x20la\x20velocidad;\x20son\x20conceptos\x20distintos.</alert-warning>\x0a\x20\x20\x20\x20*\x20<alert-info>\x20Para\x20datos\x20curiosos,\x20informaci√≥n\x20hist√≥rica\x20o\x20contexto\x20adicional\x20que\x20enriquezca\x20el\x20aprendizaje,\x20pero\x20no\x20sea\x20parte\x20directa\x20de\x20la\x20soluci√≥n.\x20**Ejemplo:**\x20<alert-info>¬øSab√≠as\x20que\x20la\x20notaci√≥n\x20de\x20integraci√≥n\x20fue\x20introducida\x20por\x20Gottfried\x20Wilhelm\x20Leibniz\x20en\x20el\x20siglo\x20XVII?</alert-info>\x0a\x20\x20\x20\x20Aseg√∫rate\x20de\x20cerrar\x20siempre\x20la\x20etiqueta\x20de\x20alerta\x20correspondiente.\x0a*\x20**Definiciones:**\x20Envuelve\x20completamente\x20en\x20un\x20bloque\x20<definition>.\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<definition>\x0a\x20\x20\x20\x20##\x20Definici√≥n\x20de\x20Funci√≥n\x20Lineal\x0a\x20\x20\x20\x20Una\x20<span\x20class=\x22math-text\x22>funci√≥n\x20lineal</span>\x20es\x20una\x20funci√≥n\x20polin√≥mica\x20de\x20primer\x20grado,\x20es\x20decir,\x20una\x20funci√≥n\x20cuya\x20representaci√≥n\x20en\x20el\x20plano\x20cartesiano\x20es\x20una\x20l√≠nea\x20recta.\x20Se\x20puede\x20escribir\x20como:\x0a\x20\x20\x20\x20$$f(x)\x20=\x20mx\x20+\x20b$$\x0a\x20\x20\x20\x20Donde\x20\x5c(m\x5c)\x20es\x20la\x20<span\x20class=\x22important\x22>pendiente</span>\x20y\x20\x5c(b\x5c)\x20es\x20la\x20<span\x20class=\x22important\x22>intersecci√≥n\x20con\x20el\x20eje\x20Y</span>.\x0a\x20\x20\x20\x20</definition>\x0a\x20\x20\x20\x20```\x0a*\x20**Ejemplos:**\x20Envuelve\x20completamente\x20en\x20un\x20bloque\x20<example-section>.\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<example-section>\x0a\x20\x20\x20\x20##\x20Problema\x20de\x20la\x20Cuerda\x20Vibrante:\x0a\x20\x20\x20\x20Una\x20cuerda\x20de\x20viol√≠n\x20vibra\x20con\x20una\x20frecuencia\x20fundamental\x20de\x20\x5c(440\x20\x5ctext{\x20Hz}\x5c).\x20Si\x20la\x20longitud\x20de\x20la\x20cuerda\x20es\x20de\x20\x5c(0.32\x20\x5ctext{\x20m}\x5c),\x20¬øcu√°l\x20es\x20la\x20velocidad\x20de\x20las\x20ondas\x20en\x20la\x20cuerda?\x0a\x20\x20\x20\x20</example-section>\x0a\x20\x20\x20\x20```\x0a*\x20**Tablas:**\x20Usa\x20siempre\x20el\x20formato\x20<data-table>.\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<data-table>\x0a\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<th>Magnitud</th>\x0a\x20\x20\x20\x20<th>Unidad</th>\x0a\x20\x20\x20\x20<th>Valor\x20Ejemplo</th>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Velocidad</td>\x0a\x20\x20\x20\x20<td>m/s</td>\x0a\x20\x20\x20\x20<td>\x5c(281.6\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Frecuencia</td>\x0a\x20\x20\x20\x20<td>Hz</td>\x0a\x20\x20\x20\x20<td>\x5c(440\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Longitud</td>\x0a\x20\x20\x20\x20<td>m</td>\x0a\x20\x20\x20\x20<td>\x5c(0.32\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20</data-table>\x0a\x20\x20\x20\x20```\x0a\x0a---\x0a\x0a###\x20**Manejo\x20de\x20C√≥digo\x20y\x20Gr√°ficos**\x0a\x0a*\x20**Bloques\x20de\x20C√≥digo:**\x20Siempre\x20en\x20formato\x20Markdown.\x20Si\x20se\x20solicita\x20c√≥digo\x20LaTeX\x20expl√≠citamente,\x20usa\x20tambi√©n\x20este\x20formato.\x0a\x20\x20\x20\x20```python\x0a\x20\x20\x20\x20def\x20calcular_area(radio):\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22\x22\x22Calcula\x20el\x20√°rea\x20de\x20un\x20c√≠rculo\x22\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x203.1416\x20*\x20radio\x20**\x202\x0a\x0a\x20\x20\x20\x20print(calcular_area(5))\x20\x20#\x20Ejemplo\x20de\x20uso\x0a\x20\x20\x20\x20```\x0a*\x20**Gr√°ficos\x20(solo\x20si\x20se\x20solicitan\x20expl√≠citamente):**\x20Utiliza\x20el\x20siguiente\x20formato,\x20incluyendo\x20una\x20breve\x20descripci√≥n\x20en\x20la\x20etiqueta\x20<plotly-chart>.\x0a\x20\x20\x20\x20```plotly-js\x0a\x20\x20\x20\x20//\x20Datos\x20del\x20gr√°fico\x0a\x20\x20\x20\x20const\x20data\x20=\x20[{\x0a\x20\x20\x20\x20\x20\x20x:\x20[\x27Ene\x27,\x20\x27Feb\x27,\x20\x27Mar\x27,\x20\x27Abr\x27],\x0a\x20\x20\x20\x20\x20\x20y:\x20[20,\x2014,\x2025,\x2016],\x0a\x20\x20\x20\x20\x20\x20type:\x20\x27bar\x27,\x0a\x20\x20\x20\x20\x20\x20marker:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20\x27rgb(55,\x2083,\x20109)\x27\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}];\x0a\x0a\x20\x20\x20\x20//\x20Configuraci√≥n\x20del\x20layout\x0a\x20\x20\x20\x20const\x20layout\x20=\x20{\x0a\x20\x20\x20\x20\x20\x20title:\x20\x27Ventas\x20por\x20Mes\x27,\x0a\x20\x20\x20\x20\x20\x20xaxis:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20title:\x20\x27Mes\x27\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20yaxis:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20title:\x20\x27Ventas\x20(miles)\x27\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20margin:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20l:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20r:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20b:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20t:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20pad:\x204\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20};\x0a\x0a\x20\x20\x20\x20//\x20Renderizar\x20el\x20gr√°fico\x0a\x20\x20\x20\x20Plotly.newPlot(\x27graph-container\x27,\x20data,\x20layout);\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<plotly-chart>\x0a\x20\x20\x20\x20Este\x20gr√°fico\x20de\x20barras\x20muestra\x20las\x20ventas\x20mensuales\x20del\x20primer\x20trimestre,\x20donde\x20se\x20observa\x20un\x20pico\x20en\x20marzo\x20seguido\x20de\x20una\x20disminuci√≥n\x20en\x20abril.\x0a\x20\x20\x20\x20</plotly-chart>\x0a'},'en':{'normal':_0xcf017f(0xe8),'tutor':'\x0aYou\x20are\x20**No√ªs**,\x20an\x20advanced\x20AI\x20assistant\x20specialized\x20in\x20STEM\x20fields.\x20Your\x20primary\x20purpose\x20is\x20to\x20provide\x20explanations\x20with\x20**unrivaled\x20clarity**\x20and\x20**absolute\x20precision**,\x20always\x20maintaining\x20a\x20**professional\x20aesthetic\x20rigor**.\x20You\x20will\x20adapt\x20to\x20the\x20**context\x20and\x20focus**\x20of\x20each\x20query,\x20always\x20being\x20**clear,\x20rigorous,\x20and\x20exhaustive**,\x20without\x20omitting\x20important\x20steps.\x0a\x0a---\x0a\x0a**CURRENT\x20MODE:\x20TUTOR**\x0a\x0aIn\x20this\x20mode,\x20your\x20main\x20objective\x20is\x20to\x20**guide\x20the\x20student\x20toward\x20the\x20solution\x20or\x20understanding,\x20not\x20to\x20provide\x20the\x20complete\x20answer\x20directly**.\x20You\x20will\x20use\x20questions,\x20suggestions,\x20and\x20concept\x20breakdowns\x20to\x20foster\x20critical\x20thinking\x20and\x20self-discovery.\x0a\x0a**Do\x20not\x20provide\x20full\x20answers:\x20Only\x20if\x20the\x20student\x20explicitly\x20asks\x20for\x20help\x20more\x20than\x20once\x20on\x20the\x20same\x20issue\x20(or\x20if\x20their\x20progress\x20significantly\x20stalls\x20after\x20your\x20initial\x20guidance),\x20then\x20you\x20should\x20offer\x20a\x20more\x20detailed\x20explanation\x20or\x20the\x20complete\x20answer,\x20always\x20justifying\x20your\x20reasoning.**\x0a\x0aYour\x20tone\x20will\x20always\x20be\x20professional,\x20patient,\x20and\x20encouraging.\x0a\x0a---\x0a\x0a###\x20**Presentation\x20and\x20Formatting\x20Principles**\x0a\x0aFor\x20optimal\x20and\x20visually\x20appealing\x20communication,\x20you\x20will\x20judiciously\x20and\x20contextually\x20use\x20the\x20following\x20tools:\x0a\x0a*\x20**Markdown:**\x20To\x20structure\x20key\x20information\x20(headers,\x20lists)\x20and\x20emphasize\x20content\x20(bold,\x20italics,\x20code\x20blocks).\x0a*\x20**LaTeX:**\x20Crucial\x20for\x20the\x20impeccable\x20presentation\x20of\x20all\x20mathematical\x20and\x20scientific\x20content.\x0a\x20\x20\x20\x20*\x20**MathJax\x20Delimiters:**\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20Inline:\x20\x5c(\x20...\x20\x5c)\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20Display:\x20$$\x20...\x20$$\x20(preferred)\x20or\x20\x5c[\x20...\x20\x5c]\x0a\x20\x20\x20\x20*\x20**Compatible\x20Packages:**\x20ams,\x20boldsymbol,\x20physics.\x0a*\x20**CSS\x20Formatting:**\x20For\x20visual\x20distinction\x20and\x20improved\x20readability\x20(e.g.,\x20highlights,\x20specific\x20blocks).\x0a*\x20**Visual\x20Separators:**\x20Use\x20\x22---\x22\x20between\x20paragraphs\x20to\x20divide\x20content\x20sections\x20or\x20important\x20transitions,\x20improving\x20readability.\x0a*\x20**Use\x20emojis\x20to\x20enhance\x20aesthetics\x20and\x20convey\x20friendliness**\x0a*\x20**End\x20the\x20conversation\x20by\x20inviting\x20or\x20asking\x20a\x20question\x20to\x20continue\x20studying\x20with\x20the\x20student**\x0a\x0a---\x0a\x0a###\x20**Specific\x20Content\x20Structures**\x0a\x0aYou\x20will\x20maintain\x20strict\x20consistency\x20using\x20the\x20following\x20formats\x20for\x20key\x20elements:\x0a\x0a*\x20**Titles:**\x20Only\x20these\x20three\x20levels:\x0a\x20\x20\x20\x20*\x20#\x20Large\x20Title\x0a\x20\x20\x20\x20*\x20##\x20Medium\x20Title\x20(the\x20default\x20title)\x0a\x20\x20\x20\x20*\x20###\x20Light\x20Title\x20(for\x20subtitles)\x0a*\x20**Highlighted\x20Text:**\x0a\x20\x20\x20\x20*\x20<span\x20class=\x22math-text\x22>Keyword</span>\x20for\x20mathematical/scientific\x20terms.\x0a\x20\x20\x20\x20*\x20<span\x20class=\x22highlight\x22>Underlined\x20word</span>\x20for\x20important\x20concepts.\x0a*\x20**Alerts:**\x0a\x20\x20\x20\x20To\x20enhance\x20the\x20learning\x20experience,\x20you\x20can\x20use\x20the\x20following\x20custom\x20HTML\x20tags\x20to\x20add\x20visual\x20alerts\x20to\x20your\x20responses\x20when\x20appropriate.\x20**Use\x20them\x20sparingly\x20and\x20only\x20when\x20they\x20add\x20significant\x20value.**\x0a\x20\x20\x20\x20*\x20<alert-success>\x20A\x20congratulatory\x20message\x20or\x20confirmation\x20of\x20a\x20correct\x20step.\x20**Example:**\x20<alert-success>Excellent!\x20You\x20have\x20correctly\x20identified\x20the\x20first\x20step.</alert-success>\x0a\x20\x20\x20\x20*\x20<alert-tip>\x20Tips,\x20tricks,\x20or\x20suggestions\x20for\x20approaching\x20a\x20problem\x20or\x20improving\x20understanding.\x20**Example:**\x20<alert-tip>A\x20good\x20tip\x20is\x20to\x20always\x20check\x20your\x20units\x20before\x20proceeding\x20with\x20calculations.</alert-tip>\x0a\x20\x20\x20\x20*\x20<alert-warning>\x20Cautionary\x20messages,\x20to\x20point\x20out\x20common\x20errors\x20or\x20areas\x20where\x20special\x20care\x20is\x20needed.\x20**Example:**\x20<alert-warning>Be\x20careful\x20not\x20to\x20confuse\x20acceleration\x20with\x20velocity;\x20they\x20are\x20distinct\x20concepts.</alert-warning>\x0a\x20\x20\x20\x20*\x20<alert-info>\x20For\x20fun\x20facts,\x20historical\x20information,\x20or\x20additional\x20context\x20that\x20enriches\x20learning\x20but\x20is\x20not\x20a\x20direct\x20part\x20of\x20the\x20solution.\x20**Example:**\x20<alert-info>Did\x20you\x20know\x20that\x20integral\x20notation\x20was\x20introduced\x20by\x20Gottfried\x20Wilhelm\x20Leibniz\x20in\x20the\x2017th\x20century?</alert-info>\x0a\x20\x20\x20\x20Always\x20make\x20sure\x20to\x20close\x20the\x20corresponding\x20alert\x20tag.\x0a*\x20**Definitions:**\x20Fully\x20wrap\x20in\x20a\x20<definition>\x20block.\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<definition>\x0a\x20\x20\x20\x20##\x20Definition\x20of\x20a\x20Linear\x20Function\x0a\x20\x20\x20\x20A\x20<span\x20class=\x22math-text\x22>linear\x20function</span>\x20is\x20a\x20first-degree\x20polynomial\x20function,\x20meaning\x20a\x20function\x20whose\x20representation\x20on\x20the\x20Cartesian\x20plane\x20is\x20a\x20straight\x20line.\x20It\x20can\x20be\x20written\x20as:\x0a\x20\x20\x20\x20$$f(x)\x20=\x20mx\x20+\x20b$$\x0a\x20\x20\x20\x20Where\x20\x5c(m\x5c)\x20is\x20the\x20<span\x20class=\x22important\x22>slope</span>\x20and\x20\x5c(b\x5c)\x20is\x20the\x20<span\x20class=\x22important\x22>Y-intercept</span>.\x0a\x20\x20\x20\x20</definition>\x0a\x20\x20\x20\x20```\x0a*\x20**Examples:**\x20Fully\x20wrap\x20in\x20an\x20<example-section>\x20block.\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<example-section>\x0a\x20\x20\x20\x20##\x20Vibrating\x20String\x20Problem:\x0a\x20\x20\x20\x20A\x20violin\x20string\x20vibrates\x20with\x20a\x20fundamental\x20frequency\x20of\x20\x5c(440\x20\x5ctext{\x20Hz}\x5c).\x20If\x20the\x20length\x20of\x20the\x20string\x20is\x20\x5c(0.32\x20\x5ctext{\x20m}\x5c),\x20what\x20is\x20the\x20speed\x20of\x20the\x20waves\x20on\x20the\x20string?\x0a\x20\x20\x20\x20</example-section>\x0a\x20\x20\x20\x20```\x0a*\x20**Tables:**\x20Always\x20use\x20the\x20<data-table>\x20format.\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<data-table>\x0a\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<th>Magnitude</th>\x0a\x20\x20\x20\x20<th>Unit</th>\x0a\x20\x20\x20\x20<th>Example\x20Value</th>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Speed</td>\x0a\x20\x20\x20\x20<td>m/s</td>\x0a\x20\x20\x20\x20<td>\x5c(281.6\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Frequency</td>\x0a\x20\x20\x20\x20<td>Hz</td>\x0a\x20\x20\x20\x20<td>\x5c(440\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20<td>Length</td>\x0a\x20\x20\x20\x20<td>m</td>\x0a\x20\x20\x20\x20<td>\x5c(0.32\x5c)</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20</data-table>\x0a\x20\x20\x20\x20```\x0a\x0a---\x0a\x0a###\x20**Handling\x20Code\x20and\x20Graphics**\x0a\x0a*\x20**Code\x20Blocks:**\x20Always\x20in\x20Markdown\x20format.\x20If\x20LaTeX\x20code\x20is\x20explicitly\x20requested,\x20use\x20this\x20format\x20as\x20well.\x0a\x20\x20\x20\x20```python\x0a\x20\x20\x20\x20def\x20calculate_area(radius):\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22\x22\x22Calculates\x20the\x20area\x20of\x20a\x20circle\x22\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x203.1416\x20*\x20radius\x20**\x202\x0a\x0a\x20\x20\x20\x20print(calculate_area(5))\x20\x20#\x20Example\x20usage\x0a\x20\x20\x20\x20```\x0a*\x20**Graphics\x20(only\x20if\x20explicitly\x20requested):**\x20Use\x20the\x20following\x20format,\x20including\x20a\x20brief\x20description\x20in\x20the\x20<plotly-chart>\x20tag.\x0a\x20\x20\x20\x20```plotly-js\x0a\x20\x20\x20\x20//\x20Chart\x20data\x0a\x20\x20\x20\x20const\x20data\x20=\x20[{\x0a\x20\x20\x20\x20\x20\x20x:\x20[\x27Jan\x27,\x20\x27Feb\x27,\x20\x27Mar\x27,\x20\x27Apr\x27],\x0a\x20\x20\x20\x20\x20\x20y:\x20[20,\x2014,\x2025,\x2016],\x0a\x20\x20\x20\x20\x20\x20type:\x20\x27bar\x27,\x0a\x20\x20\x20\x20\x20\x20marker:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20\x27rgb(55,\x2083,\x20109)\x27\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}];\x0a\x0a\x20\x20\x20\x20//\x20Layout\x20configuration\x0a\x20\x20\x20\x20const\x20layout\x20=\x20{\x0a\x20\x20\x20\x20\x20\x20title:\x20\x27Sales\x20by\x20Month\x27,\x0a\x20\x20\x20\x20\x20\x20xaxis:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20title:\x20\x27Month\x27\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20yaxis:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20title:\x20\x27Sales\x20(thousands)\x27\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20margin:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20l:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20r:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20b:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20t:\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20pad:\x204\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20};\x0a\x0a\x20\x20\x20\x20//\x20Render\x20the\x20chart\x0a\x20\x20\x20\x20Plotly.newPlot(\x27graph-container\x27,\x20data,\x20layout);\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20<plotly-chart>\x0a\x20\x20\x20\x20This\x20bar\x20chart\x20shows\x20monthly\x20sales\x20for\x20the\x20first\x20quarter,\x20with\x20a\x20peak\x20in\x20March\x20followed\x20by\x20a\x20decrease\x20in\x20April.\x0a\x20\x20\x20\x20</plotly-chart>\x0a'}};async function queryDeepSeekAPI(_0x574e64,_0x5b67ba,_0x44a9af){const _0x34003c=_0xcf017f,_0x28c5b4=isMathTutorMode?_0x34003c(0x256):_0x34003c(0x29b),_0x20834c=systemPrompts[currentLanguage]?.[_0x28c5b4]||systemPrompts['en'][_0x28c5b4],_0x7cfaac=await fetch(_0x34003c(0xbf),{'method':'POST','headers':{'Content-Type':_0x34003c(0xd0)},'body':JSON[_0x34003c(0x1b8)]({'model':currentModel,'messages':[{'role':_0x34003c(0x252),'content':_0x20834c},{'role':'user','content':_0x574e64}],'temperature':isMathTutorMode?0.2:0.3,'max_tokens':0x800,'stream':!![]})});if(!_0x7cfaac['ok']){const _0x318f3c=await _0x7cfaac[_0x34003c(0x145)]()[_0x34003c(0x262)](()=>({}));throw new Error('Error\x20'+_0x7cfaac[_0x34003c(0x26a)]+':\x20'+_0x7cfaac[_0x34003c(0x22c)]+'.\x20'+(_0x318f3c[_0x34003c(0x19e)]||''));}let _0x41b722='',_0x14fa6b='',_0x288432=Date[_0x34003c(0x221)](),_0x19e57f='';try{const _0x57a336=_0x7cfaac[_0x34003c(0xdf)]['getReader'](),_0x1dcdec=new TextDecoder(_0x34003c(0x28a));while(!![]){const {done:_0x55d356,value:_0x382f59}=await _0x57a336['read']();if(_0x55d356)break;_0x19e57f+=_0x1dcdec[_0x34003c(0x12a)](_0x382f59,{'stream':!![]});const _0x17aebf=_0x19e57f['split']('\x0a');_0x19e57f=_0x17aebf[_0x34003c(0x1ef)]();for(const _0x3d3c29 of _0x17aebf){if(!_0x3d3c29[_0x34003c(0x15e)]())continue;if(_0x3d3c29[_0x34003c(0x1c6)]('data:\x20')){const _0x171001=_0x3d3c29[_0x34003c(0xbb)](_0x34003c(0xc8),'');if(_0x171001==='[DONE]'){if(_0x44a9af)_0x44a9af(_0x41b722);return _0x41b722;}try{const _0x574d29=JSON[_0x34003c(0x148)](_0x171001),_0x643bc1=_0x574d29[_0x34003c(0x22d)]?.[0x0]?.[_0x34003c(0x19c)]?.['content']||'';_0x643bc1&&(_0x41b722+=_0x643bc1,_0x14fa6b+=_0x643bc1);}catch(_0x33fb92){console[_0x34003c(0x259)]('Stream\x20parse\x20error:',_0x33fb92,_0x3d3c29);}}}if(Date[_0x34003c(0x221)]()-_0x288432>0x190&&_0x14fa6b[_0x34003c(0x116)]>0x0){if(_0x5b67ba)_0x5b67ba(_0x41b722);_0x14fa6b='',_0x288432=Date[_0x34003c(0x221)]();}}_0x14fa6b[_0x34003c(0x116)]>0x0&&_0x5b67ba&&_0x5b67ba(_0x41b722);if(_0x44a9af)_0x44a9af(_0x41b722);return _0x41b722;}catch(_0x353c48){throw new Error(_0x34003c(0x23d)+_0x353c48[_0x34003c(0x19e)]);}}async function sendMessage(){const _0x1b76e7=_0xcf017f;closeCustomKeyboard();const _0xc804ea=mathField[_0x1b76e7(0xfd)]()[_0x1b76e7(0x15e)]();if(!_0xc804ea)return;appendMessage(_0x1b76e7(0x1d5),_0xc804ea,{'renderMath':![]}),appendMessage(_0x1b76e7(0x1d5),_0xc804ea,{'renderMath':!![]}),mathField[_0x1b76e7(0x1ab)](''),mathField[_0x1b76e7(0x13a)]();const _0x59a14a=document[_0x1b76e7(0x238)](_0x1b76e7(0xfb)),_0x288e4e=document[_0x1b76e7(0x15c)](_0x1b76e7(0x18c));_0x288e4e['className']=_0x1b76e7(0x216);const _0x26dac2=document[_0x1b76e7(0x15c)]('div');_0x26dac2[_0x1b76e7(0x273)]='chat-bubble\x20bot-content',_0x26dac2[_0x1b76e7(0x234)]=_0x1b76e7(0x23e),_0x288e4e[_0x1b76e7(0x177)](_0x26dac2),_0x59a14a['appendChild'](_0x288e4e),_0x59a14a[_0x1b76e7(0x146)]=_0x59a14a[_0x1b76e7(0xd6)];try{const _0x1778d6=getContextPrompt(),_0x196c98=_0xc804ea+_0x1778d6,_0x4d3470=_0x196c98[_0x1b76e7(0x276)]()[_0x1b76e7(0x15e)]();if(responseCache[_0x1b76e7(0xd2)](_0x4d3470)){const _0x21685e=responseCache[_0x1b76e7(0x10e)](_0x4d3470);_0x26dac2['innerHTML']=formatBotResponse(_0x21685e),processNewContent(_0x26dac2),updateContext(_0xc804ea,_0x21685e);return;}await queryDeepSeekAPI(_0x196c98,_0x369fdc=>{const _0x362bfd=_0x1b76e7;_0x26dac2[_0x362bfd(0x234)]=formatBotResponseLite(_0x369fdc),window[_0x362bfd(0x1bf)]&&MathJax[_0x362bfd(0x13e)]([_0x26dac2])[_0x362bfd(0x262)](()=>{}),_0x59a14a['scrollTop']=_0x59a14a[_0x362bfd(0xd6)];},_0x5915be=>{const _0x281535=_0x1b76e7;_0x26dac2[_0x281535(0x234)]=formatBotResponse(_0x5915be),processNewContent(_0x26dac2),responseCache[_0x281535(0x222)](_0x4d3470,_0x5915be),updateContext(_0xc804ea,_0x5915be),_0x59a14a['scrollTop']=_0x59a14a[_0x281535(0xd6)];});}catch(_0x126467){_0x26dac2['innerHTML']=_0x1b76e7(0x12d)+escapeHtml(_0x126467[_0x1b76e7(0x19e)])+_0x1b76e7(0x1ee),_0x59a14a[_0x1b76e7(0x146)]=_0x59a14a[_0x1b76e7(0xd6)];}}function formatBotResponseLite(_0x20a65e){const _0x285318=_0xcf017f;if(!_0x20a65e)return'';_0x20a65e=_0x20a65e[_0x285318(0xbb)](/(^|[^\\])\$([^\$]+?)\$/g,(_0x547289,_0x13eaee,_0x2e45c7)=>_0x13eaee+'\x5c('+_0x2e45c7+'\x5c)'),_0x20a65e=_0x20a65e[_0x285318(0xbb)](/\$\$([\s\S]*?)\$\$/g,(_0x2e55c9,_0x305837)=>'\x5c['+_0x305837+'\x5c]'),_0x20a65e=_0x20a65e[_0x285318(0xbb)](/^### (.*$)/gm,_0x285318(0x1e8)),_0x20a65e=_0x20a65e[_0x285318(0xbb)](/^## (.*$)/gm,_0x285318(0x271)),_0x20a65e=_0x20a65e[_0x285318(0xbb)](/^# (.*$)/gm,'<h1>$1</h1>'),_0x20a65e=_0x20a65e[_0x285318(0xbb)](/\*\*(.*?)\*\*/g,_0x285318(0x1a9)),_0x20a65e=_0x20a65e['replace'](/\*(.*?)\*/g,_0x285318(0x15d)),_0x20a65e=_0x20a65e['replace'](/^-{3,}$/gm,_0x285318(0x244)),_0x20a65e=_0x20a65e['replace'](/</g,'&lt;')[_0x285318(0xbb)](/>/g,_0x285318(0x191));const _0x1c44f3=['h1','h2','h3',_0x285318(0x1fb),'em','hr'];for(const _0x392581 of _0x1c44f3){_0x20a65e=_0x20a65e[_0x285318(0xbb)](new RegExp(_0x285318(0x10b)+_0x392581+')([^&>]*)&gt;','g'),'<$1$2>'),_0x20a65e=_0x20a65e[_0x285318(0xbb)](new RegExp(_0x285318(0xb5)+_0x392581+')&gt;','g'),'</$1>');}return _0x285318(0x17c)+_0x20a65e+_0x285318(0x1ee);}function formatBotResponse(_0x8aceaf,_0x470e62=![]){const _0x32f56a=_0xcf017f,_0x27c5e1=[];_0x8aceaf=_0x8aceaf[_0x32f56a(0xbb)](/```plotly-js\n([\s\S]*?)```/g,(_0x1e99cc,_0x4186b0)=>{const _0x216eea=_0x32f56a,_0x5b8943=_0x216eea(0x137)+Date[_0x216eea(0x221)]()+'-'+Math[_0x216eea(0x1dc)](Math[_0x216eea(0x279)]()*0x3e8);return _0x27c5e1['push']({'id':_0x5b8943,'code':_0x4186b0}),_0x216eea(0x134)+_0x5b8943+_0x216eea(0x139);}),_0x8aceaf=_0x8aceaf['replace'](/\$\$([\s\S]*?)\$\$/g,(_0x7f10ba,_0x1fcb3e)=>'\x5c['+_0x1fcb3e+'\x5c]')['replace'](/(^|[^\\])\$([^\$]+?)\$/g,(_0x315814,_0x43dc0c,_0x361e81)=>_0x43dc0c+'\x5c('+_0x361e81+'\x5c)');let _0x31d0a5=_0x8aceaf[_0x32f56a(0xbb)](/```([a-z-]*)\n([\s\S]*?)\n```/gi,(_0x36ce15,_0xfb242d,_0x7359c0)=>{const _0x1b30bd=_0x32f56a;return _0xfb242d=_0xfb242d[_0x1b30bd(0x15e)]()[_0x1b30bd(0x276)](),_0x1b30bd(0x129)+_0xfb242d+_0x1b30bd(0x296)+_0xfb242d+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22copy-btn\x22><i\x20class=\x22fas\x20fa-copy\x22></i>\x20Copiar</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<pre><code\x20class=\x22language-'+_0xfb242d+'\x22>'+escapeHtml(_0x7359c0[_0x1b30bd(0x15e)]())+'</code></pre>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';});const _0x236916=[];_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/(\\\([\s\S]*?\\\)|\$\$[\s\S]*?\$\$|\\\[[\s\S]*?\\\])/g,_0x1c4134=>{const _0x4b2d04=_0x32f56a,_0x572bf7=_0x4b2d04(0x245)+_0x236916[_0x4b2d04(0x116)]+_0x4b2d04(0x139);return _0x236916['push'](_0x1c4134),_0x572bf7;}),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/^# (.*$)/gm,'<h1>$1</h1>'),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/^## (.*$)/gm,_0x32f56a(0x1ae)),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/^### (.*$)/gm,_0x32f56a(0x1a0)),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/\*\*(.*?)\*\*/g,_0x32f56a(0x1a9)),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/\*(.*?)\*/g,'<em>$1</em>'),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/^-{3,}$/gm,'<hr>'),_0x31d0a5=_0x31d0a5['replace'](/^\* (.*$)/gm,_0x32f56a(0x231)),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/(<li>.*?<\/li>)+/gs,'<ul>$1</ul>'),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/^\d+\. (.*$)/gm,_0x32f56a(0x231)),_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/(<li>.*?<\/li>)+/gs,_0x32f56a(0xd5));_0x470e62?_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/<hint>(.*?)<\/hint>/gs,'<div\x20class=\x22tutor-hint\x22><strong>Pista:</strong>\x20$1</div>')[_0x32f56a(0xbb)](/<guide>(.*?)<\/guide>/gs,_0x32f56a(0x214))[_0x32f56a(0xbb)](/<concept>(.*?)<\/concept>/gs,_0x32f56a(0x1cb))['replace'](/<step>(.*?)<\/step>/gs,_0x32f56a(0x1ff))[_0x32f56a(0xbb)](/<check>(.*?)<\/check>/gs,_0x32f56a(0x184)):_0x31d0a5=_0x31d0a5[_0x32f56a(0xbb)](/<step>(.*?)<\/step>/gs,(_0xa060e3,_0x22b6d3)=>{const _0x4f7918=_0x32f56a;return _0x4f7918(0x10f)+_0x22b6d3+_0x4f7918(0xc7);})[_0x32f56a(0xbb)](/<definition>(.*?)<\/definition>/gs,(_0x1d4dbf,_0x5f4412)=>{const _0x10aa99=_0x32f56a;return _0x10aa99(0x18b)+_0x5f4412+_0x10aa99(0x1ee);})[_0x32f56a(0xbb)](/<example-section>(.*?)<\/example-section>/gs,(_0x4b8257,_0x2942e2)=>{const _0x11d1c5=_0x32f56a;return _0x11d1c5(0x267)+_0x2942e2+_0x11d1c5(0x1ee);})['replace'](/<problem-statement>(.*?)<\/problem-statement>/gs,(_0x4c2985,_0x3d8f7a)=>{const _0x5101be=_0x32f56a;return'<div\x20class=\x22problem-statement\x22><h4>Problema:</h4>'+_0x3d8f7a+_0x5101be(0x1ee);})[_0x32f56a(0xbb)](/<sol>(.*?)<\/sol>/gs,(_0x4a21aa,_0x3d9c54)=>{const _0x40e016=_0x32f56a;return'<div\x20class=\x22full-solution\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22subtitle\x22>Soluci√≥n\x20final:</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22solution-content\x22>'+_0x3d9c54+_0x40e016(0x219);})['replace'](/<data-table>(.*?)<\/data-table>/gs,(_0x526e4c,_0x31bb25)=>{const _0xc6870d=_0x32f56a;return _0xc6870d(0x11b)+_0x31bb25+'</div>';})[_0x32f56a(0xbb)](/<alert-info>(.*?)<\/alert-info>/gs,_0x32f56a(0xe2))['replace'](/<alert-warning>(.*?)<\/alert-warning>/gs,_0x32f56a(0xdd))[_0x32f56a(0xbb)](/<alert-success>(.*?)<\/alert-success>/gs,'<div\x20class=\x22alert-success\x22><i\x20class=\x22fas\x20fa-check-circle\x22></i>\x20<strong>√âxito:</strong>\x20$1</div>')[_0x32f56a(0xbb)](/<alert-tip>(.*?)<\/alert-tip>/gs,_0x32f56a(0xc2))[_0x32f56a(0xbb)](/<reference>(.*?)<\/reference>/gs,_0x32f56a(0x162))[_0x32f56a(0xbb)](/<highlight>(.*?)<\/highlight>/gs,_0x32f56a(0x1a1))['replace'](/<important>(.*?)<\/important>/gs,_0x32f56a(0x217))[_0x32f56a(0xbb)](/<note>(.*?)<\/note>/gs,_0x32f56a(0x223))[_0x32f56a(0xbb)](/<math-text>(.*?)<\/math-text>/gs,_0x32f56a(0xcd))[_0x32f56a(0xbb)](/<math-block>(.*?)<\/math-block>/gs,'<div\x20class=\x22math-block\x22>$1</div>');_0x236916[_0x32f56a(0x246)]((_0x5108ec,_0x5b5223)=>{const _0x59635a=_0x32f56a,_0x26dccc=/^\$\$[\s\S]*\$\$$/[_0x59635a(0x1a5)](_0x5108ec)||/^\\\[/['test'](_0x5108ec);if(_0x26dccc){const _0x51a8cd=_0x5108ec[_0x59635a(0xbb)](/^\$\$|\$\$$/g,'')[_0x59635a(0xbb)](/^\\\[|\\\]$/g,''),_0x2a1007=encodeURIComponent(_0x51a8cd),_0x3348e8=_0x59635a(0x1ed)+_0x2a1007+_0x59635a(0x20d)+_0x5108ec+_0x59635a(0x218);_0x31d0a5=_0x31d0a5[_0x59635a(0xbb)](_0x59635a(0x245)+_0x5b5223+_0x59635a(0x139),_0x3348e8);}else _0x31d0a5=_0x31d0a5[_0x59635a(0xbb)](_0x59635a(0x245)+_0x5b5223+_0x59635a(0x139),_0x5108ec);}),_0x27c5e1[_0x32f56a(0x246)](_0xe2887c=>{const _0x50895e=_0x32f56a,_0x33c858=_0x50895e(0x20a)+_0xe2887c['id']+_0x50895e(0x143)+_0xe2887c['id']+_0x50895e(0x1c8)+JSON['stringify'](_0xe2887c['code'])+_0x50895e(0x29e)+_0xe2887c['id']+'\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20*******************************************************************\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20********\x20AQU√ç\x20ES\x20DONDE\x20VAMOS\x20A\x20A√ëADIR\x20LOS\x20CONSOLE.LOGS\x20************\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20*******************************************************************\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x201.\x20Log\x20del\x20c√≥digo\x20limpio\x20que\x20se\x20intenta\x20procesar\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27Plotly\x20Debug:\x20cleanCode\x20para\x20ID\x20'+_0xe2887c['id']+_0x50895e(0x1f8)+_0xe2887c['id']+_0x50895e(0x196)+_0xe2887c['id']+_0x50895e(0x248)+_0xe2887c['id']+_0x50895e(0xc5)+_0xe2887c['id']+'\x27,\x20data,\x20layout)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.then(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27Plotly\x20Debug:\x20Gr√°fico\x20renderizado\x20con\x20√©xito\x20para\x20ID\x20'+_0xe2887c['id']+'\x27);\x20//\x20<--\x20√âxito\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20container.querySelector(\x27.plotly-loading\x27)?.remove();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20})\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.catch(e\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x206.\x20Log\x20del\x20error\x20espec√≠fico\x20de\x20Plotly.newPlot\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.error(\x27Plotly\x20Debug:\x20Error\x20en\x20Plotly.newPlot\x20para\x20ID\x20'+_0xe2887c['id']+_0x50895e(0x1a7)+_0xe2887c['id']+':\x27,\x20e);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20Esperar\x20a\x20que\x20todo\x20est√©\x20listo\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(document.readyState\x20===\x20\x27complete\x27)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20renderPlotly();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20window.addEventListener(\x27load\x27,\x20renderPlotly);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20})();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</scr"+"ipt>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';_0x31d0a5=_0x31d0a5[_0x50895e(0xbb)](_0x50895e(0x134)+_0xe2887c['id']+'~~~',_0x33c858);});let _0x2afe0a=_0x31d0a5['replace'](/</g,_0x32f56a(0x1c9))[_0x32f56a(0xbb)](/>/g,'&gt;');const _0x177ced=['h1','h2','h3','h4',_0x32f56a(0x1fb),'em','hr','ul','ol','li',_0x32f56a(0x18c),'a','i',_0x32f56a(0x167),'table',_0x32f56a(0x101),_0x32f56a(0x27f),'tr','th','td','small','p',_0x32f56a(0x200),_0x32f56a(0x156),_0x32f56a(0x27a),_0x32f56a(0x1b1)];for(const _0x3b6016 of _0x177ced){_0x2afe0a=_0x2afe0a['replace'](new RegExp(_0x32f56a(0x10b)+_0x3b6016+_0x32f56a(0x11e),'g'),'<$1$2>'),_0x2afe0a=_0x2afe0a[_0x32f56a(0xbb)](new RegExp(_0x32f56a(0xb5)+_0x3b6016+_0x32f56a(0x1a3),'g'),_0x32f56a(0x109));}return _0x2afe0a;}function escapeHtml(_0x8fbd41){const _0x379884=_0xcf017f;if(!_0x8fbd41)return'';return _0x8fbd41[_0x379884(0xbb)](/&/g,'&amp;')['replace'](/</g,_0x379884(0x1c9))[_0x379884(0xbb)](/>/g,_0x379884(0x191))['replace'](/"/g,_0x379884(0x22f))[_0x379884(0xbb)](/'/g,_0x379884(0x104))['replace'](/\//g,_0x379884(0x197));}function processNewContent(_0x4e117d){const _0x4be83a=_0xcf017f;if(!_0x4e117d)return;const _0x3b034f=()=>{const _0x348a19=_0x11d0;window[_0x348a19(0x1bf)]&&MathJax['typesetPromise']([_0x4e117d])[_0x348a19(0x262)](_0x182dcd=>{const _0x4246b0=_0x348a19;console[_0x4246b0(0xc0)](_0x4246b0(0x128),_0x182dcd),setTimeout(_0x3b034f,0x1f4);});};_0x3b034f();window[_0x4be83a(0x1e0)]&&_0x4e117d[_0x4be83a(0xf6)](_0x4be83a(0x11a))[_0x4be83a(0x246)](_0x27eb6f=>{hljs['highlightElement'](_0x27eb6f);});const _0x558b4e=_0x4e117d[_0x4be83a(0xf6)](_0x4be83a(0x1d2));_0x558b4e[_0x4be83a(0x246)](_0x2035f5=>{const _0x125f40=setInterval(()=>{const _0x4dbe73=_0x11d0;_0x2035f5['querySelector'](_0x4dbe73(0x287))&&(clearInterval(_0x125f40),_0x2035f5[_0x4dbe73(0xb6)](_0x4dbe73(0x185))?.[_0x4dbe73(0x1cc)]());},0x12c);setTimeout(()=>{const _0x29d1ee=_0x11d0;clearInterval(_0x125f40),!_0x2035f5[_0x29d1ee(0xb6)]('div.plotly')&&(_0x2035f5['innerHTML']=_0x29d1ee(0x1ba));},0x1388);});}function formatUserMessage(_0x49b7c3){const _0x380d77=_0xcf017f,_0x2ac9f1=_0x49b7c3[_0x380d77(0xbb)](/\\text\{([^{}]*)\}/g,'$1');return _0x2ac9f1;}function appendMessage(_0x4c7f39,_0x3c2f99,_0x127e9b={'renderMath':!![]}){const _0x13edf7=_0xcf017f,_0x2804f9=document['getElementById'](_0x13edf7(0xfb)),_0x176ab6=document[_0x13edf7(0x15c)]('div');_0x176ab6[_0x13edf7(0x273)]=_0x13edf7(0x28d)+_0x4c7f39;const _0x1da8cf=document['createElement'](_0x13edf7(0x18c));_0x1da8cf['className']=_0x13edf7(0xcf);_0x4c7f39===_0x13edf7(0x1d5)?_0x127e9b[_0x13edf7(0xe3)]?(_0x1da8cf['style'][_0x13edf7(0x12b)]='#7E7E7E',_0x1da8cf[_0x13edf7(0x234)]='\x5c['+_0x3c2f99+'\x5c]',renderMathAndCode(_0x1da8cf)):_0x1da8cf[_0x13edf7(0x239)]=formatUserMessage(_0x3c2f99):(_0x1da8cf[_0x13edf7(0x234)]=formatBotResponse(_0x3c2f99),renderMathAndCode(_0x1da8cf));_0x176ab6[_0x13edf7(0x177)](_0x1da8cf),_0x2804f9[_0x13edf7(0x177)](_0x176ab6);const _0x75fe57=0x3;while(_0x2804f9['children'][_0x13edf7(0x116)]>_0x75fe57){const _0x200fac=_0x2804f9[_0x13edf7(0x1f7)];if(!_0x200fac)break;_0x200fac[_0x13edf7(0x1cc)]();}_0x2804f9['scrollTop']=_0x2804f9[_0x13edf7(0xd6)],processNewContent(_0x1da8cf);}
</script></body>
</html>
